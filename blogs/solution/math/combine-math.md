---
title: ÁªÑÂêàÊï∞Â≠¶
---
###  
<hr>

## ÊéíÂàóÁªÑÂêà

### Ê¥õË∞∑P1066_2^kËøõÂà∂Êï∞

#### üîó
<a href="https://www.luogu.com.cn/problem/P1066"><img src="https://i.loli.net/2021/11/09/L12VyJBogcEPT86.png"></a>

#### üí°
Êàë‰ª¨ÂÖàÊâì‰∏Ä‰∏™  <img src="https://latex.codecogs.com/svg.image?\inline&space;2^k" title="\inline 2^k" /> ËøõÂà∂Âíå  <img src="https://latex.codecogs.com/svg.image?\inline&space;2" title="\inline 2" /> ËøõÂà∂ÁöÑÂØπÂ∫îË°®ÁúãÁúã  

::: details Ë°®Ê†º
<table>
<tr><th>k</th><th> <img src="https://latex.codecogs.com/svg.image?\inline&space;10" title="\inline 10" />  ËøõÂà∂</th><th> <img src="https://latex.codecogs.com/svg.image?\inline&space;2^k" title="\inline 2^k" /> ËøõÂà∂</th><th> <img src="https://latex.codecogs.com/svg.image?\inline&space;2" title="\inline 2" /> ËøõÂà∂</th></tr>
<tr><td rowspan="101">1</td></tr><tr><td>1</td><td>1</td><td>1</td></tr>
<tr><td>2</td><td>10</td><td>10</td></tr>
<tr><td>3</td><td>11</td><td>11</td></tr>
<tr><td>4</td><td>100</td><td>100</td></tr>
<tr><td>5</td><td>101</td><td>101</td></tr>
<tr><td>6</td><td>110</td><td>110</td></tr>
<tr><td>7</td><td>111</td><td>111</td></tr>
<tr><td>8</td><td>1000</td><td>1000</td></tr>
<tr><td>9</td><td>1001</td><td>1001</td></tr>
<tr><td>10</td><td>1010</td><td>1010</td></tr>
<tr><td>11</td><td>1011</td><td>1011</td></tr>
<tr><td>12</td><td>1100</td><td>1100</td></tr>
<tr><td>13</td><td>1101</td><td>1101</td></tr>
<tr><td>14</td><td>1110</td><td>1110</td></tr>
<tr><td>15</td><td>1111</td><td>1111</td></tr>
<tr><td>16</td><td>10000</td><td>10000</td></tr>
<tr><td>17</td><td>10001</td><td>10001</td></tr>
<tr><td>18</td><td>10010</td><td>10010</td></tr>
<tr><td>19</td><td>10011</td><td>10011</td></tr>
<tr><td>20</td><td>10100</td><td>10100</td></tr>
<tr><td>21</td><td>10101</td><td>10101</td></tr>
<tr><td>22</td><td>10110</td><td>10110</td></tr>
<tr><td>23</td><td>10111</td><td>10111</td></tr>
<tr><td>24</td><td>11000</td><td>11000</td></tr>
<tr><td>25</td><td>11001</td><td>11001</td></tr>
<tr><td>26</td><td>11010</td><td>11010</td></tr>
<tr><td>27</td><td>11011</td><td>11011</td></tr>
<tr><td>28</td><td>11100</td><td>11100</td></tr>
<tr><td>29</td><td>11101</td><td>11101</td></tr>
<tr><td>30</td><td>11110</td><td>11110</td></tr>
<tr><td>31</td><td>11111</td><td>11111</td></tr>
<tr><td>32</td><td>100000</td><td>100000</td></tr>
<tr><td>33</td><td>100001</td><td>100001</td></tr>
<tr><td>34</td><td>100010</td><td>100010</td></tr>
<tr><td>35</td><td>100011</td><td>100011</td></tr>
<tr><td>36</td><td>100100</td><td>100100</td></tr>
<tr><td>37</td><td>100101</td><td>100101</td></tr>
<tr><td>38</td><td>100110</td><td>100110</td></tr>
<tr><td>39</td><td>100111</td><td>100111</td></tr>
<tr><td>40</td><td>101000</td><td>101000</td></tr>
<tr><td>41</td><td>101001</td><td>101001</td></tr>
<tr><td>42</td><td>101010</td><td>101010</td></tr>
<tr><td>43</td><td>101011</td><td>101011</td></tr>
<tr><td>44</td><td>101100</td><td>101100</td></tr>
<tr><td>45</td><td>101101</td><td>101101</td></tr>
<tr><td>46</td><td>101110</td><td>101110</td></tr>
<tr><td>47</td><td>101111</td><td>101111</td></tr>
<tr><td>48</td><td>110000</td><td>110000</td></tr>
<tr><td>49</td><td>110001</td><td>110001</td></tr>
<tr><td>50</td><td>110010</td><td>110010</td></tr>
<tr><td>51</td><td>110011</td><td>110011</td></tr>
<tr><td>52</td><td>110100</td><td>110100</td></tr>
<tr><td>53</td><td>110101</td><td>110101</td></tr>
<tr><td>54</td><td>110110</td><td>110110</td></tr>
<tr><td>55</td><td>110111</td><td>110111</td></tr>
<tr><td>56</td><td>111000</td><td>111000</td></tr>
<tr><td>57</td><td>111001</td><td>111001</td></tr>
<tr><td>58</td><td>111010</td><td>111010</td></tr>
<tr><td>59</td><td>111011</td><td>111011</td></tr>
<tr><td>60</td><td>111100</td><td>111100</td></tr>
<tr><td>61</td><td>111101</td><td>111101</td></tr>
<tr><td>62</td><td>111110</td><td>111110</td></tr>
<tr><td>63</td><td>111111</td><td>111111</td></tr>
<tr><td>64</td><td>1000000</td><td>1000000</td></tr>
<tr><td>65</td><td>1000001</td><td>1000001</td></tr>
<tr><td>66</td><td>1000010</td><td>1000010</td></tr>
<tr><td>67</td><td>1000011</td><td>1000011</td></tr>
<tr><td>68</td><td>1000100</td><td>1000100</td></tr>
<tr><td>69</td><td>1000101</td><td>1000101</td></tr>
<tr><td>70</td><td>1000110</td><td>1000110</td></tr>
<tr><td>71</td><td>1000111</td><td>1000111</td></tr>
<tr><td>72</td><td>1001000</td><td>1001000</td></tr>
<tr><td>73</td><td>1001001</td><td>1001001</td></tr>
<tr><td>74</td><td>1001010</td><td>1001010</td></tr>
<tr><td>75</td><td>1001011</td><td>1001011</td></tr>
<tr><td>76</td><td>1001100</td><td>1001100</td></tr>
<tr><td>77</td><td>1001101</td><td>1001101</td></tr>
<tr><td>78</td><td>1001110</td><td>1001110</td></tr>
<tr><td>79</td><td>1001111</td><td>1001111</td></tr>
<tr><td>80</td><td>1010000</td><td>1010000</td></tr>
<tr><td>81</td><td>1010001</td><td>1010001</td></tr>
<tr><td>82</td><td>1010010</td><td>1010010</td></tr>
<tr><td>83</td><td>1010011</td><td>1010011</td></tr>
<tr><td>84</td><td>1010100</td><td>1010100</td></tr>
<tr><td>85</td><td>1010101</td><td>1010101</td></tr>
<tr><td>86</td><td>1010110</td><td>1010110</td></tr>
<tr><td>87</td><td>1010111</td><td>1010111</td></tr>
<tr><td>88</td><td>1011000</td><td>1011000</td></tr>
<tr><td>89</td><td>1011001</td><td>1011001</td></tr>
<tr><td>90</td><td>1011010</td><td>1011010</td></tr>
<tr><td>91</td><td>1011011</td><td>1011011</td></tr>
<tr><td>92</td><td>1011100</td><td>1011100</td></tr>
<tr><td>93</td><td>1011101</td><td>1011101</td></tr>
<tr><td>94</td><td>1011110</td><td>1011110</td></tr>
<tr><td>95</td><td>1011111</td><td>1011111</td></tr>
<tr><td>96</td><td>1100000</td><td>1100000</td></tr>
<tr><td>97</td><td>1100001</td><td>1100001</td></tr>
<tr><td>98</td><td>1100010</td><td>1100010</td></tr>
<tr><td>99</td><td>1100011</td><td>1100011</td></tr>
<tr><td>100</td><td>1100100</td><td>1100100</td></tr>
<tr><td rowspan="101">2</td></tr><tr><td>1</td><td>1</td><td>1</td></tr>
<tr><td>2</td><td>2</td><td>10</td></tr>
<tr><td>3</td><td>3</td><td>11</td></tr>
<tr><td>4</td><td>10</td><td>100</td></tr>
<tr><td>5</td><td>11</td><td>101</td></tr>
<tr><td>6</td><td>12</td><td>110</td></tr>
<tr><td>7</td><td>13</td><td>111</td></tr>
<tr><td>8</td><td>20</td><td>1000</td></tr>
<tr><td>9</td><td>21</td><td>1001</td></tr>
<tr><td>10</td><td>22</td><td>1010</td></tr>
<tr><td>11</td><td>23</td><td>1011</td></tr>
<tr><td>12</td><td>30</td><td>1100</td></tr>
<tr><td>13</td><td>31</td><td>1101</td></tr>
<tr><td>14</td><td>32</td><td>1110</td></tr>
<tr><td>15</td><td>33</td><td>1111</td></tr>
<tr><td>16</td><td>100</td><td>10000</td></tr>
<tr><td>17</td><td>101</td><td>10001</td></tr>
<tr><td>18</td><td>102</td><td>10010</td></tr>
<tr><td>19</td><td>103</td><td>10011</td></tr>
<tr><td>20</td><td>110</td><td>10100</td></tr>
<tr><td>21</td><td>111</td><td>10101</td></tr>
<tr><td>22</td><td>112</td><td>10110</td></tr>
<tr><td>23</td><td>113</td><td>10111</td></tr>
<tr><td>24</td><td>120</td><td>11000</td></tr>
<tr><td>25</td><td>121</td><td>11001</td></tr>
<tr><td>26</td><td>122</td><td>11010</td></tr>
<tr><td>27</td><td>123</td><td>11011</td></tr>
<tr><td>28</td><td>130</td><td>11100</td></tr>
<tr><td>29</td><td>131</td><td>11101</td></tr>
<tr><td>30</td><td>132</td><td>11110</td></tr>
<tr><td>31</td><td>133</td><td>11111</td></tr>
<tr><td>32</td><td>200</td><td>100000</td></tr>
<tr><td>33</td><td>201</td><td>100001</td></tr>
<tr><td>34</td><td>202</td><td>100010</td></tr>
<tr><td>35</td><td>203</td><td>100011</td></tr>
<tr><td>36</td><td>210</td><td>100100</td></tr>
<tr><td>37</td><td>211</td><td>100101</td></tr>
<tr><td>38</td><td>212</td><td>100110</td></tr>
<tr><td>39</td><td>213</td><td>100111</td></tr>
<tr><td>40</td><td>220</td><td>101000</td></tr>
<tr><td>41</td><td>221</td><td>101001</td></tr>
<tr><td>42</td><td>222</td><td>101010</td></tr>
<tr><td>43</td><td>223</td><td>101011</td></tr>
<tr><td>44</td><td>230</td><td>101100</td></tr>
<tr><td>45</td><td>231</td><td>101101</td></tr>
<tr><td>46</td><td>232</td><td>101110</td></tr>
<tr><td>47</td><td>233</td><td>101111</td></tr>
<tr><td>48</td><td>300</td><td>110000</td></tr>
<tr><td>49</td><td>301</td><td>110001</td></tr>
<tr><td>50</td><td>302</td><td>110010</td></tr>
<tr><td>51</td><td>303</td><td>110011</td></tr>
<tr><td>52</td><td>310</td><td>110100</td></tr>
<tr><td>53</td><td>311</td><td>110101</td></tr>
<tr><td>54</td><td>312</td><td>110110</td></tr>
<tr><td>55</td><td>313</td><td>110111</td></tr>
<tr><td>56</td><td>320</td><td>111000</td></tr>
<tr><td>57</td><td>321</td><td>111001</td></tr>
<tr><td>58</td><td>322</td><td>111010</td></tr>
<tr><td>59</td><td>323</td><td>111011</td></tr>
<tr><td>60</td><td>330</td><td>111100</td></tr>
<tr><td>61</td><td>331</td><td>111101</td></tr>
<tr><td>62</td><td>332</td><td>111110</td></tr>
<tr><td>63</td><td>333</td><td>111111</td></tr>
<tr><td>64</td><td>1000</td><td>1000000</td></tr>
<tr><td>65</td><td>1001</td><td>1000001</td></tr>
<tr><td>66</td><td>1002</td><td>1000010</td></tr>
<tr><td>67</td><td>1003</td><td>1000011</td></tr>
<tr><td>68</td><td>1010</td><td>1000100</td></tr>
<tr><td>69</td><td>1011</td><td>1000101</td></tr>
<tr><td>70</td><td>1012</td><td>1000110</td></tr>
<tr><td>71</td><td>1013</td><td>1000111</td></tr>
<tr><td>72</td><td>1020</td><td>1001000</td></tr>
<tr><td>73</td><td>1021</td><td>1001001</td></tr>
<tr><td>74</td><td>1022</td><td>1001010</td></tr>
<tr><td>75</td><td>1023</td><td>1001011</td></tr>
<tr><td>76</td><td>1030</td><td>1001100</td></tr>
<tr><td>77</td><td>1031</td><td>1001101</td></tr>
<tr><td>78</td><td>1032</td><td>1001110</td></tr>
<tr><td>79</td><td>1033</td><td>1001111</td></tr>
<tr><td>80</td><td>1100</td><td>1010000</td></tr>
<tr><td>81</td><td>1101</td><td>1010001</td></tr>
<tr><td>82</td><td>1102</td><td>1010010</td></tr>
<tr><td>83</td><td>1103</td><td>1010011</td></tr>
<tr><td>84</td><td>1110</td><td>1010100</td></tr>
<tr><td>85</td><td>1111</td><td>1010101</td></tr>
<tr><td>86</td><td>1112</td><td>1010110</td></tr>
<tr><td>87</td><td>1113</td><td>1010111</td></tr>
<tr><td>88</td><td>1120</td><td>1011000</td></tr>
<tr><td>89</td><td>1121</td><td>1011001</td></tr>
<tr><td>90</td><td>1122</td><td>1011010</td></tr>
<tr><td>91</td><td>1123</td><td>1011011</td></tr>
<tr><td>92</td><td>1130</td><td>1011100</td></tr>
<tr><td>93</td><td>1131</td><td>1011101</td></tr>
<tr><td>94</td><td>1132</td><td>1011110</td></tr>
<tr><td>95</td><td>1133</td><td>1011111</td></tr>
<tr><td>96</td><td>1200</td><td>1100000</td></tr>
<tr><td>97</td><td>1201</td><td>1100001</td></tr>
<tr><td>98</td><td>1202</td><td>1100010</td></tr>
<tr><td>99</td><td>1203</td><td>1100011</td></tr>
<tr><td>100</td><td>1210</td><td>1100100</td></tr>
<tr><td rowspan="101">3</td></tr><tr><td>1</td><td>1</td><td>1</td></tr>
<tr><td>2</td><td>2</td><td>10</td></tr>
<tr><td>3</td><td>3</td><td>11</td></tr>
<tr><td>4</td><td>4</td><td>100</td></tr>
<tr><td>5</td><td>5</td><td>101</td></tr>
<tr><td>6</td><td>6</td><td>110</td></tr>
<tr><td>7</td><td>7</td><td>111</td></tr>
<tr><td>8</td><td>10</td><td>1000</td></tr>
<tr><td>9</td><td>11</td><td>1001</td></tr>
<tr><td>10</td><td>12</td><td>1010</td></tr>
<tr><td>11</td><td>13</td><td>1011</td></tr>
<tr><td>12</td><td>14</td><td>1100</td></tr>
<tr><td>13</td><td>15</td><td>1101</td></tr>
<tr><td>14</td><td>16</td><td>1110</td></tr>
<tr><td>15</td><td>17</td><td>1111</td></tr>
<tr><td>16</td><td>20</td><td>10000</td></tr>
<tr><td>17</td><td>21</td><td>10001</td></tr>
<tr><td>18</td><td>22</td><td>10010</td></tr>
<tr><td>19</td><td>23</td><td>10011</td></tr>
<tr><td>20</td><td>24</td><td>10100</td></tr>
<tr><td>21</td><td>25</td><td>10101</td></tr>
<tr><td>22</td><td>26</td><td>10110</td></tr>
<tr><td>23</td><td>27</td><td>10111</td></tr>
<tr><td>24</td><td>30</td><td>11000</td></tr>
<tr><td>25</td><td>31</td><td>11001</td></tr>
<tr><td>26</td><td>32</td><td>11010</td></tr>
<tr><td>27</td><td>33</td><td>11011</td></tr>
<tr><td>28</td><td>34</td><td>11100</td></tr>
<tr><td>29</td><td>35</td><td>11101</td></tr>
<tr><td>30</td><td>36</td><td>11110</td></tr>
<tr><td>31</td><td>37</td><td>11111</td></tr>
<tr><td>32</td><td>40</td><td>100000</td></tr>
<tr><td>33</td><td>41</td><td>100001</td></tr>
<tr><td>34</td><td>42</td><td>100010</td></tr>
<tr><td>35</td><td>43</td><td>100011</td></tr>
<tr><td>36</td><td>44</td><td>100100</td></tr>
<tr><td>37</td><td>45</td><td>100101</td></tr>
<tr><td>38</td><td>46</td><td>100110</td></tr>
<tr><td>39</td><td>47</td><td>100111</td></tr>
<tr><td>40</td><td>50</td><td>101000</td></tr>
<tr><td>41</td><td>51</td><td>101001</td></tr>
<tr><td>42</td><td>52</td><td>101010</td></tr>
<tr><td>43</td><td>53</td><td>101011</td></tr>
<tr><td>44</td><td>54</td><td>101100</td></tr>
<tr><td>45</td><td>55</td><td>101101</td></tr>
<tr><td>46</td><td>56</td><td>101110</td></tr>
<tr><td>47</td><td>57</td><td>101111</td></tr>
<tr><td>48</td><td>60</td><td>110000</td></tr>
<tr><td>49</td><td>61</td><td>110001</td></tr>
<tr><td>50</td><td>62</td><td>110010</td></tr>
<tr><td>51</td><td>63</td><td>110011</td></tr>
<tr><td>52</td><td>64</td><td>110100</td></tr>
<tr><td>53</td><td>65</td><td>110101</td></tr>
<tr><td>54</td><td>66</td><td>110110</td></tr>
<tr><td>55</td><td>67</td><td>110111</td></tr>
<tr><td>56</td><td>70</td><td>111000</td></tr>
<tr><td>57</td><td>71</td><td>111001</td></tr>
<tr><td>58</td><td>72</td><td>111010</td></tr>
<tr><td>59</td><td>73</td><td>111011</td></tr>
<tr><td>60</td><td>74</td><td>111100</td></tr>
<tr><td>61</td><td>75</td><td>111101</td></tr>
<tr><td>62</td><td>76</td><td>111110</td></tr>
<tr><td>63</td><td>77</td><td>111111</td></tr>
<tr><td>64</td><td>100</td><td>1000000</td></tr>
<tr><td>65</td><td>101</td><td>1000001</td></tr>
<tr><td>66</td><td>102</td><td>1000010</td></tr>
<tr><td>67</td><td>103</td><td>1000011</td></tr>
<tr><td>68</td><td>104</td><td>1000100</td></tr>
<tr><td>69</td><td>105</td><td>1000101</td></tr>
<tr><td>70</td><td>106</td><td>1000110</td></tr>
<tr><td>71</td><td>107</td><td>1000111</td></tr>
<tr><td>72</td><td>110</td><td>1001000</td></tr>
<tr><td>73</td><td>111</td><td>1001001</td></tr>
<tr><td>74</td><td>112</td><td>1001010</td></tr>
<tr><td>75</td><td>113</td><td>1001011</td></tr>
<tr><td>76</td><td>114</td><td>1001100</td></tr>
<tr><td>77</td><td>115</td><td>1001101</td></tr>
<tr><td>78</td><td>116</td><td>1001110</td></tr>
<tr><td>79</td><td>117</td><td>1001111</td></tr>
<tr><td>80</td><td>120</td><td>1010000</td></tr>
<tr><td>81</td><td>121</td><td>1010001</td></tr>
<tr><td>82</td><td>122</td><td>1010010</td></tr>
<tr><td>83</td><td>123</td><td>1010011</td></tr>
<tr><td>84</td><td>124</td><td>1010100</td></tr>
<tr><td>85</td><td>125</td><td>1010101</td></tr>
<tr><td>86</td><td>126</td><td>1010110</td></tr>
<tr><td>87</td><td>127</td><td>1010111</td></tr>
<tr><td>88</td><td>130</td><td>1011000</td></tr>
<tr><td>89</td><td>131</td><td>1011001</td></tr>
<tr><td>90</td><td>132</td><td>1011010</td></tr>
<tr><td>91</td><td>133</td><td>1011011</td></tr>
<tr><td>92</td><td>134</td><td>1011100</td></tr>
<tr><td>93</td><td>135</td><td>1011101</td></tr>
<tr><td>94</td><td>136</td><td>1011110</td></tr>
<tr><td>95</td><td>137</td><td>1011111</td></tr>
<tr><td>96</td><td>140</td><td>1100000</td></tr>
<tr><td>97</td><td>141</td><td>1100001</td></tr>
<tr><td>98</td><td>142</td><td>1100010</td></tr>
<tr><td>99</td><td>143</td><td>1100011</td></tr>
<tr><td>100</td><td>144</td><td>1100100</td></tr>
</table>
:::
  
ÂèØ‰ª•ÂèëÁé∞Âá†‰∏™ÊúâË∂£ÁöÑ‰∫ãÊÉÖÔºö  
$1.$  $2^k$ ËøõÂà∂ÂØπ‰∫é  $2$ ËøõÂà∂ÁöÑËøõ‰ΩçÊûÅÈôêÂú® $2^k$ ËøõÂà∂Ë°®Á§∫ÁöÑÊúÄÈ´ò‰Ωç‰∏äÂëàËøôÊ†∑ÁöÑÊéíÂàó  
 <table>
 <tr><th>k=1</th><td>1,1,1,1,1,1,...</td></tr>
 <tr><th>k=2</th><td>1,3,1,3,1,3,...</td></tr>
 <tr><th>k=3</th><td>1,3,7,1,3,7,...</td></tr>
 </table>  
 ÈÇ£‰πàÊàë‰ª¨ÂèØ‰ª•‰ªé‰∏≠Êé®Âá∫  
  <table>
 <tr><th>k=x</th><td> $2^0-1,2^1-1,2^2-1,...2^x-1,2^0-1,2^1-1,2^2-1,....,2^x-1....$</td></tr>
 </table>  
 
$2.$ $2^k$ ËøõÂà∂‰∏ãÔºåÂú®Ëøô‰∏™ÊéíÂàóÈáåÈù¢Ôºå‰∏ÄÊ¨°Âæ™ÁéØ  $2^k$ ËøõÂà∂‰ºöËøõ‰∏Ä‰Ωç  
  
    
    
ÂØπ‰∫éÈ¢òÁõÆÔºåÊàë‰ª¨Ëµ∞ÂÆåËøô‰∏™ÊéíÂàó‰∏≠  <img src="https://latex.codecogs.com/svg.image?\inline&space;w" title="\inline w" /> ‰∏™Êï∞Â∞±ÂèØ‰ª•ÁªìÊùü‰∫Ü    
Êàë‰ª¨Êûö‰∏æÊúÄÈ´ò‰ΩçÁöÑÊï∞Â≠ó  <img src="https://latex.codecogs.com/svg.image?\inline&space;[1,2^k-1]" title="\inline [1,2^k-1]" />  ÔºåÂèØÁü•Âú®‰∏ÄÊ¨°Âæ™ÁéØ‰∏≠Êàë‰ª¨  <img src="https://latex.codecogs.com/svg.image?\inline&space;2^k" title="\inline 2^k" /> ËøõÂà∂ÁöÑ‰ΩçÊï∞Êó∂‰∏çÂèòÁöÑ  
‰∏îÂ¶ÇÊûú  <img src="https://latex.codecogs.com/svg.image?\inline&space;i+1" title="\inline i+1" /> ÊòØ  <img src="https://latex.codecogs.com/svg.image?\inline&space;2" title="\inline 2" /> ÁöÑÂπÇÊ¨°ÔºåÂç≥  <img src="https://latex.codecogs.com/svg.image?\inline&space;lowbit(i+1)=i+1" title="\inline lowbit(i+1)=i+1" />  ÈÇ£‰πàÂ∞±ËØ¥ÊòéÊàë‰ª¨Ëµ∞Ëøá‰∫ÜÊéíÂàó‰∏≠ÁöÑ‰∏Ä‰∏™Êï∞‰πüÂ∞±ÊòØÂú®  <img src="https://latex.codecogs.com/svg.image?\inline&space;2" title="\inline 2" /> ËøõÂà∂‰∏ãËøõ‰∫Ü‰∏Ä‰Ωç    
ËÄåÊàë‰ª¨ÊÉ≥Ë¶ÅÂú®ÊúÄÈ´ò‰Ωç  <img src="https://latex.codecogs.com/svg.image?\inline&space;i" title="\inline i" />  Êï∞Â≠ó‰∏∫  <img src="https://latex.codecogs.com/svg.image?\inline&space;j" title="\inline j" /> Êó∂ÂêéÈù¢‰Ωé‰ΩçÊúâÂ§öÂ∞ëÁßçÊûÑÈÄ†ÊñπÂºèÔºåÂèØ‰ª•ÈÄöËøá  <img src="https://latex.codecogs.com/svg.image?\inline&space;dp[i][j]" title="\inline dp[i][j]" /> È¢ÑÂ§ÑÁêÜ‰∏Ä‰∏ã  
 <img src="https://latex.codecogs.com/svg.image?\inline&space;\begin{aligned}dp[i][j]&=\sum\limits_{x=1}^{(1<<k)-1}dp[i-1][x]\\&=dp[i][j-1]+dp[i-1][j]\end{aligned}" title="\inline \begin{aligned}dp[i][j]&=\sum\limits_{x=1}^{(1<<k)-1}dp[i-1][x]\\&=dp[i][j-1]+dp[i-1][j]\end{aligned}" />  

‰ΩÜÊòØÊàë‰ª¨Ëøô‰∏™ÊòØËÆ°ÁÆó‰∫Ü  <img src="https://latex.codecogs.com/svg.image?\inline&space;2^k" title="\inline 2^k" /> ËøõÂà∂‰∏ãÁöÑÊâÄÊúâÂèØË°å‰ΩçÊï∞ÔºåÊúÄÂêéËøòË¶ÅÊåâË¶ÅÊ±ÇÂáèÊéâ  <img src="https://latex.codecogs.com/svg.image?\inline&space;1" title="\inline 1" /> ‰ΩçÁöÑ  

ËøôÈáå‰∏ä  <img src="https://latex.codecogs.com/svg.image?\inline&space;Java" title="\inline Java" /> È´òÁ≤æ 

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```java
public class Main {

        static BigInteger zero = BigInteger.ZERO;
        static BigInteger one = BigInteger.ONE;
        static BigInteger two = BigInteger.valueOf(2);
        static BigInteger six = BigInteger.valueOf(6);
        static BigInteger ten = BigInteger.TEN;

        static int N = 1000;
        static BigInteger[][] dp = new BigInteger[N][N];
        static int k, w;

        public static void Get_Dp () {
                for ( int i = 0; i < N; i ++ ) for ( int j = 0; j < N; j ++ ) dp[i][j] = zero;
                for ( int i = 1; i < (1 << k); i ++ ) dp[1][i] = one;
                for ( int i = 2; i < (1 << k); i ++ ) {
                        for ( int j = 2; j < (1 << k); j ++ ) dp[i][1] = dp[i][1].add(dp[i - 1][j]);
                        for ( int j = 2; j < (1 << k); j ++ ) dp[i][j] = dp[i][j - 1].subtract(dp[i - 1][j]);
                }
        }
        public static int lowbit ( int x ) { return x & (-x); }
        public static void main (String[] args) {
                Scanner input = new Scanner(System.in);
                k = input.nextInt();
                w = input.nextInt(); int tmp = w;
                Get_Dp();

                int num = 1;
                BigInteger res = zero;
                boolean flag = false;
                while ( true ) {
                        for ( int i = 1; i < (1 << k); i ++ ) {         // Êûö‰∏æÊúÄÈ´ò‰Ωç
                                res = res.add(dp[num][i]);              // num‰∏™Êï∞Â≠óÔºåÊúÄÈ´ò‰ΩçÊòØiÁöÑÊûÑÈÄ†ÊñπÂºè
                                if ( lowbit(i + 1) == i + 1 ) w --;     // ÊòØÊéíÂàó‰∏≠ÁöÑ‰∏Ä‰∏™Êï∞ÔºåËøõ‰∫Ü‰∏Ä‰Ωç
                                if ( w == 0 ) { flag = true; break; }   // ËøõÂà∞Â§¥‰∫Ü
                        }
                        if ( flag ) break;
                        num ++;
                }

                w = tmp;
                for ( int i = 1; i < (1 << k); i ++ ) { // ÂáèÂéª(2^k)ÈïøÂ∫¶‰∏∫1ÁöÑ‰∏≤
                        res = res.subtract(dp[1][i]);
                        if ( lowbit(i + 1) == i + 1 ) w --;
                        if ( w == 0 ) break;
                }
                System.out.println(res);
                input.close();
        }
}
```

<hr>

### Ê¥õË∞∑P2290_Ê†ëÁöÑËÆ°Êï∞

#### üîó
<a href="https://www.luogu.com.cn/problem/P2290"><img src="https://img-blog.csdnimg.cn/18b01b4fd60e4e1cac1ed7de753a8151.png"></a>

#### üí°
Áõ¥Êé•Ê†πÊçÆ<a href="">PruferÁºñÁ†ÅÊÄßË¥®3Êé®ËÆ∫</a>ËøõË°åËøô‰∏™ÂºèÂ≠êÁöÑËÆ°ÁÆó  
‰∏çËøáÈúÄË¶ÅÁâπÂà§ÂæàÂ§öÂú∞Êñπ  
1.Â¶ÇÊûúËäÇÁÇπÊï∞‰∏∫1ÔºåËæìÂÖ•ÁöÑÁÇπÂ∫¶Êï∞Âè™ËÉΩÊòØ‰∏Ä‰∏™0  
2.Â¶ÇÊûúËäÇÁÇπÊï∞‰∏ç‰∏∫1ÔºåÊúâ‰∏Ä‰∏™ËäÇÁÇπÂ∫¶Êï∞ÊòØ0Â∞±‰∏çË°å  
3.Â¶ÇÊûúËäÇÁÇπÊï∞‰∏ç‰∏∫1Ôºå<img src="https://latex.codecogs.com/svg.image?\sum\limits_{i=1}^nd_i&space;-&space;n&space;=&space;n-2" title="\sum\limits_{i=1}^nd_i - n = n-2" />ÊâçË°å  
  
Ëøô‰∫õÁâπÂà§Âà§Êéâ‰πãÂêéÂ∞±ËøõË°åËÆ°ÁÆóÂç≥ÂèØ  
Ë¶ÅÂºÄÈ´òÁ≤æ

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```java
public class Main {
        public static BigInteger one = BigInteger.ONE;
        public static BigInteger zero = BigInteger.ZERO;
        public static BigInteger two = BigInteger.valueOf(2);
        public static BigInteger ten = BigInteger.TEN;
        
        static int N = 200;
        static BigInteger[] f = new BigInteger[N];
        public static void get_F () {
                f[0] = one;
                for ( int i = 1; i < N; i ++ ) {
                        f[i] = f[i - 1].multiply(BigInteger.valueOf(i));
                }
        }
        static int n;
        static int[] d = new int[N];
        static int sumd = 0;

        public static void main ( String[] args ) {
                get_F();
                Scanner input = new Scanner(System.in);
                n = input.nextInt();
                for ( int i = 0; i < n; i ++ ) {
                        d[i] = input.nextInt();
                        sumd += d[i] - 1;
                }
                if ( n == 1 ) {
                        if ( d[0] == 0 ) System.out.println(1);
                        else             System.out.println(0);
                        return;
                }
                if ( sumd != n - 2 ) {
                        System.out.println(0);
                        return;
                }
                for ( int i = 0; i < n; i ++ )
                        if ( d[i] == 0 ) {
                                System.out.println(0);
                                return;
                        }

                BigInteger up = f[n - 2];
                BigInteger down = one;
                for ( int i = 0; i < n; i ++ ) down = down.multiply(f[d[i] - 1]);
                if ( down.compareTo(zero) != 0 ) System.out.println(up.divide(down));
                else                             System.out.println(0);

                input.close();
        }
}
```

<hr>

### Ê¥õË∞∑P2606_ÊéíÂàóËÆ°Êï∞

#### üîó
<a href="https://www.luogu.com.cn/problem/P2606"><img src="https://i.loli.net/2021/11/19/OYNjF4ecQx7MyCl.png"></a>

#### üí°
ÁúãÂà∞Ëøô‰∏™Á∫¶ÊùüÊù°‰ª∂  <img src="https://latex.codecogs.com/svg.image?\inline&space;[1\rightarrow2\And3],[2\rightarrow4\And5],..." title="\inline 1\rightarrow2\And3,2\rightarrow4\And5,..." />   
Êàë‰ª¨ÂèØ‰ª•ÊûÑÂª∫Âá∫‰∏ÄÊ£µ‰∫åÂèâÊ†ë  
‰ªé  <img src="https://latex.codecogs.com/svg.image?\inline&space;1" title="\inline 1" />  ÂºÄÂßãÔºåÊàë‰ª¨Êúâ  <img src="https://latex.codecogs.com/svg.image?\inline&space;Sz_1" title="\inline Sz_1" /> ‰∏™ËäÇÁÇπÔºåÂèØ‰ª•ÈÄâÊã©  <img src="https://latex.codecogs.com/svg.image?\inline&space;\binom{Sz_1-1}{Sz_2}" title="\inline \binom{Sz_1-1}{Sz_2}" /> ÊîæÂÖ•‰∫åÂè∑Â≠êÊ†ëÔºåÂÖ∂‰ΩôÊîæÂÖ•‰∏âÂè∑Â≠êÊ†ë  
ÈÄö‰øóÂú∞ËØ¥ÔºåÂ∞±ÊòØ  <img src="https://latex.codecogs.com/svg.image?\inline&space;\binom{Sz_x-1}{Sz_{x\times&space;2}}" title="\inline " /> ÊîæÂÖ•Â∑¶Â≠êÊ†ëÔºåÂÖ∂‰ΩôÊîæÂÖ•Âè≥Â≠êÊ†ë  
ËøôÊ†∑Â∞±ÊòØ  <img src="https://latex.codecogs.com/svg.image?\inline&space;C(Sz_x-1,Sz{x\times&space;2\times&space;Dfs(x\times2)\times&space;Dfs(x\times2+1)" title="\inline C(S" />   
  
Ê≥®ÊÑèÊ®°Êï∞ÂèØËÉΩÂæàÂ∞èÔºåÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÁî®  <img src="https://latex.codecogs.com/svg.image?\inline&space;Lucas" title="\inline Lucas" /> ÂÆöÁêÜ  

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >

```cpp
const int N = 3e6 + 10;

int n, mod;

inline ll ksm ( ll a, ll b ) { ll res = 1; while ( b ) { if ( b & 1 ) res = res * a % mod; a = a * a % mod; b >>= 1; } return res; }
inline ll inv ( ll x ) { return ksm(x, mod - 2); }
ll fac[N]; inline void get_Fac () { fac[0] = 1; for ( int i = 1; i < N; i ++ ) fac[i] = fac[i - 1] * i % mod; }
inline ll C ( ll n, ll m ) { 
        if ( n < m )   return 0;
        if ( n < mod ) return fac[n] * inv(fac[n - m]) % mod * inv(fac[m]) % mod; 
        return C ( n / mod, m / mod ) * C ( n % mod, m % mod ) % mod;
}

namespace Tree {
        ll sz[N];
        inline void get_Sz ( ll x ) {
                sz[x] = 1;
                if ( x * 2 <= n )     get_Sz ( x * 2 ),     sz[x] += sz[x * 2];
                if ( x * 2 + 1 <= n ) get_Sz ( x * 2 + 1 ), sz[x] += sz[x * 2 + 1];
        }
        inline ll dfs ( ll x ) {
                if ( x > n ) return 1; 
                return C ( sz[x] - 1, sz[2 * x] ) * dfs ( 2 * x ) % mod * dfs ( 2 * x + 1 ) % mod;
        }
} using namespace Tree;

int main () { 
        cin >> n >> mod;
        get_Fac (); get_Sz ( 1 );
        cout << dfs ( 1 ) << endl;
}
```

<hr>

### Ê¥õË∞∑P3048_CowIDsS

#### üîó
<a href="https://www.luogu.com.cn/problem/P3048">![20220428161753](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220428161753.png)</a>

#### üí°
Áî±‰∫éÊï∞‰ªéÂ∞èÂà∞Â§ßÔºåÈ¶ñÂÖàËÄÉËôëË∑≥Ëøá‰∏Ä‰∫õÈïøÂ∫¶ÁöÑÊï∞  
ÂØπ‰∫éÈïøÂ∫¶ $x$ ÔºåÊàë‰ª¨Â∞Ü‰∏Ä‰∏™ $1$ ÊãøÂá∫Êù•ÊîæÂà∞Á¨¨‰∏Ä‰∏™‰ΩçÁΩÆÔºåÂêéÈù¢ÁöÑ $x-1$ ‰∏™‰ΩçÁΩÆÊîæÁΩÆ $k-1$ ‰∏™ $1$ Êúâ $C_{x-1}^{k-1}$ ‰∏≠ÂàÜÂ∏ÉÊñπÂºè  
ÈÇ£‰πàÂ∞±ÂèØ‰ª•ÈÄöËøáËøôÊ†∑‰∏ÄÊ≠•Ê≠•ÂØπ $N$ ÂáèÂ∞èÊù•Âõ∫ÂÆöÂá∫Á≠îÊ°àÁöÑÈïøÂ∫¶ÊòØÂ§öÂ∞ë  
ÁÑ∂ÂêéÂâ©‰∏ã‰∫Ü $N$ ‰∏™ÊéíÂêçÔºåËÄÉËôëÊØè‰∏Ä‰ΩçÂ¶ÇÊûúÊîæ‰∫Ü $1$ ‰ºöÊèêÂçáÂ§öÂ∞ëÊéíÂêçÔºåÊàë‰ª¨Âè™Ë¶ÅËÆ©ÊéíÂêçÊèêÂçáÂà∞Á≠â‰∫é $N$ Âç≥ÂèØ  
Ëá≥‰∫éÊØè‰∏Ä‰ΩçÊîæÁΩÆ $1$ ÊèêÂçáÁöÑÊéíÂêçÔºå‰ª§ $n-i$ ‰∏∫ÂêéÈù¢ÁöÑ‰ΩçÁΩÆÊï∞Ôºå$one$ ‰∏∫Ââ©‰∏ãËøòÊ≤°ÊúâÊîæÁΩÆÁöÑ $1$ ÁöÑ‰∏™Êï∞   
ÈÇ£‰πàÊèêÂçáÁöÑÊéíÂêç‰∏∫ $C_{n-i}^{one}$   
Â¶ÇÊûúËøô‰∏™Êï∞ÊØî $N$ Â∞èÁöÑËØùÂ∞±ËÆ© $N$ ÂáèÂéªÂÆÉÂ∞±Ë°å‰∫ÜÔºåÂπ∂‰∏îÂâ©‰ΩôÊú™ÊîæÁΩÆÁöÑ $1$ ÁöÑ‰∏™Êï∞Âáè‰∏Ä  

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
inline int C (int n, int m) {
        if (m < 0 || n < m) return 0;
        if (m == 0 || n == m) return 1;
        int res = 1;
        int idx = 1;
        for (int i = m + 1; i <= n; i ++) {
                res *= i;
                while (idx <= n - m && res % idx == 0) {
                        res /= idx;
                        ++ idx;
                }
        }
        return res;
}

int main () {
        int N, K; scanf("%d%d", &N, &K);
        N --;
        int n = K - 1, m = 0;
        int Cnm = C(n, m);
        while (N - Cnm >= 0) {
                N -= Cnm; 
                ++ n, ++ m;
                Cnm = C(n, m);
        }
        int one = n - m;

        putchar('1');
        for (int i = 1; i <= n; ++ i) {
                int cur = C(n - i, one);
                if (cur <= N) {
                        N -= cur;
                        putchar('1');
                        one --;
                } else {
                        putchar('0');
                }
        } 
}
```
<hr>


### Ê¥õË∞∑P3904_‰∏âÂè™Â∞èÁå™

#### üîó
<a href="https://www.luogu.com.cn/problem/P3904">![20220427215637](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220427215637.png)</a>

#### üí°
Ê†πÊçÆÂõæÁâáÂ∞±ËÉΩÁúãÂá∫Ôºå$n$ ‰∏™‰∏çÂêåÁöÑÂ∞èÁå™ÊîæÂà∞ $m$ ‰∏™Áõ∏ÂêåÁöÑÊàøÈó¥ÈáåÈù¢ÔºåËøô‰∏çÂ∞±ÊòØÁêÉÁõíÊ®°ÂûãÂêóÔºü  
ÁúãÂà∞Êï∞ÊçÆÈáèÂ§ßÂäõ $\begin{Bmatrix}n\\m\end{Bmatrix}$   
Ôºà‰∏çËøáË¶ÅÂºÄÈ´òÁ≤æÂ∞±ÊòØ‰∫Ü

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```java
public class Main{
        static int N = 2005;
        static BigInteger zero = BigInteger.ZERO;
        static BigInteger one = BigInteger.ONE;
        static BigInteger two = BigInteger.valueOf(2);
        static BigInteger six = BigInteger.valueOf(6);
        static BigInteger ten = BigInteger.TEN;
        static BigInteger five = BigInteger.valueOf(5);
        static BigInteger[][] s = new BigInteger[100][100];
        public static void main(String[] args) {
                Scanner input = new Scanner(System.in);
                int n = input.nextInt(), m = input.nextInt();
                for (int i = 0; i <= n; i ++) for (int j = 0; j <= m; j ++) s[i][j] = zero;
                for (int i = 1; i <= n; i ++) {
                        for (int j = 1; j <= i; j ++) {
                                if (j == i || j == 1) s[i][j] = one;
                                else s[i][j] = BigInteger.valueOf(j).multiply(s[i - 1][j]).add(s[i - 1][j - 1]);
                        }
                }
                System.out.println(s[n][m]);
                input.close();
        }
}
```
<hr>

### Ê¥õË∞∑P3937_Changing

#### üîó
<a href="https://www.luogu.com.cn/problem/P3937">![20220428162711](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220428162711.png)</a>

#### üí°
ÂàÜÊûêÁ¨¨ $a_{t,i}$ ÁöÑËΩ¨ÁßªÂÖ≥Á≥ª  
$\begin{aligned}
&1a_{t,i}\\
=&1a_{t-1,i}+1a_{t-1,i+1}\\
=&1a_{t-2,i}+2a_{t-2,i+1}+1a_{t-2,i+2}\\
=&1a_{t-3,i}+3a_{t-3,i+1}+3a_{t-3,i+2}+1a_{t-3,i+3}\\
...
\end{aligned}(mod\;2)$  
Êç¢Âè•ËØùËØ¥ $a_{t,k}=a_{t-1,k}+a_{t-1,k+1}$ Ëøô‰∏™ÂºèÂ≠êÂ∞±ÂæàÂÆπÊòìËÆ©‰∫∫ËÅîÊÉ≥Âà∞Êù®Ëæâ‰∏âËßí  
ÈÇ£‰πàÂèØ‰ª•Êé®Âá∫Êù•ÂºèÂ≠ê $a_{t,k}=\sum\limits_{i=0}^tC_t^ia_{0,k+i}$  
Á≠â‰∫éËØ¥Â¶ÇÊûú $C_t^i=1$ ÈÇ£‰πà $a_{0,k+i}$ Â∞±‰ºö‰∫ßÁîüË¥°ÁåÆ  
Ê®° $2$ ÁöÑÊù®Ëæâ‰∏âËßíËÄÉËôë [Sierpinski‰∏âËßíÂΩ¢Êé®Âá∫Êù•ÁöÑÊù®Ëæâ‰∏âËßí‰∏éËøõÂà∂ÂÖ≥Á≥ª](https://tech.chivas-regal.top/blogs/algorithm/math/sierpinski-triangle.html#%E6%9D%A8%E8%BE%89%E4%B8%89%E8%A7%92-%E4%B8%8E-%E8%BF%9B%E5%88%B6)  
ÂèØ‰ª•ÂèëÂèëÁé∞ÂΩì $t\&i=i$ Êó∂ $a_{k+i}$ ÊòØÊúâË¥°ÁåÆÁöÑÔºåÂä†‰∏äÂç≥ÂèØ  
ÊúÄÂêéÁúãÁ≠îÊ°àÁöÑÂ•áÂÅ∂ÊÄß 

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
int n, t, k;
inline int add (int x, int y) {return (x + y) % n;}

int main () {
        ios::sync_with_stdio(false);
        cin.tie(nullptr);

        cin >> n >> t >> k; k --;
        vector<int> a(n); for (int i = 0; i < n; i ++) cin >> a[i];

        int res = 0;
        for (int i = 0; i <= t; i ++) {
                if ((t | i) == t) res ^= a[add(k, i)];
        }
        cout << res << endl;
}
```
<hr>

### Ê¥õË∞∑P4562_Ê∏∏Êàè

#### üîó
<a href="https://www.luogu.com.cn/problem/P4562">![20220428164821](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220428164821.png)</a>

#### üí°
ÂàÜÊûê‰∏ÄÊ≥¢È¢òÊÑèÔºå<b>$t(p)$ Â∞±ÊòØÂØπ‰∫éÊéíÂàó $p$ ÔºåÊ≤°ÊúâÂõ†Â≠êÁöÑÊï∞Âá∫Áé∞ÁöÑÊúÄÂêé‰ΩçÁΩÆ</b>   
  
ÈÇ£‰πàÊàë‰ª¨Â∞ÜÊâÄÊúâÊï∞ÂàÜ‰∏∫  
$div_1$ÔºöÊó†Âõ†Â≠êÁöÑÊï∞ÁöÑÊï∞Èáè  
$div_2$ÔºöÊúâÂõ†Â≠êÁöÑÊï∞ÁöÑÊï∞Èáè  
Ëøô‰∏™ÂèØ‰ª•ÈÄöËøáÂüÉÊ∞èÁ≠õÊ±ÇÂæó   
  
ÂØπ‰∫éÁ≠îÊ°àÔºåËÄÉËôëË¥°ÁåÆÔºåÂç≥‰∏∫ÂØπ‰∫éÊØè‰∏Ä‰∏™‰ΩçÁΩÆ $i$ÔºåÊ±ÇÂÆÉËÉΩ‰Ωú‰∏∫ $t(p)$ ÁöÑÊéíÂàóÊï∞Èáè $num$   
ÈÇ£‰πàÁ≠îÊ°à‰æøÊòØ $\sum\limits_i(i\times num)$   
  
ÂØπ‰∫é $num$ ÁöÑÊ±ÇÊ≥ï:  
- Êàë‰ª¨ËÆ© $div_1$ ÂÖ∂‰∏≠‰∏Ä‰∏™Âç°Âú®Á¨¨ $i$ ‰∏™‰ΩçÁΩÆ  
- ÂÖ∂‰ΩôÁöÑ $div_1-1$ ‰∏™Êï∞Âú® $[1,i)$ ÈáåÈù¢‰ªªÊÑèÂàÜÂ∏É  
- ËøôÈáåÊàë‰ª¨Âè™ÊòØËÄÉËôë‰∫Ü‰ΩçÁΩÆ„ÄÇËøòË¶ÅËÄÉËôëÊñπÊ°àÊï∞ ÊâÄ‰ª• $div_1,div_2$ ‰πüÈÉΩË¶ÅÂÖ®ÊéíÂàó‰∏Ä‰∏ã 

ÈÇ£‰πà $num=1\times \binom{i-1}{div_1-1}\times (div_1!)\times (div_2!)$  

Áî±‰∫éÂâç $i$ ‰∏™‰ΩçÁΩÆË¶ÅÂ≠òÊîæÂÆå $div_1$ ‰∏™Êï∞ÔºåÊâÄ‰ª• $i\in[div_1,n]$  
ÊâÄ‰ª•Á≠îÊ°à‰∏∫  
$$\sum\limits_{i=div_1}^n(1\times\binom{i-1}{div_1-1}\times (div_1!)\times (div_2!)\times i)$$

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
const int N = 1e7 + 10;
const int mod = 1e9 + 7;

inline ll ksm (ll a, ll b) { ll res = 1; while (b) { if (b & 1) res = res * a % mod; a = a * a % mod; b >>= 1; } return res; }
inline ll inv (ll x) { return ksm(x, mod - 2); }

ll f[N], ivf[N];
inline void Pre () {
        f[0] = 1;
        for (int i = 1; i < N; i ++) f[i] = f[i - 1] * i % mod;
        ivf[N - 1] = inv(f[N - 1]);
        for (int i = N - 2; i >= 0; i --) ivf[i] = ivf[i + 1] * (i + 1) % mod;
}
inline ll C (int n, int m) {
        return f[n] * ivf[m] % mod * ivf[n - m] % mod;
}

bool vis[N];

int main () {
        ios::sync_with_stdio(false);
        cin.tie(nullptr);

        Pre();

        int l, r; cin >> l >> r;
        int n = r - l + 1;

        int div1 = 0, div2 = n;
        for (int i = l; i <= r; i ++) {
                if (!vis[i]) {
                        div1 ++;
                        div2 --;
                        for (int j = i + i; j <= r; j += i) vis[j] = true;
                }
        }

        ll res = 0;
        for (int i = div1; i <= n; i ++) {
                res += C(i - 1, div1 - 1) * f[div1] % mod * f[div2] % mod * i % mod;
                res %= mod;
        }
        cout << res << endl;
}
```
<hr>

### Ê¥õË∞∑P4912_ÊÉÖ‰æ£ÔºüÁªôÊàëÁÉß‰∫ÜÔºÅ

#### üîó
<a href="https://www.luogu.com.cn/problem/P4921">![20220706215418](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220706215418.png)</a>

#### üí°
‰∏Ä‰∏™Ê†∏ÂøÉ‰∏∫Ê±ÇÈîô‰ΩçÂÖ®ÊéíÂàóÁöÑÈóÆÈ¢ò  
È¶ñÂÖàÂéªÁÆóÊúâ $k$ ‰∏™ÂåπÈÖç‰∏äÁöÑÊñπÊ°àÊï∞  
ÈÄâÊã© $k$ ÂØπÊÉÖ‰æ£ÔºåÈÄâÊã© $k$ ‰∏™‰ΩçÁΩÆÔºåÊÉÖ‰æ£ËøõË°åÂÖ®ÊéíÂàóÂç≥ $k!$ ÔºåÊØèÂØπÊÉÖ‰æ£Â∑¶Âè≥È°∫Â∫èÂèØ‰ª•‰∫íÊç¢ $2^k$ ÔºåÂâ©‰∏ã $(n-k)$ ÂØπÊÉÖ‰æ£ËøõË°åÂèØÁî∑Áî∑„ÄÅÂ•≥Â•≥„ÄÅÁî∑Â•≥„ÄÅÂ•≥Áî∑ÁöÑÈîô‰ΩçÂÖ®ÊéíÂàó $ep[n-k]$   
Âç≥Ôºö$res[k]=C_n^kC_n^k(k!)2^kep[n-k]$  
  
Êé•‰∏ãÊù•ÊòØËÄÉËôëËøô‰∏™ $ep[k]$ ÊòØÊÄé‰πàÊ±ÇÁöÑ  
<b>Á¨¨‰∏ÄÊéíÈÄâÊã©ÂêåÊÄßÔºö</b>  
$k$ ‰∏™‰∫∫Êúâ $k(k-1)$ ÁßçÈÄâÊã©ÊñπÂºè  
Â¶ÇÊûúta‰ª¨ÁöÑÂØπË±°ËøõË°åÂåπÈÖçÔºåÂàôÂú®Ââ©‰∏ãÁöÑ $k-1$ Êéí‰∏≠ÈÄâÊã©‰∏ÄÊéíÂèØ‰ª•Â∑¶Âè≥‰∫§ÂùêÔºåÁÑ∂ÂêéÂâ©‰ΩôÁöÑ $k-2$ ÂØπÊÉÖ‰æ£ËøõË°åÈîô‰ΩçÂåπÈÖçÔºåÂç≥ $2(k-1)ep[k-2]$  
Â¶ÇÊûú‰ªñ‰ª¨ÁöÑÂØπË±°‰∏çËøõË°åÂåπÈÖçÔºåÈÇ£‰πàÊää‰ªñ‰ª¨ÁöÑÂØπË±°ÁúãÂÅö‰∏ÄÂØπÊÉÖ‰æ£ÔºåÂàôÂâ©‰∏ãÊúâ $k-1$ ÂØπÊÉÖ‰æ£ÔºåÂç≥ $ep[k-1]$   
ËØ•ÁßçÈÄâÊã©ÊñπÊ≥ïÊúâ $2k(k-1)(ep[k-1]+2(k-1)ep[k-2])$  
<b>Á¨¨‰∏ÄÊéíÂùêÂºÇÊÄßÔºö</b>  
ÈÄâÊã©ÊñπÂºè‰æùÁÑ∂ÊòØÊúâ $k(k-1)$ ÁßçÊñπÂºè  
Êé®ÂØºËøáÁ®ã‰∏çÂèòÔºåÂàô‰πüÊòØÊúâ $2k(k-1)(ep[k-1]+2(k-1)ep[k-2])$   
<b>ÂæóÂà∞Ôºö$ep[k]=4k(k-1)(ep[k-1]+2(k-1)ep[k-2])$ </b>  
Â∞ÜÂÖ∂È¢ÑÂ§ÑÁêÜÂá∫Êù•‰πãÂêéÁõ¥Êé•Áî®‰∏äÈù¢ÁöÑ $res[k]$ ÂÖ¨ÂºèÂç≥ÂèØ     

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
const int mod = 998244353;
const int N = 1e3 + 10;
ll f[N], ivf[N];
ll ep[N];


inline ll ksm (ll a, ll b) { ll res = 1; while (b) { if (b & 1) res = res * a % mod; a = a * a % mod; b >>= 1; } return res; }
inline ll inv (ll x) { return ksm(x, mod - 2); }
inline ll C (int n, int m) { return f[n] * ivf[n - m] % mod * ivf[m] % mod; }
inline ll A (int n, int m) { return f[n] * ivf[n - m] % mod; }
inline void Pre () {
        f[0] = 1;
        for (int i = 1; i < N; i ++) f[i] = f[i - 1] * i % mod;
        ivf[N - 1] = inv(f[N - 1]);
        for (int i = N - 2; i >= 0; i --) ivf[i] = ivf[i + 1] * (1ll * i + 1) % mod;

        ep[0] = 1; ep[1] = 0;
        for (int i = 2; i < N; i ++) ep[i] = 4ll * i % mod * (i - 1) % mod * ((ep[i - 1] + 2ll * (i - 1) % mod * ep[i - 2]) % mod) % mod;
}

inline void Solve () {
        int n; cin >> n;
        for (int i = 0; i <= n; i ++) {
                cout << C(n, i) * C(n, i) % mod * f[i] % mod * ksm(2, i) % mod * ep[n - i] % mod << endl;
        }
}

int main () {
        ios::sync_with_stdio(false);
        cin.tie(nullptr);

        Pre();
        int cass; cin >> cass; while (cass --) {
                Solve ();
        }
}
```
<hr>


### Ê¥õË∞∑P4936_Agent1

#### üîó
<a href="https://www.luogu.com.cn/problem/P4936"><img src="https://i.loli.net/2021/11/14/Q5Y7Z8RilKTuLyV.png"></a>

#### üí°
AB‰∏§ÈòüÔºåÊØèÈòüÂøÖÂá∫‰∏Ä‰∏™‰∫∫  
Êàë‰ª¨ÂèØ‰ª•Êûö‰∏æÊØèÈòüË∞ÅÂøÖÂá∫ÔºåÁÑ∂Âêé‰∏∫‰∫Ü‰øùËØÅ  <img src="https://latex.codecogs.com/svg.image?\inline&space;max\{A\}<min\{B\}" title="\inline max\{A\}<min\{B\}" /> Êàë‰ª¨ËÆ©ÊØèÈòüÂá∫ÁöÑ‰∏§‰∏™‰∫∫‰∏≠Èó¥ÁöÑÊï∞ÂøÖ‰∏çÂá∫Ôºå‰∏§‰æßÁöÑÊï∞ÈÄâÂá∫  
ËøôÊ†∑ÁöÑËØùÂ∞±ÊòØ  <img src="https://latex.codecogs.com/svg.image?\inline&space;\sum\limits_{i=1}^n\sum\limits_{j=i+1}^n(2^{i-1}\times&space;2^{n-j})" title="\inline \sum\limits_{i=1}^n\sum\limits_{j=i+1}^n(2^{i-1}\times&space;2^{n-j})" />   
ËøôÊòØ‰∏Ä‰∏™  <img src="https://latex.codecogs.com/svg.image?\inline&space;O(n^2)" title="\inline O(n^2)" /> ÁöÑÊüøÂ≠êÔºåÊàë‰ª¨‰ºòÂåñ‰∏Ä‰∏ã  
  
 <img src="https://latex.codecogs.com/svg.image?\inline&space;\begin{aligned}&\sum\limits_{i=1}^n\sum\limits_{j=i+1}^n(2^{i-1}\times&space;2^{n-j})\\=&\sum\limits_{i=1}^n\sum\limits_{j=0}^{n-i-1}(2^{i-1}\times&space;2^j)\\=&\sum\limits_{i=0}^{n-1}\sum\limits_{j=0}^{n-i-2}(2^i\times&space;2^j)\\=&\sum\limits_{i=0}^{n-1}2^i\sum\limits_{j=0}^{n-i-2}2^j\\=&\sum\limits_{i=0}^{n-1}(2^i\times(2^{n-i-1}-1))\\=&\sum\limits_{i=0}^{n-1}(2^{n-1}-2^i)\\=&n2^{n-1}-(2^n-1)\end{aligned}" title="\inline \begin{aligned}&\sum\limits_{i=1}^n\sum\limits_{j=i+1}^n(2^{i-1}\times&space;2^{n-j})\\=&\sum\limits_{i=1}^n\sum\limits_{j=0}^{n-i-1}(2^{i-1}\times&space;2^j)\\=&\sum\limits_{i=0}^{n-1}\sum\limits_{j=0}^{n-i-2}(2^i\times&space;2^j)\\=&\sum\limits_{i=0}^{n-1}2^i\sum\limits_{j=0}^{n-i-2}2^j\\=&\sum\limits_{i=0}^{n-1}(2^i\times(2^{n-i-1}-1))\\=&\sum\limits_{i=0}^{n-1}(2^{n-1}-2^i)\\=&n2^{n-1}-(2^n-1)\end{aligned}" />   
   
Â•Ω‰∫ÜÔºåËøô‰πà‰∏Ä‰∏™  <img src="https://latex.codecogs.com/svg.image?\inline&space;O(logn)" title="\inline O(1)" /> ÁöÑÊüøÂ≠êÂ∞±Âá∫Êù•‰∫Ü  

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >

```cpp
cout << (n * ksm(2, n - 1) % mod - (ksm(2, n) + mod - 1) % mod + mod) % mod << endl;
```

<hr>

### Ê¥õË∞∑P4981_Áà∂Â≠ê

#### üîó
<a href="https://www.luogu.com.cn/problem/P4981"><img src="https://img-blog.csdnimg.cn/7aaa69d40d29470988f7850e33407ecc.png"></a>

#### üí°
Êï¥‰∏™ÂØùÂÆ§ÁöÑÂÖ≥Á≥ªÂõæÂæàÂÆπÊòìÁúãÊàê‰∏ÄÊ£µÊ†ë  
ËÄå‰∏îÊòØ‰∏ÄÊ£µn‰∏™‰∫∫ËΩÆÊµÅÂΩìÊ†πÁöÑÊ†ë  
ÂØπ‰∫éÊØè‰∏Ä‰∏™‰∫∫ÂΩìÁ•ñÂÖàÔºåÊ†πÊçÆpruferÁºñÁ†ÅÊÄßË¥®Êúâ<img src="https://latex.codecogs.com/svg.image?n^{n-2}" title="n^{n-2}" />ÁßçÊ†ë  
ËÄån‰∏™‰∫∫ÂΩìÁ•ñÂÖàÂ∞±ÊòØ  
<img src="https://latex.codecogs.com/svg.image?n^{n-2}\times&space;n=n^{n-1}" title="n^{n-2}\times n=n^{n-1}" />

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >

```cpp
const int mod = 1e9 + 9;
inline ll ksm ( ll a, ll b ) {
        ll res = 1;
        while ( b ) {
                if ( b & 1 ) res = res * a % mod;
                a = a * a % mod;
                b >>= 1;
        }
        return res;
}

int main () {
        int cass;
        for ( cin >> cass; cass; cass -- ) {
                int n; cin >> n;
                cout << ksm ( n, n - 1 ) << endl;
        }
        return 0;
}
```

<hr>

### Ê¥õË∞∑P5377_È∏ΩÈ∏ΩÁöÑÂàÜÂâ≤

#### üîó
<a href="https://www.luogu.com.cn/problem/P5377">![20220316215315](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220316215315.png)</a>

#### üí°
ÁÇπÂíåÈù¢ÈÄöËøáÂª∫Ê®°‰∏∫Á´ã‰ΩìÂá†‰ΩïÊÉ≥Ê¨ßÊãâÂÖ¨ÂºèÔºö  
$$F=E-V+2$$  
ÂÖ∂‰∏≠ $F$ ‰∏∫ÂàÜÂâ≤ÂùóÊï∞Ôºå $E$ ‰∏∫ËæπÊï∞Ôºå $V$ ‰∏∫ÁÇπÊï∞  
$V=$ ÂéüÊú¨ÁÇπÊï∞ $+$ ‰ªªÂèñÂõõ‰∏™ÁÇπËøûÁ∫øÁõ∏‰∫§ $=n+\binom{n}{2}$  
$E=$ Âºß $+$ ÂéüÊú¨ÁÇπ‰πãÈó¥Áõ∏Ëøû $+$ ËøûÁ∫ø‰∫§ÁÇπÂàÜÂâ≤Âá∫‰∏§Êù°Ëæπ $=n+\binom{n}{2}+2\times\binom{n}{4}$  
Ê≥®ÊÑèÂú®Á´ã‰ΩìÂá†‰Ωï‰∏äÂ§ö‰∫Ü‰∏Ä‰∏™Èù¢‰∏∫ÂúÜÂ§ñÁöÑÈù¢ÔºåË¶ÅÂáèÂéª‰∏Ä  

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
int main() {
    int n;

    while (scanf("%d", &n) != EOF) {
        int Cn4 = n * (n - 1) * (n - 2) * (n - 3) / 24;
        int Cn2 = n * (n - 1) / 2;
        int E = n + Cn2 + 2 * Cn4;
        int V = n + Cn4;
        printf("%d\n", E - V + 2 - 1);
    }
}
```
<hr>

### Ê¥õË∞∑P6162_ÂõõËßíÈìæ

#### üîó
<a href="https://www.luogu.com.cn/problem/P6162">![20220428165151](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220428165151.png)</a>

#### üí°  
ÊØè‰∏Ä‰∏™Êï∞ $x$ ÂèØ‰ª•Â°´ÁöÑÊï∞Â≠ó‰∏ÄÂÆöÊòØ $x$ ÂáèÂéªÂâçÈù¢ÈÄâ‰∏≠ÁöÑÊï∞ÁöÑ‰∏™Êï∞  
  
Êàë‰ª¨ÂÖàÊù•Â∞ùËØï‰∏Ä‰∏™ $O(n^2)$ ÁöÑÁÆóÊ≥ï  
‰ª§ $dp[n][m]$ Ë°®Á§∫Ââç $n$ ‰∏™‰ΩçÁΩÆÈÄâ‰∫Ü $m$ ‰∏™Â°´Êï∞  
ÈÇ£‰πàÂØπ‰∫é $n$ ÂèØ‰ª•Â°´Êï∞Ôºå$dp[n][m]+\quad (n-m+1)\times dp[n-1][m-1]$   
‰πüÂèØ‰ª•‰∏çÂ°´Êï∞Ôºå$dp[n][m]+\quad dp[n-1][m]$  
‰πüÂ∞±ÊòØËØ¥ $dp[n][m]=dp[n-1][m]+(n-m+1)\times dp[n-1][m-1]$  
ÂèØ‰ª•ÊÑüËßâÂà∞Ëøô‰∏™‰∏úË•øÂ∞±ÊòØ‰∏Ä‰∏™È°πÂ∏¶‰∫ÜÁ≥ªÊï∞ÁöÑÁªÑÂêàÊï∞ÈÄíÊé®ÔºåÂæàÂÉèÁ¨¨‰∫åÁ±ªÊñØÁâπÊûóÊï∞ $\begin{Bmatrix}n\\m\end{Bmatrix}=\begin{Bmatrix}n-1\\m-1\end{Bmatrix}+m\begin{Bmatrix}n-1\\m\end{Bmatrix}$   
Âè™‰∏çËøáÁ≥ªÊï∞Â∏¶Èîô‰∫Ü‰ΩçÁΩÆ‰∏î‰∏çÊòØÁªìÂ∞æÔºåÈÇ£‰πàÊàë‰ª¨ËÆ© $n$ ‰∏äÂçá $1$ ÔºåÂêåÊó∂Á≥ªÊï∞Ë¶ÅÂèòÊàê $m$ ÔºåÈÇ£‰πàÂ∞±ËÆ© $m$ ÂèòÊàê $(n+1)-m$  Ôºå‰πüÂ∞±ÊòØËØ¥ $dp[n][m]=\begin{Bmatrix}n+1\\n+1-m\end{Bmatrix}$  
ÂèëÁé∞ËøôÊ†∑ËΩ¨ÁßªËøáÊù•Â∞±ÊòØ $\begin{Bmatrix}n+1\\n+1-m\end{Bmatrix}=\begin{Bmatrix}n\\n-m\end{Bmatrix}+(n-m+1)\times \begin{Bmatrix}n\\n+1-m\end{Bmatrix}$   
ÂíåÁ¨¨‰∫åÁ±ªÊñØÁâπÊûóÊï∞ÁöÑÂÖ¨Âºè‰∏ÄÊ†∑‰∫Ü  
ÈÇ£‰πàÊàë‰ª¨Â∞±ÊòØ $O(n)$ Âú∞Ê±Ç‰∏Ä‰∏ã $\begin{Bmatrix}n+1\\n+1-m\end{Bmatrix}$ Âç≥ÂèØ  
  
$\begin{Bmatrix}n\\m\end{Bmatrix}=\sum\limits_{i=0}^m\frac{(-1)^{m-i}i^n}{i!(m-i)!}$


#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
const int mod = 998244353;
const int N = 1e6 + 10;

inline ll ksm (ll a, ll b) { ll res = 1; while (b) { if (b & 1) res = res * a % mod; a = a * a % mod; b >>= 1; } return res; }
inline ll inv (ll x) { return ksm(x, mod - 2); }

ll f[N], ivf[N];
inline void Pre () {
        f[0] = 1;
        for (int i = 1; i < N; i ++) f[i] = f[i - 1] * i % mod;
        ivf[N - 1] = inv(f[N - 1]);
        for (int i = N - 2; i >= 0; i --) ivf[i] = ivf[i + 1] * (i + 1) % mod;
}
inline ll S (int n, int m) {
        ll res = 0;
        for (int i = 0; i <= m; i ++) {
                (res += ((m - i) & 1 ? -1ll : 1ll) * ksm(i, n) % mod * ivf[i] % mod * ivf[m - i] % mod) %= mod;
                res = (res + mod) % mod;
        }
        return res;
}

int main () {      
        cin.tie(nullptr);
        Pre();
        int n, k; cin >> n >> k; n --;
        cout << S(n + 1, n + 1 - k);
}
```
<hr>

## ÁâõÂÆ¢2022ÂõΩÂ∫ÜÈõÜËÆ≠Ê¥æÂØπday3G_Subsequence1

#### üîó
<a href="https://ac.nowcoder.com/acm/contest/41757/G">![20221003205321](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20221003205321.png)</a>

#### üí°
Â¶ÇÊûúÂú® $s$ ‰∏≠Ë¶ÅËé∑ÂæóÂíå $t$ ÂêåÈïøÂ∫¶ÁöÑ‰∏≤ÔºåÈÇ£‰πàÂ∞±ÊòØ‰∏Ä‰∏™ÂêåÈïøÂ≠êÂ∫èÂàóÁöÑÂ≠óÂÖ∏Â∫èÂÅèÂ∫èËÆ°Êï∞ÈóÆÈ¢ò‰∫Ü  
‰ª§ $s_s$ Ë°®Á§∫ $s$ ÁöÑÂ≠êÂ∫èÂàóÔºåÊàë‰ª¨Ë¶ÅÁúãÂú®Âì™‰∏Ä‰ΩçËÆ© $s_s>t$ ÔºåËøô‰πãÂêéÁöÑÊòØÂèØ‰ª•Èöè‰æøÈÄâÁöÑ  
Â¶ÇÊûú $s_i>t_j$ ÔºåÈÇ£‰πàÂ∞±ÈúÄË¶ÅËÆ°‰∏Ä‰∏™ $s$ Âú® $i$ ÂâçÈù¢ËÉΩÊâæÂà∞Â§öÂ∞ë‰∏™‰∏é $t[1,j-1]$ ÂèØ‰ª•ÂåπÈÖç‰∏äÁöÑÂ≠êÂ∫èÂàó  
Ëøô‰∏™Áî®‰∏Ä‰∏™ $dp$ Êù•ÂÆûÁé∞Ôºå$dp[i][j]$ Ë°®Á§∫ $s$ Âú®Ââç $i$ ‰ΩçËÉΩÂåπÈÖç‰∏ä $t[1,j]$ ÁöÑÂ≠êÂ∫èÂàóÊï∞Èáè  
$dp[i][]$ Áî® $dp[i-1][]$ Êù•ËΩ¨ÁßªÔºåÊûö‰∏æ $i-1$ ÂåπÈÖç‰∫ÜÂ§öÂ∞ë‰∏™ÔºåÈÇ£‰πàÂ¶ÇÊûú $s_i=t_j$ Ôºå$dp[i][j+1]$ Âä†‰∏ä $dp[i-1][j]$ ÔºåÁÑ∂ÂêéÊ≠£Â∏∏ÁªßÊâøÂÖ≥Á≥ª‰∏∫ $dp[i][j]+dp[i-1][j]$  
Â§ÑÁêÜÂ•ΩËøô‰∏™ $dp$ ÂêéÔºåÁúãÂì™‰∏Ä‰Ωç $s_i>t_j$ ÔºåÊâæÂà∞ÂêéÁ≠îÊ°àÁ¥ØÂä† $\binom{n-i}{m-j}\times dp[i-1][j-1]$ Âç≥ÂèØÔºåÂç≥Ë°®Á§∫ÂâçÈù¢ÈÉΩÂåπÈÖç‰∏äÔºåÂêéÈù¢Èöè‰æøÈÄâ  

ÂΩìÁÑ∂ÊúÄÂêé‰πüË¶ÅÂä†‰∏äÈïøÂ∫¶Ë∂ÖËøá $m$ ÁöÑÂ≠êÂ∫èÂàóÊï∞ÈáèÔºå‰∏∫ $\sum\limits_{i=m+1}n\binom{n-j}{i-1}$   
Áî±‰∫é‰∏çËÉΩÊúâÂâçÂØº $0$ ÔºåÂ∞±ÂØπ‰∫éÈïøÂ∫¶ $i$ Êó∂ÔºåÊûö‰∏æ‰∏Ä‰∏ã $s_j$ ÊòØÂê¶‰∏∫ $0$ ÔºåÂ¶ÇÊûú‰∏∫ $0$ ÔºåËØ¥Êòé‰ª•ÂÆÉÂºÄÂ§¥ÁöÑÈÉΩ‰∏çÂèØ‰ª•ÈÄâÔºåÂáèÂéª $\binom{n-j}{i-1}$  


#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
const int N = 3010;
const int mod = 998244353;
int f[N], ivf[N];
inline int C (int n, int m) {
    if (m > n) return 0;
    return (ll)f[n] * ivf[m] % mod * ivf[n - m] % mod;
}
inline int ksm (int a, int b) {
    int res = 1;
    while (b) {
        if (b & 1) res = 1ll * res * a % mod;
        a = 1ll * a * a % mod;
        b >>= 1;
    }
    return res;
}
inline int inv (int x) { return ksm(x, mod - 2); }

int n, m;
string s, t;
int dp[N][N];

inline void Solve () {
    int res = 0;
    cin >> n >> m >> s >> t;
    s = "0" + s;
    t = "0" + t;

    dp[0][0] = 1;
    
    for (int i = 1; i <= n; i ++) {
        for (int j = 0; j <= m; j ++) {
            if (j + 1 <= m && s[i] == t[j + 1]) {
                (dp[i][j + 1] += dp[i - 1][j]) %= mod;
            }
            (dp[i][j] += dp[i - 1][j]) %= mod;
        }
        for (int j = 1; j <= m; j ++) {
            if (s[i] > t[j]) {
                res += (ll)C(n - i, m - j) * dp[i - 1][j - 1] % mod;
                res %= mod;
            }
        }  
    }

    for (int i = 0; i <= n; i ++) for (int j = 0; j <= m; j ++) dp[i][j] = 0;

    for (int i = m + 1; i <= n; i ++) {
        (res += C(n, i)) %= mod;
        for (int j = 1; j <= n; j ++) {
            if (s[j] == '0') {
                res = ((res - C(n - j, i - 1)) % mod + mod) % mod;
            }
        }
    }
    cout << res << endl;
}

int main () {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);

    f[0] = 1;
    for (int i = 1; i < N; i ++) f[i] = (ll)f[i - 1] * i % mod;
    ivf[N - 1] = inv(f[N - 1]);
    for (int i = N - 2; i >= 0; i --) ivf[i] = (ll)ivf[i + 1] * (i + 1) % mod;

    int cass; cin >> cass; while ( cass -- ) {
        Solve ();
    }
}
```
<hr>

### ÁâõÂÆ¢2022ÂØíÂÅáÁÆóÊ≥ïÂü∫Á°ÄÈõÜËÆ≠Ëê•4G_Â≠êÂ∫èÂàóÊùÉÂÄº‰πòÁßØ

#### üîó
<a href="https://ac.nowcoder.com/acm/contest/23479/G"><img src="https://img-blog.csdnimg.cn/636cc7a3d9dd4b898721425de121988e.png"></a>

#### üí°
ËÄÉËôëÊØè‰∏™Êï∞‰Ωú‰∏∫ $min$ Âíå $max$ Âá∫Áé∞ÁöÑÊ¨°Êï∞  
ÂàÜÊàêËøô‰πà‰∏§Á±ª  
- Ëá™Â∑±Ëøô‰∏™Êï∞Âú®Êï¥‰∏™Â∫èÂàó‰∏≠Âè™Âá∫Áé∞‰∏ÄÊ¨°
- Ëá™Â∑±Ëøô‰∏™Êï∞Âú®Êï¥‰∏™Â∫èÂàó‰∏≠Âá∫Áé∞‰ªªÊÑèÊ¨°
  
ÂØπ‰∫éÁ¨¨‰∏ÄÁ±ªÔºö  
Êàë‰ª¨ÊâæÂá∫ÊØîËá™Â∑±Â§ßÁöÑÊï∞ÁöÑ‰∏™Êï∞ËÆæÁΩÆ‰∏∫ `gre`ÔºåÊØîËá™Â∑±Â∞èÁöÑËÆæÁΩÆ‰∏∫ `les`  
Áî±‰∫éÂèØ‰ª•ÈÄâÊàñËÄÖ‰∏çÈÄâÔºåÊâÄ‰ª• $x$ ‰∏™Êï∞Â∞±Êúâ $2^x$ ÁßçÊñπÊ°à  
ÈÇ£‰πàËøôÁ±ªÊÉÖÂÜµÂÅöÂá∫ÁöÑË¥°ÁåÆ‰∏∫ $a^{2^{les}}\times a^{2^{gre}}$   
  
ÂØπ‰∫éÁ¨¨‰∫åÁ±ªÔºö  
È¶ñÂÖàÊàë‰ª¨Ëá™Â∑±Êúâ $b$ ‰∏™ÔºåÁÑ∂Âêé‰æùÊóßÊòØÊØîËá™Â∑±Â§ßÁöÑÊï∞ÁöÑ‰∏™Êï∞ËÆæÁΩÆ‰∏∫ `gre`ÔºåÊØîËá™Â∑±Â∞èÁöÑËÆæÁΩÆ‰∏∫ `les`  
Ëá™Â∑±Ëá≥Â∞ëË¶ÅÈÄâ‰∏§‰∏™ÔºåÂà´ÁöÑÈÄâÊàñËÄÖ‰∏çÈÄâ  
ÈÇ£‰πàË¥°ÁåÆ‰∏∫ $a^{(2^b-1-b)\times 2^{les}}\times a^{(2^b-1-b)\times 2^{gre}}$   
  
::: danger
Êúâ‰∏Ä‰∏™ÁªÜËäÇÊòØÂèñÊ®°ÁöÑÊó∂ÂÄôÊåáÊï∞‰∏çÂ∫îÊòØÂèñ $10^9+7$   
ËÄåÊòØÊ†πÊçÆÊ¨ßÊãâÈôçÂπÇÂèñ $\phi(10^9+7)=10^9+6$ 
:::
  
[Êú¨È¢òÁ∫øÊÆµÊ†ëËß£Ê≥ïËØ∑ÁúãËøôÈáå](https://tech.chivas-regal.top/blogs/solution/datastructure/segmenttree.html#%E7%89%9B%E5%AE%A22022%E5%AF%92%E5%81%87%E7%AE%97%E6%B3%95%E5%9F%BA%E7%A1%80%E9%9B%86%E8%AE%AD%E8%90%A54g-%E5%AD%90%E5%BA%8F%E5%88%97%E6%9D%83%E5%80%BC%E4%B9%98%E7%A7%AF)

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
ll a[200005];
const ll mod = 1e9 + 7;
const ll powmod = 1e9 + 6;
inline ll ksm ( ll a, ll b, ll mod = 1e9 + 7 ) { ll res = 1; while ( b ) { if ( b & 1 ) res = res * a % mod; a = a * a % mod; b >>= 1; } return res; }
map<ll, ll> num;

int main () {
        ios::sync_with_stdio(false);
        ll n; cin >> n;
        for ( ll i = 0; i < n; i ++ ) {
                cin >> a[i];
                num[a[i]] ++;
        }
        sort ( a, a + n ); a[n] = 0x3f3f3f3f;
        ll res = 1;
        for ( ll i = 0; i < n; i ++ ) {
                ll les = lower_bound(a, a + n + 1, a[i]) - a;
                ll gre = n - (upper_bound(a, a + n + 1, a[i]) - a);
                res = res * ksm(a[i], ksm(2, les, powmod)) % mod; 
                res = res * ksm(a[i], ksm(2, gre, powmod)) % mod;
        }
        for ( auto i : num ) {
                res = res * ksm(
                                i.first % mod, 
                                (((ksm(2, i.second, powmod) - 1 - i.second) % powmod + powmod) % powmod) * ksm(2, lower_bound(a, a + n + 1, i.first) - a, powmod)
                        ) % mod;
                res = res * ksm(
                                i.first % mod,
                                (((ksm(2, i.second, powmod) - 1 - i.second) % powmod + powmod) % powmod) * ksm(2, n - (upper_bound(a, a + n + 1, i.first) - a), powmod)
                        ) % mod;       
        }
        cout << res << endl;
}
```
<hr>

### ÁâõÂÆ¢ÁªÉ‰π†Ëµõ80B_Âç∑ÁßØ

#### üîó
<a href="https://ac.nowcoder.com/acm/problem/218216"><img src="https://img-blog.csdnimg.cn/20210409231427628.png"></a>

#### üí°
Êó¢ÁÑ∂Ë¶ÅmexÔºåÈÇ£‰πàÔºö  
Âú®i=0Êó∂Ôºåa[1 ~ (n-1)]*b[1 ~ (n-1)]ÈÉΩÂèØË°å  
Âú®i=1Êó∂Ôºåa[0]*b[0 ~ (n-1)]‰∏éb[0]*a[0 ~ (n-1)]ÈÉΩÂèØË°å  
Âú®i=2Êó∂ÔºåÂè™Êúâa[1]*b[0]Âíåa[0]*b[1]ÂèØË°å  
‰ªéi=3ÂºÄÂßãÔºå‰ªª‰ΩïÊï∞ÈÉΩ‰∏çÊª°Ë∂≥ÔºåÊâÄ‰ª•ÈÉΩÊòØ0  
ËÄåÂØπ‰∫éÂå∫Èó¥ÂíåÊó∂Êàë‰ª¨Âè™ÈúÄËÆ∞ÂΩïÂâçÁºÄÂíåÂ∞±Ë°å‰∫ÜÔºåÁõ∏ÂáèÊó∂Ë¶ÅÂä†‰∏ä‰∏Ä‰∏™modÈò≤Ê≠¢ÁªìÊûú‰∏∫Ë¥ü  

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >

```cpp
const int maxn = 1e5 + 100;
const ll mod = 998244353;
ll a[maxn];
ll b[maxn];
ll sum_a[maxn] = {0};//aÁöÑÂâçÁºÄÂíå
ll sum_b[maxn] = {0};//bÁöÑÂâçÁºÄÂíå
ll n;
int main()
{
    scanf("%lld", &n);
    for (int i = 1; i <= n; i++)
        scanf("%lld", &a[i]), sum_a[i] = (sum_a[i - 1] + a[i]) % mod;
    for (int i = 1; i <= n; i++)
        scanf("%lld", &b[i]), sum_b[i] = (sum_b[i - 1] + b[i]) % mod;
    for (int i = 1; i <= n; i++)//ËøôÈáåËÆ°Êï∞ÈÉΩ+1ÔºåÊñπ‰æøÁªüËÆ°sum_a[0]‰∏ésum_b[0]
    {
        if (i == 1)
            printf("%lld", (sum_a[n] + mod - sum_a[1]) * (sum_b[n] + mod - sum_b[1]) % mod);
        else if (i == 2)
            printf("%lld",  (a[1] * (sum_b[n] + mod - sum_b[0]+mod-b[2]) % mod + b[1] * (sum_a[n] + mod - sum_a[0]+mod-a[2]) % mod +mod- /*ÂéªÈáç*/a[1] * b[1] % mod)%mod);
        else if (i == 3)
            printf("%lld", (a[1] * b[2] % mod + a[2] * b[1] % mod) % mod);
        else
            printf("%lld", 0ll);
        if (i != n)
            printf(" ");
    }
    return 0;
}
```

<hr>

### ÁâõÂÆ¢ÁªÉ‰π†Ëµõ98D_SonString

#### üîó
<a href="https://ac.nowcoder.com/acm/contest/11188/D">![20220501213543](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220501213543.png)</a>

#### üí°
Áî±‰∫éÊòØËøûÁª≠Êï∞ÂàóÁöÑÁìúÂàÜÔºåËÄÉËôë‰∏Ä‰∏ãÈöîÊùøÊ≥ï  
ÈÇ£‰πàÈúÄË¶ÅËÄÉËôëÁöÑÂ∞±ÊòØ‰∏§‰∏™Áõ∏ÈÇªÂ•áÊï∞ÁöÑÂÅ∂Êï∞‰πãÈó¥Ë¶ÅÂ≠òÂú®Â§öÂ∞ë‰∏™ÈöîÊùøÔºåÂêåÊó∂Áõ∏ÂØπÂ∫îÁöÑÊòØÂÆÉÂØπÁß∞ÁöÑ‰∏§‰∏™Â•áÊï∞‰πãÈó¥ÁöÑÂÅ∂Êï∞ÁöÑÈöîÊùøÊï∞Ë¶Å‰∏ÄÊ†∑  
Êàë‰ª¨Â≠ò‰∏Ä‰∏ãÂ•áÊï∞ÁöÑ‰ΩçÁΩÆ  
ÈÄöËøá‰∏§‰∏™Â•áÊï∞ÁöÑ‰ΩçÁΩÆÂèØ‰ª•Âø´ÈÄüÂæóÂà∞Ëøô‰∏§‰∏™Â•áÊï∞‰πãÈó¥ÊúâÂ§öÂ∞ë‰∏™ÂÅ∂Êï∞Ôºå‰∏éÂÖ∂ÂØπÁß∞ÁöÑÂ•áÊï∞‰ø°ÊÅØ  
Áî±‰∫éÂ≠òÂú®‰πòÊ≥ïÂéüÁêÜÁöÑËΩ¨ÁßªÂÖ≥Á≥ªÔºåÈÇ£‰πàÊàë‰ª¨‰ª§ $dp[i]$ Ë°®Á§∫ËΩ¨ÁßªÂà∞Á¨¨ $i$ ‰∏™Â•áÊï∞ÊúâÂ§öÂ∞ëÁßçÊñπÊ°àÊï∞  
Á¨¨ $i-1$ Âà∞Á¨¨ $i$ ‰∏™Â•áÊï∞‰πãÈó¥ËÆæÂ≠òÂú® $f1$ ‰∏™ÂÅ∂Êï∞ÔºåÂØπÁß∞Êúâ $f2$ ‰∏™ÂÅ∂Êï∞  
ÈÇ£‰πàÈô§‰∫ÜÁ¨¨‰∏Ä‰ΩçÊúâ $f1$ ÁßçÊèíÊ≥ï‰πãÂ§ñÔºåÂà´ÁöÑÈÉΩÊúâ $f1+1$ ÁßçÊèíÊ≥ï  
ÊâÄ‰ª•  
$dp[0]=\sum\limits_{j=0}^{min(f1,f2)}\binom{f1}{j}\binom{f2}{j}$   
$dp[i]=dp[i-1]\times\sum\limits_{j=0}^{min(f1,f2)+1}\binom{f1+1}{j}\binom{f2+1}{j}$  

Ê≥®ÊÑèÂ¶ÇÊûúÊúâÂÅ∂Êï∞‰∏™Â•áÊï∞ÁöÑÊÉÖÂÜµ‰∫ÜËØùÔºåÊàë‰ª¨‰∏≠Èó¥‰∏§‰∏™Â•áÊï∞‰πãÈó¥ÁöÑÂÅ∂Êï∞ÔºàËÆæÊúâ $num$ ‰∏™ÔºâÊòØÊ≤°ÊúâÁÆóËøáÁöÑÔºåËÄåËøô‰∫õÂÅ∂Êï∞ÂèØ‰ª•Èöè‰æøÊèíÊùøÔºå‰πüÂ∞±ÊòØ $dp[mid]\times2^{num}$  
ËÄå‰∏îÂ•áÊï∞‰∏™Êï∞ÊòØ $0$ ‰∏™‰πüË¶ÅÁâπÊÆäÂ§ÑÁêÜ‰∏Ä‰∏ãÔºåÂêåÁêÜ $2^{n-1}$  

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
const int mod = 998244353;


inline ll ksm (ll a, ll b) { ll res = 1; while (b > 0) { if (b & 1) res = res * a % mod; a = a * a % mod; b >>= 1; } return res; }
inline ll inv (ll x) { return ksm(x, mod - 2); }

int f[510], ivf[510];
inline ll C (int n, int m) {
        if (n < m) return 0;
        return 1ll * f[n] * ivf[n - m] % mod * ivf[m] % mod;
}

ll dp[510];
int main () {
        ios::sync_with_stdio(false);
        cin.tie(nullptr);

        string s; cin >> s;
        int n = s.size();

        f[0] = 1;
        for (int i = 1; i <= n; i ++) 
                f[i] = 1ll * f[i - 1] * i % mod;
        ivf[n] = inv(f[n]);
        for (int i = n - 1; i >= 0; i --) 
                ivf[i] = 1ll * ivf[i + 1] * (i + 1) % mod;
        
        vector<int> id1;
        for (int i = 1; i <= n; i ++) 
                if ((s[i - 1] - '0') % 2 == 1) 
                        id1.push_back(i);

        if (id1.size() == 0) {
                cout << ksm(2, n - 1) << endl;
                return 0;
        } 

        for (int i = 0; i < id1.size() / 2 + (id1.size() % 2); i ++) { // Êûö‰∏æ‰∏ÄÂçä
                if (i == 0) {
                        int f1 = id1[i] - 1;
                        int f2 = n - id1.back();
                        for (int j = 0; j <= min(f1, f2); j ++) {
                                dp[i] += C(f1, j) * C(f2, j) % mod;
                                dp[i] %= mod;
                        }
                } else {        
                        int f1 = id1[i] - id1[i - 1] - 1;
                        int f2 = id1[id1.size() - i] - id1[id1.size() - i - 1] - 1;
                        for (int j = 0; j <= min(f1, f2) + 1; j ++) {
                                dp[i] += dp[i - 1] * C(f1 + 1, j) % mod * C(f2 + 1, j) % mod;   
                                dp[i] %= mod;
                        }
                }
        } 

        if (id1.size() % 2 == 0) {
                int num = id1[id1.size() / 2] - id1[id1.size() / 2 - 1];
                cout << dp[id1.size() / 2 - 1] * ksm(2, num) % mod;
        } else {
                cout << dp[id1.size() / 2] << endl;
        }
}
```
<hr>

### ÁâõÂÆ¢ÁªÉ‰π†Ëµõ99D_Á§ºÁâ©

#### üîó
<a href="https://ac.nowcoder.com/acm/contest/34330/D">![20220528004722](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220528004722.png)</a>

#### üí°
Â¶ÇÊûúÁªôÂÆöÊ†πÊòØË∞ÅÔºåÈÇ£‰πà‰ºöÂæàÂ•ΩÁÆóÔºå‰∏Ä‰∏™ÁÇπË¢´ÂΩìÂÅö $LCA$ ÁöÑÊ¨°Êï∞‰∏∫
- ÊØè‰∏™Â≠êÊ†ëÊâÄÊúâÁÇπ‰∏éÂÖ∂‰ªñÂ≠êÊ†ëÁöÑÊâÄÊúâÁÇπ‰∫íÁõ∏ÈÖçÂØπÁöÑÊñπÊ°àÊï∞Ôºö$\sum\limits_{v\in son_u}sz_v\times(sz[u]-1-sz[v])$
- ÊØè‰∏™Â≠êÊ†ëÊâÄÊúâÁÇπ‰∏é $u$ ‰∫íÁõ∏ÈÖçÂØπÔºö$\sum\limits_{v\in son_u}sz[v]$  
  
‰ΩÜÈóÆÈ¢òÊòØÁé∞Âú®Ê≤°ÊúâÁªôÊ†π  
‰∏çËøáÊàë‰ª¨Â¶ÇÊûúÂõ∫ÂÆöÂá∫Êù•‰∫Ü‰∏Ä‰∏™Ê†π‰∫ÜÔºåÂ∞ÜÊ†π‰ªé $u$ Êé®Âà∞ÂÖ∂‰∏≠‰∏Ä‰∏™Â≠êËäÇÁÇπ $v$ ÂêéÁ≠îÊ°àÁöÑÂèòÂåñÊòØÂèØ‰ª•Âø´ÈÄüÊ±ÇÂæóÁöÑ  
Âç≥Â∞Ü $LCA$ ‰∏∫ $u$ ÁöÑÊç¢‰∏∫ $LCA$ ‰∏∫ $v$ ÁöÑÊÉÖÂÜµÔºåÈÇ£‰πàÂ∞±ÊòØ $v$ ÁöÑÂ≠êÊ†ëÊâÄÊúâÁÇπ‰∏éÈùû $v$ ÁöÑÂ≠êÊ†ëÁöÑÊâÄÊúâÁÇπÔºå $sz[v]\times (n-sz[v])$ ÔºåÂ∞Ü‰ªñ‰ª¨‰πòÁöÑÊùÉÂÄºÊîπ‰∏∫ $v$ Âç≥ÂèØ  
Ëøô‰∏™ÂèØ‰ª•ÈÄöËøáÊØèÊ¨°‰º†ÂÖ•‰∏Ä‰∏™‰ª•Áà∂ËäÇÁÇπ‰∏∫Ê†πÊó∂ÁöÑÂèÇÊï∞ÔºåÂ∞ÜÊ†π‰ªéÁà∂ËäÇÁÇπÊç¢‰∏∫Êú¨Ê¨°ÈÅçÂéÜËäÇÁÇπÔºåÂπ∂Áª¥Êä§ÊúÄÂ§ßÂÄº   

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
const int N = 1e6 + 10;
const int M = N * 2;
struct Edge {
        int nxt, to;
} edge[M];
int head[N], cnt;
inline void add_Edge (int from, int to) {
        edge[++cnt] = {head[from], to};
        head[from] = cnt;
}
int n;
int sz[N];
ll resv, resid;

int main () {
        ios::sync_with_stdio(false);
        cin.tie(nullptr);

        cin >> n;
        for (int i = 0; i < n - 1; i ++) {
                int u, v; cin >> u >> v;
                add_Edge(u, v);
                add_Edge(v, u);
        }

        function<ll(int, int)> dfs = [&](int u, int fa) ->ll {
                ll cur = 0;
                sz[u] = 1;
                for (int i = head[u]; i; i = edge[i].nxt) {
                        int v = edge[i].to;
                        if (v == fa) continue;
                        cur += dfs(v, u);
                        sz[u] += sz[v];
                }
                int sum = 0;
                for (int i = head[u]; i; i = edge[i].nxt) {
                        int v = edge[i].to;
                        if (v == fa) continue;
                        cur += 1ll * sz[v] * (sum + 1) * u;
                        sum += sz[v];
                }
                return cur;
        };

        function<void(int, int, ll)> find_Root = [&](int u, int fa, ll cur) ->void {
                if (fa != -1) { // Êç¢Ê†π
                        cur -= 1ll * sz[u] * (n - sz[u]) * fa;
                        cur += 1ll * sz[u] * (n - sz[u]) * u;
                        if (cur > resv) resid = u, resv = cur;
                } else resid = u, resv = cur;

                for (int i = head[u]; i; i = edge[i].nxt) {
                        int v = edge[i].to;
                        if (v == fa) continue;
                        find_Root(v, u, cur);
                }
        };

        find_Root(1, -1, dfs(1, -1));
        cout << resid << " " << resv * 2 + 1ll * n * (n + 1) / 2 << endl;
}
```
<hr>


### ÁâõÂÆ¢ÊåëÊàòËµõ58B_Ê∏ÖÊñ∞È¢ò

#### üîó
<a href="https://ac.nowcoder.com/acm/contest/11198/B">![20220403220303](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220403220303.png)</a>

#### üí°
È¶ñÂÖàËÄÉËôëÂ∑¶ $>$ Âè≥ÁöÑÊñπÊ°àÊï∞  
Âêå‰ΩçÊï∞‰∫åËøõÂà∂Â§ßÂ∞èÂèØ‰ª•Áúã‰ΩúÂ≠óÂÖ∏Â∫èÔºåÂç≥Â¶ÇÊûúÂõ†‰∏∫Á¨¨ $i$ ‰ΩçÂØºËá¥Â∑¶Â§ß‰∫éÂè≥ÔºåÂàôÔºö<b>ÂâçÁõ∏ÂêåÔºåËØ•‰ΩçÂ§ßÔºåÂêéÈöèÊÑè</b>   

È¶ñÂÖàÈ¢ÑÂ§ÑÁêÜÂá∫ $n$ ‰∏™Êï∞ÈÄâÂÅ∂Êï∞‰∏™‰∏∫ $chosev$ ÔºåÂ•áÊï∞‰∏™‰∏∫ $chosod$       

ÂâçÁõ∏ÂêåÔºö  
Â∑¶ $1$ Âè≥ $1$ ÔºöÂ∑¶ $n$ ‰∏™Êï∞Ëá≥Â∞ëÊúâ‰∏Ä‰∏™Ë¶ÅÈÄâ $1$ Âç≥ $2^n-1$ ÔºåÂè≥‰æß $n$ ‰∏™Êï∞ÈÄâÂ•áÊï∞‰∏™Âç≥ $chosod$   
Â∑¶ $0$ Âè≥‰æß $0$ ÔºåÂ∑¶‰æß‰∏çÈÄâ‰∏∫ $1$ ÔºåÂè≥‰æßÈÄâÂÅ∂Êï∞‰∏™Âç≥ $chosev$   
ÊØè‰∏Ä‰ΩçÂùáÊòØÂ¶ÇÊ≠§ÔºåÊâÄ‰ª•‰ª§ÊñπÊ°àÊï∞ $^{i-1}$    
  
ËØ•‰ΩçÂ§ßÔºö  
Â∑¶‰∏∫ $1$ ÔºåÂç≥ $2^n-1$ Âè≥‰∏∫ $0$ ÔºåÂç≥ $chosev$   

ÂêéÈöèÊÑèÔºö  
Âç≥ÊØè‰∏Ä‰ΩçÊòØ $2^n$ ÂÖ±Êúâ $m-i$ ‰Ωç‰∏∫ $(2^{2\times n})^{m-i}$   
  
ÊúÄÂêéË¶ÅÂä†‰∏äÊâÄÊúâÊï∞ÂùáÁõ∏Á≠âÁöÑÊÉÖÂÜµÔºåÂç≥ÂâçÁõ∏Âêå‰∏≠ÊØè‰∏Ä‰ΩçÊñπÊ°àÊï∞ $^m$ 

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
const int mod = 1e9 + 7;
inline ll ksm ( ll a, ll b ) { ll res = 1; while ( b ) { if ( b & 1 ) res = res * a % mod; a = a * a % mod; b >>= 1; } return res; }
inline ll inv ( ll x ) { return ksm(x, mod - 2); }
 
ll f[1000006];
inline void pre_F () {
        f[0] = 1;
        for ( int i = 1; i < 1000006; i ++ ) f[i] = f[i - 1] * i % mod;
}
inline ll C ( ll n, ll m ) {
        return f[n] * inv(f[m]) % mod * inv(f[n - m]) % mod;
}
 
int main () { pre_F();
        ll n, m; cin >> n >> m;
 
        ll chosod = 0, chosev = 0;
        for ( int i = 0; i <= n; i ++ ) {
                if ( i & 1 ) (chosod += C(n, i)) %= mod;
                else (chosev += C(n, i)) %= mod;
        }
 
        ll ksm2nsub1 = ((ksm(2, n) - 1) % mod + mod) % mod;
 
        ll res = ksm((ksm2nsub1 * chosod % mod + chosev) % mod, m);
        for ( int i = 1; i <= m; i ++ ) {       
                res += ksm((ksm2nsub1 * chosod % mod + chosev) % mod, i - 1) 
                       * ksm2nsub1 % mod * chosev % mod
                       * ksm(ksm(2, 2 * n), m - i) % mod;
                res %= mod;
        }
        cout << res << endl;
}
```
<hr>

### ÁâõÂÆ¢Â∞èÁôΩÊúàËµõ50D_ÁîüÊó•

#### üîó
<a href="https://ac.nowcoder.com/acm/contest/11227/D">![20220528234719](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220528234719.png)</a>

#### üí°
È¶ñÂÖàË¶ÅÊ≥®ÊÑèÂà∞ÁöÑÊòØÔºåÈÄâÁ¨¨ $i$ Â§©ËøáÁîüÊó•ÁöÑ‰∫∫Âè™ÂèØËÉΩÊúâ $i,2i,2i+1$ Ëøô‰∏â‰∏™  
ÈÇ£‰πà‰πüÂ∞±ÊòØËØ¥ÔºåÊàë‰ª¨ÂèØ‰ª•ÂØπÊØè‰∏ÄÂ§©Áª¥Êä§‰∏Ä‰∏™ÊùÉÂÄºÈõÜ  
Á¨¨ $i$ Â§©ÁöÑÊùÉÂÄºÂç≥‰∏∫ÂÆÉÁöÑÊùÉÂÄºÈõÜÁöÑÂºÇÊàñÂíå‰πò‰∏ä $2$ ÁöÑ‚ÄúÂà´ÁöÑ‰∏çÁ°ÆÂÆöÁöÑ‰∫∫Êï∞‚ÄùÊ¨°Êñπ
Â¶ÇÊûúËØ¥ÈáåÈù¢Êúâ‰∏§‰∏™‰∫∫‰ºöÈÄâÂÆÉÔºåÈÇ£‰πàÂ∞±ÊòØ $(a_i\oplus a_{2i})\times2^{n-2}$  
Â¶ÇÊûúÊúâ‰∏â‰∏™‰∫∫‰ºöÈÄâÂÆÉÔºåÈÇ£‰πàÂ∞±ÈúÄË¶ÅÂàÜÂºÄËÆ°ÁÆó‰∏Ä‰∏ãÊúâ‰∏§‰∏™‰∫∫ÈÄâÂíåÊúâ‰∏â‰∏™‰∫∫ÈÄâÁöÑÊÉÖÂÜµ‰∫Ü  
Âç≥ $((a_i\oplus a_{2i})+(a_i\oplus a_{2i+1})+(a_{2i}\oplus a_{2i+1}))\times 2^{n-2}$  
‰∏é $(a_i\oplus a_{2i}\oplus a_{2i+1})\times 2^{n-3}$     

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
const int mod = 1e9 + 7;
inline ll ksm (ll a, ll b) {
        ll res = 1;
        while (b) {
                if (b & 1) res = res * a % mod;
                a = a * a % mod;
                b >>= 1;
        }
        return res;
}
vector<ll> g[100005];

int main () {
        ios::sync_with_stdio(false);
        cin.tie(nullptr);

        int n; cin >> n;
        vector<int> a(n + 1); for (int i = 1; i <= n; i ++) cin >> a[i];

        for (int i = 1; i <= n; i ++) {
                g[i / 2].push_back(a[i]);
                g[i].push_back(a[i]);
        }

        ll res = 0;
        for (int i = 0; i <= n; i ++) {
                if (g[i].size() <= 1) continue;
                ll cur = 0;
                if (g[i].size() == 2) {
                        cur = (g[i][0] ^ g[i][1]) % mod * ksm(2, n - 2) % mod;
                } else {
                        cur += ((g[i][0] ^ g[i][1]) + (g[i][1] ^ g[i][2]) + (g[i][0] ^ g[i][2])) % mod * ksm(2, n - 3) % mod;
                        cur += (g[i][0] ^ g[i][1] ^ g[i][2]) % mod * ksm(2, n - 3) % mod;
                        cur %= mod;
                }
                res += cur;
                res %= mod;
        }
        cout << res << endl;

}
```
<hr>


### ABC202D_aabababaa

#### üîó
<a href="https://atcoder.jp/contests/abc202/tasks/abc202_d?lang=en"><img src="https://img-blog.csdnimg.cn/20210526235513656.png"></a>

#### üí°
ÊãøÂà∞ËøôÈÅìÈ¢ò  
ÂàöÂºÄÂßãÊàëÂÖ∂ÂÆûÊòØÊÉ≥ËΩ¨Âåñ‰∏∫‰∫åËøõÂà∂ÁúãÂèòÂåñÁöÑ  
Âõ†‰∏∫Â¶ÇÊûúÊää'a'ËßÜ‰Ωú1Ôºå'b'ËßÜ‰Ωú0ÔºåÊØèÊ¨°ÂêëÂêéÊé®‰∏Ä‰∏™Â≠óÂÖ∏Â∫èÂÖ∂ÂÆûÂ∞±ÊòØÂáèÂéª‰∏Ä‰∏™Êï∞  
‰ΩÜÊòØÊúâÂæàÂ§öÂ§ÑÁêÜÂú∞Êñπ‰∏çÁü•ÈÅìÊÄé‰πàÂäû  
ÊîæÂºÉ‰∫ÜÔºåËôΩÁÑ∂‰∏çÂØπÔºå‰ΩÜ‰∏çÂæó‰∏çËØ¥Á°ÆÂÆûÊòØ‰∏ÄÁßçÂ•ΩÁöÑÊÄùÁª¥ÊãìÂ±ïÊñπÂêë  
  
Ê≠£Ëß£Êù•‰∫ÜÔºö  
Êìç‰ΩúÊï∞ËøáÂ§ßÁöÑÊó∂ÂÄôÊàë‰ª¨ËÄÉËôëË∑≥Ê≠•  
ÂàÜÊûêÂ≠óÂÖ∏Â∫èÊÄßË¥®  
ÂèëÁé∞ÊØè‰∏™‰ΩçÁΩÆÈÉΩÊúâ‰∏§ÁßçÂ≠òÊîæÊñπÂºèÔºö  
Ë¶Å‰πàÂ≠òaË¶Å‰πàÂ≠òb  
ËøôÂèñÂÜ≥‰∫ékÁöÑÂâ©‰ΩôÂÄº  
  
  
Ëøô‰∏™‰ΩçÁΩÆÊîæaÊòØÂØπkÊ≤°ÊúâÂΩ±ÂìçÁöÑ  
Âõ†‰∏∫kÊòØÂØªÊâæÁ¨¨Âá†‰∏™Â≠óÂÖ∏Â∫èÊúÄÂ∞èÁöÑ  
  
ËÄåÊîæbÁöÑËØùÊàë‰ª¨Ë¶ÅÁü•ÈÅìÊàë‰ª¨Ë∑≥‰∫ÜÂá†Ê≠•‰πüÂ∞±ÊòØÂáè‰∫ÜÂ§öÂ∞ë‰∏™k  
Á°ÆÂÆöÊñπÂºèÊòØÂÅáËÆæËøôÈáåÊîæaÔºàÊØîÊîæbÂ∞è1ÔºâÊàë‰ª¨ÂêéÈù¢ËÉΩÊûÑÈÄ†Âá∫ÁöÑÂ≠óÁ¨¶‰∏≤Êï∞Èáè  
‰∏ÄÊÉ≥Ëøô‰∏çÊòØÁªÑÂêàÊï∞ÂêóÔºü  
Êàë‰ª¨ÊÉ≥Âú®Ââ©‰∏ãÁöÑÔºàa + b - 1Ôºâ‰∏™‰ΩçÁΩÆÈöèÊÑèÊîæÁΩÆÔºàa - 1Ôºâ‰∏™'a'  
ÊâÄ‰ª•Ë∑≥ÁöÑÊ≠•Êï∞ÊòØC(a + b - 1, a - 1)  
  
ÊµÅÁ®ãÔºö
Âú®k>1Êó∂ÔºàÂõ†‰∏∫Êàë‰ª¨Â≠óÂÖ∏Â∫è‰ªéÂ§¥ÂºÄÂßãÊâæÁöÑÔºåÊâÄ‰ª•Ë¶ÅÂ∞ëÁî®‰∏Ä‰∏™kÔºâÔºö  
	Â¶ÇÊûúk > C(a + b - 1, a - 1)ÔºåÈÇ£‰πàËøô‰∏ÄÊ≠•ÊòØÂèØ‰ª•Êîæ'b'Êù•Ë∑≥Ê≠•ÁöÑ  
	Âê¶ÂàôÔºå‰∏çËÉΩË∑≥Ê≠•ÔºåËÄÅËÄÅÂÆûÂÆûÊîæ'a'Âêß  
Âú®ÊúÄÂêéÔºåÊàë‰ª¨ÊûÑÈÄ†Âá∫ÂêéÈù¢Ê≤°ÊúâÊûÑÈÄ†ÁöÑÊúÄÂ∞èÂ≠óÁ¨¶‰∏≤ÔºöÂÖàÊîæÂÆåaÔºåÂÜçÊîæÂÆåb  

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >

```cpp
ll c[65][35];

inline void get_C(){//Êù®Ëæâ‰∏âËßíÊûÑÂª∫ÁªÑÂêàÊï∞
        for(int i = 0; i < 65; i ++) c[i][0] = 1;
        for(int i = 0; i < 65; i ++){
                for(int j = 1; j <= i && j < 35; j ++){
                        c[i][j] = c[i - 1][j] + c[i - 1][j - 1];
                }
        }
}


inline void solve(){get_C();
        _ll(a); _ll(b); _ll(k);
        string res;
        while(k > 1){
                if(k > c[b + a - 1][a - 1]){ k -= c[b + a - 1][a - 1]; //ÂèØ‰ª•Ë∑≥Ê≠•
                        b --; //Êîæ‰∫Ü'b'ÔºåbÁöÑÊï∞ÈáèÂ∞±Âáè1
                        res += "b";
                }else{
                        a --;//Êîæ‰∫Ü'a'ÔºåaÁöÑÊï∞ÈáèÂ∞±Âáè1
                        res += "a";
                }
        }
        for(int i = 0; i < a; i ++) res += "a";
        for(int i = 0; i < b; i ++) res += "b";
        cout << res << endl;
}

CHIVAS{
        solve();
        _REGAL;
}
```

<hr>

### AcWing2418_ÂÖâ‰πãÂ§ßÈôÜ

#### üîó
<a href="https://www.acwing.com/problem/content/2420/"><img src="https://img-blog.csdnimg.cn/d53ef6a1ffcd49de9de5d27840b41ec1.png"></a>

#### üí°
Êàë‰ª¨ÂÖàÂ∞ÜÈ¢òÊÑèÊäΩË±°Âá∫Êù•  
Áõ∏ÂΩì‰∫éÁªôÂÆön‰∏™ÁÇπÔºåÂàÜÊàê‰ªªÊÑèÂùóÔºåÊØèÂùóÈÉΩÊòØ‰∏™ÁéØÔºåËÆ©Ëøô‰∫õÁéØËøûÈÄö  
  
ÁéØ‰∏éÁéØÁöÑ‰πãÈó¥ËøûÈÄöÂèØ‰ª•pruferÁºñÁ†ÅÁöÑÊÄßË¥® ^(n-2)Áõ¥Êé•ÂæóÂà∞  
ÈóÆÈ¢òÂ∞±ÊòØÂàÜÊàêÂùóÁöÑÈóÆÈ¢ò  
ÂØπ‰∫éi‰∏™ÁÇπÔºåÊàë‰ª¨Ë¶ÅËÄÉËôëÊØè‰∏Ä‰∏™ÁÇπÁöÑÂΩíÂ±û  
Êàë‰ª¨ÂàÜÊàêjÂùóÔºåÊàë‰ª¨ËÄÉËôëk‰∏™ÁÇπÁöÑÂΩíÂ±û  
ÈÇ£‰πàÊàë‰ª¨Ë¶ÅÈÄíÊé®i-1‰∏™ÁÇπ‰∏≠ÈÄâk-1‰∏™ÁÇπÔºö dp[i][j] = (dp[i][j] + dp[i - k][j - 1] * c[i - 1][k - 1]  
Âõ†‰∏∫ÊØè‰∏ÄÂùóÂèØ‰ª•ÊóãËΩ¨ÁéØÔºåÊâÄ‰ª•Ë¶Å‰πòÈò∂‰πò  
  
ÊúÄÂêéÁªüËÆ°‰∏Ä‰∏ãÂàÜÊàê1ÔΩûnÂùóÁöÑÊñπÊ°àÊï∞  

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >

```cpp
const int N = 210;
ll g[N];
ll dp[N][N];
ll c[N][N];
ll n, mod;

inline void Pre () {
        for ( int i = 0; i < N; i ++ ) {
                for ( int j = 0; j <= i; j ++ ) {
                        if ( j == 0 ) c[i][j] = 1;
                        else          c[i][j] = (c[i - 1][j] + c[i - 1][j - 1]) % mod;
                } 
        }
        g[1] = 1, g[3] = 3;                                                                                                                     
        for ( int i = 4; i < N; i ++ ) g[i] = g[i - 1] * i % mod;
}

int main () {
        cin >> n >> mod; Pre();
        dp[0][0] = 1;
        for ( int i = 1; i <= n; i ++ ) { // ÊÄªÂÖ±i‰∏™ÁÇπ
                for ( int j = 1; j <= i; j ++ ) { // ÂàÜÊàêjÂùó
                        for ( int k = 1; k <= i - j + 1; k ++ ) { // Ë¶ÅÊûö‰∏æk‰∏™ÁúãÁúãÊÄé‰πàÂàÜÈÖç
                                dp[i][j] = (dp[i][j] + dp[i - k][j - 1] * c[i - 1][k - 1] * g[k] % mod) % mod;
                        }
                }
        }
        ll res = g[n - 1], p = 1; // p: pruferÂÆöÁêÜÂêéÈù¢Ë¶Å‰πòÁöÑÊï∞
        for ( int k = 2; k <= n; k ++ ) {
                res = ( res + dp[n][k] * p % mod ) % mod;
                p = p * n % mod;
        }
        cout << res << endl;
}
```

<hr>

### ARC117C_TricolorPyramid

#### üîó
<a href="https://atcoder.jp/contests/arc117/tasks/arc117_c?lang=en">![20220906152734](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220906152734.png)</a>

#### üí°
Â∞±‰∏âÁßçÈ¢úËâ≤Êù•ÂõûÂèòÔºåÂ∞ÜÂÖ∂ËΩ¨Êç¢Êàê $(0,1,2)(mod\;3)$  
‰∏Ä‰∏™È¢úËâ≤‰∏éÂÖ∂‰∏ãÈù¢‰∏§‰∏™ÊúâÂÖ≥Á≥ªÔºåÂ∞ÜÂÖ≥Á≥ªÂõæÁîªÂá∫Êù•  
<table>
  <tr>
    <th>&nbsp;</th><th>0</th><th>1</th><th>2</th>
  </tr>
  <tr>
    <th>0</th><td>0</td><td>2</td><td>1</td>
  </tr>
  <tr>
    <th>1</th><td>2</td><td>1</td><td>0</td>
  </tr>
  <tr>
    <th>2</th><td>1</td><td>0</td><td>2</td>
  </tr>
</table>  

ÂèëÁé∞ÂíåÁõ∏ÂêåÁöÑ‰∏§ÂØπÔºåÂÖ∂ÂÄº‰πüÁõ∏ÂêåÔºåÂÖ∂ÂíåÁöÑË¥üÂÄº‰∏éÊúÄÁªàÂÄºÂ∑Æ $3$ Ôºå‰πüÂèØ‰ª•ÁúãÂÅöÊòØ $target\equiv -(x+y)(mod\;3)$  
‰ª§ÊúÄÂêé‰∏ÄË°å‰∏∫ $a,b,c,d,e$  
Êé®‰∏äÂéª‰∏∫  
$
a+4b+6c+4d+e\\
-a-3b-3c-d\quad -b-3c-3d-e\\
a+2b+c\quad b+2c+d\quad c+2d+e\\
-a-b\quad -b-c\quad -c-d\quad -d-e\\
a\quad b\quad c\quad d\quad e
$  
Â¶ÇÊûú‰ª§Â≠óÁ¨¶ $c$ ÁöÑÊùÉÂÄº‰∏∫ $w_c$ ÔºåÊùÉÂÄº‰∏∫ $v$ ÁöÑÂ≠óÁ¨¶‰∏∫ $c_v$   
ÂæóÂà∞Á¨¨‰∏ÄË°å‰∏∫ $c[(-1)^{n-1}\sum\limits_{i=0}^{n-1}\binom{n-1}{i}w[s_i]]$  
  
‰∏çËøáÁî±‰∫éÊ®°Êï∞ÂæàÂ∞èÔºå‰∏çËÉΩÁõ¥Êé•Èò∂‰πòÊ±ÇÁªÑÂêàÊï∞Ôºå‰∏çÁÑ∂ÂæàÂÆπÊòìÂá∫Áé∞Êó†ÈÄÜÂÖÉÊó†Ê≥ïÈô§ÁöÑÊÉÖÂÜµ  
‰ΩÜÁî±‰∫éÊ®°Êï∞ÂæàÂ∞èÔºåÂèØ‰ª•Áî® $Lucas$ Âø´ÈÄüÊ±ÇËß£Ôºå‰∏îÊ±ÇÂçï‰∏™ÁªÑÂêàÊï∞ÁöÑËøáÁ®ã‰∏≠‰∏çÁî®ÂèñÊ®°  

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
inline int Comb (int a, int b, int mod) {
    if (a < b) return 0;
    if (a == b) return 1;
    if (b > a - b) b = a - b;
    int res = 1;
    for (int i = 0; i < b; i ++) res = res * (a - i);
    for (int i = 0; i < b; i ++) res = res / (b - i);
    return res % mod;
}
inline int Lucas (int n, int m, int mod) {
    int res = 1;
    while (n && m && res) {
        res = 1ll * res * Comb(n % mod, m % mod, mod) % mod;
        n /= mod;
        m /= mod;
    }
    return res;
}


int n;
string s;

int main () {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);

    cin >> n >> s;

    int res = 0;
    for (int i = 0; i < n; i ++) {
        res += (s[i] == 'B' ? 0 : (s[i] == 'W' ? 1 : 2)) * Lucas(n - 1, i, 3) % 3;
        res %= 3;
    }
    if (n % 2 == 0) res = (-res + 3) % 3;
    cout << (res == 0 ? 'B' : (res == 1 ? 'W' : 'R')) << endl;
}
```
<hr>


### ARC134C_TheMajority

#### üîó
<a href="https://atcoder.jp/contests/arc134/tasks/arc134_c?lang=en"><img src="https://img-blog.csdnimg.cn/14f2ddf24f6949238483657ed344b023.png"></a>

#### üí°  
ÂèØ‰ª•ËøôÊ†∑ÊÉ≥ÔºåË¶ÅÊÉ≥Êï∞Â≠óÊòØ $1$ ÁöÑÁêÉ‰∏™Êï∞‰∏•Ê†ºÂ§ß‰∫éÂà´ÁöÑÊï∞Â≠óÁöÑÁêÉ‰∏™Êï∞  
Êàë‰ª¨ÂèØ‰ª•ÂÖàÁªôÊØè‰∏Ä‰∏™ÁõíÂ≠êÈÉΩÈì∫‰∏äÊï∞Â≠óÊòØ $1$ ÁöÑÁêÉÔºåÁÑ∂ÂêéÊØèÂæÄ‰∏Ä‰∏™ÁõíÂ≠êÈáåÈù¢Êîæ‰∏Ä‰∏™ $1$ Â∞±Ë∑üÁùÄÊîæ‰∏Ä‰∏™Âà´ÁöÑ  
  
ÈÇ£‰πàÊàë‰ª¨ÂèØ‰ª•Â∞ÜËøô‰∫õÁêÉÂàÜÊàê‰∏§Á±ªÁâ©ÂìÅ  
Êï∞Â≠ó‰∏çÊòØ $1$ ÁöÑÁêÉÂíåÊï∞Â≠óÊòØ $1$ ÁöÑÁêÉ‰∏§‰∏§ÈÖçÂØπÂΩ¢ÊàêÁâ©ÂìÅ $a$ ÔºåÊúâ $\alpha$ ‰∏™  
Ââ©‰ΩôÁöÑÊï∞Â≠óÊòØ $1$ ÁöÑÁêÉÊØè‰∏™ÈÉΩÊòØÁâ©ÂìÅ $b$ ÔºåÊúâ $\beta$ ‰∏™   
  
Êàë‰ª¨Ë¶ÅÂÖàÁªôÊØè‰∏™ÁõíÂ≠êÈÉΩÈì∫‰∏äÁâ©ÂìÅ $b$ Ôºå‰∏çËÉΩÊúâÁ©∫ÁõíÂ≠ê  
ÂØπ‰∫é [ÁêÉÁõíÊ®°ÂûãÊÉÖÂÜµÂõõ](https://tech.chivas-regal.top/blogs/algorithm/math/ballandbox.html#%E8%AF%81%E6%98%8E%E5%9B%9B)ÔºåÊñπÊ°àÊï∞‰∏∫ $\begin{pmatrix}\alpha-1\\\beta-1\end{pmatrix}$  
‰πãÂêéÂØπ‰∫éÁâ©ÂìÅ $b$ ÔºåÊ≥®ÊÑèÂêåÊï∞Â≠óÁöÑÁêÉ‰πãÈó¥ÊòØÁõ∏ÂêåÁöÑÔºåËÄå‰∏çÂêåÊï∞Â≠óÁöÑÁêÉÊòØ‰∏çÂêåÁöÑÔºåÊîæÁΩÆÁöÑÊó∂ÂÄôÁõíÂèØÁ©∫  
ÈÇ£‰πàÊàë‰ª¨Ë¶ÅÂØπ‰∫éÊØè‰∏Ä‰∏™ $i$ Âíå $1$ ÊãºÊé•Áâ©ÂìÅÁöÑÊï∞Èáè $a_i$ ËÆ°ÁÆó‰∏ÄÊ¨° [ÁêÉÁõíÊ®°ÂûãÊÉÖÂÜµ‰∏â](https://tech.chivas-regal.top/blogs/algorithm/math/ballandbox.html#%E8%AF%81%E6%98%8E%E4%B8%89)ÔºåÊñπÊ°àÊï∞‰∏∫ $\prod\limits_{i=2}^n\begin{pmatrix}a_i+m-1\\m-1\end{pmatrix}$  
  
ÊïÖÁ≠îÊ°à‰∏∫  
$$\begin{pmatrix}\alpha-1\\\beta-1\end{pmatrix}\prod\limits_{i=2}^n\begin{pmatrix}a_i+m-1\\m-1\end{pmatrix}$$  


Âè¶Â§ñÔºåÂØπ‰∫é $m$ ÊØîËæÉÂ∞è‰ΩÜÊòØ $n$ ÊØîËæÉÂ§ßÁöÑÁªÑÂêàÊï∞ÔºåÊàë‰ª¨ÂèØ‰ª•Áî®ÂàÜÂ≠êÂàÜÊØçÁ∫¶ÂàÜ‰πãÂêéÁöÑÊñπÂºèËøõË°åËÆ°ÁÆó  

```cpp
inline ll C ( ll n, ll m ) {
        ll res = 1;
        for ( ll i = 0; i < m; i ++ ) res = res * (n - i) % mod;
        return res * inv[m] % mod;
}
```

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
const int N = 1e5 + 10;
const int K = 210;
const int mod = 998244353;

ll inv[N];

inline ll Ksm ( ll a, ll b ) { ll res = 1; while ( b ) { if ( b & 1 ) res = res * a % mod; a = a * a % mod; b >>= 1; } return res; }
inline ll Inv ( ll x ) { return Ksm(x, mod - 2); }
inline void get_I () {
        inv[0] = Inv(1);
        for ( int i = 1; i < K; i ++ ) 
                inv[i] = inv[i - 1] * Inv(i) % mod;
}
inline ll C ( ll n, ll m ) {
        ll res = 1;
        for ( ll i = 0; i < m; i ++ ) res = res * (n - i) % mod;
        return res * inv[m] % mod;
}

ll n, k;
ll a[N];
ll one, els; // Êï∞Â≠ó1ÁöÑ‰∏™Êï∞ÔºåÂà´ÁöÑÊï∞Â≠óÁöÑ‰∏™Êï∞
ll res;
int main () {
        get_I();
        ios::sync_with_stdio(false);

        cin >> n >> k;
        for ( int i = 1; i <= n; i ++ ) {
                cin >> a[i];
                if ( i == 1 ) one += a[i];
                else els += a[i];
        }
        if ( one - els < k ) {
                cout << 0 << endl;
                return 0;
        }

        res = C(one - els - 1, k - 1);
        for ( int i = 2; i <= n; i ++ ) res = res * C(a[i] + k - 1, k - 1) % mod;
        cout << res << endl;
}
```
<hr>

### ARC136B_TripleShift

#### üîó
<a href="https://atcoder.jp/contests/arc136/tasks/arc136_b?lang=en">![20220303014137](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220303014137.png)</a>

#### üí°
ËÄÉËôëËøõË°å‰∏ÄÊ¨°Êìç‰Ωú‰ºö‰∫ßÁîü‰ªÄ‰πàÂΩ±Âìç  
‰∏â‰∏™‰∏çÂêåÁöÑÊï∞Êï∞ÂæÄÂêéËΩ¨‰∏ÄÊ¨°  
ÈÄÜÂ∫èÂØπ $\pm2$  
‰∏â‰∏™Êï∞Â≠òÂú®‰∏§‰∏™Áõ∏ÂêåÁöÑ  
ÈÄÜÂ∫èÂØπÊîπÂèòÂèØ‰ª•ÂåÖÊèΩÊâÄÊúâÁöÑ  
  
ÈÇ£‰πàËÄÉËôë‰∏§‰∏™Êï∞ÁªÑÁöÑÈÄÜÂ∫èÂØπÂ•áÂÅ∂Âç≥ÂèØ  
ÂêåÂ•áÂÅ∂ÊÄßÂøÖÁÑ∂ÂèØ‰ª•  
‰∏çÂêåÂ•áÂÅ∂ÊÄßËã•Â≠òÂú®Áõ∏ÂêåÁöÑÊï∞‰πüÂèØ‰ª•  
Âê¶Âàô‰∏çË°å  

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
int n;
int a[5010], b[5010];
int numa[5010];
int mxnum = 0;
 
int main () {
        ios::sync_with_stdio(false);
 
        cin >> n;
        for ( int i = 1; i <= n; i ++ ) cin >> a[i], numa[a[i]] ++, mxnum = max(mxnum, numa[a[i]]);
        for ( int i = 1; i <= n; i ++ ) {
                cin >> b[i];
                if ( numa[b[i]] == 0 ) {
                        cout << "No" << endl;
                        return 0;
                }
                numa[b[i]] --;
        }
        int reva = 0;
        for ( int i = 1; i <= n; i ++ ) {
                for ( int j = 1; j < i; j ++ ) {
                        reva += a[j] > a[i];
                }
        }
        int revb = 0;
        for ( int i = 1; i <= n; i ++ ) {
                for ( int j = 1; j < i; j ++ ) {
                        revb += b[j] > b[i];
                }
        }
        if ( reva % 2 == revb % 2 || mxnum >= 2 ) {
                cout << "Yes" << endl;
        } else {
                cout << "No" << endl;
        }
}
```
<hr>

### ICPC2019Âçó‰∫¨B_ChessBoard

#### üîó
<a href="https://codeforces.com/gym/103466/problem/B">![20221008151222](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20221008151222.png)</a>

#### üí°
Á¨¨‰∫åÂº†ÂõæÁöÑËØ¥ÊúçÊÄßÂæàÂº∫ÔºåÂ∞±ÊòØÊàë‰ª¨ÊØèÊ¨°‰∏çËÉΩÂú®Â∑≤ÊúâÁü©Èòµ $a*b(a\le 2,b\le 2)$ ÁöÑÂâçÊèê‰∏ãÔºåÂæÄ‰∏Ä‰∏™ÊñπÂêëÂºÄ‰∏§Ê≠•Ôºå‰∏çÁÑ∂‰ºöÂá∫Áé∞ÂêåË°åÂêåÂàóË¶ÅÂæÄÂõûÊî∂Âá∫Áé∞Á©∫ËæπÁöÑÊÉÖÂÜµÔºàÂàÜÊûêÁ¨¨‰∫å‰∏™ÂõæÔºâ    
ÂºÄ‰∏ÄÊ≠•ÁöÑËØùÂèØ‰ª•ÈÄâÂõõ‰∏™ËßíÔºåÈÄâ‰∏Ä‰∏™ÊñπÂêëÂºÄÔºåÊú¨Ë∫´Êúâ $n-1+m-1$ ÁßçÂºÄÊ≥ïÔºåË∞É $n-1$ ‰∏™‰ΩçÁΩÆÂºÄË°åÔºåÊïÖÁ≠îÊ°à‰∏∫ $4\times \binom{n+m-2}{n-1}$  
ÁâπÂà§ $m=1$ Âíå $n=1$  

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
inline void Solve () {
    int n, m; cin >> n >> m;
    if (n == 1) {
        cout << 1 + (m != 1) << endl;
    } else if (m == 1) {
        cout << 1 + (n != 1) << endl;
    } else {
        cout << 4ll * C(n + m - 2, n - 1) % mod << endl;
    }
}
```
<hr>


### CodeForces340C_TouristProblem

#### üîó
<a href="https://codeforces.com/contest/340/problem/C">![20220705163744](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220705163744.png)</a>

#### üí°
Ëøô‰∏™ÊòØÁúãÊØè‰∏ÄÂØπÁöÑË¥°ÁåÆ  
È¶ñÂÖàÊØè‰∏Ä‰∏™Êï∞Âíå $0$ ÁöÑÂ∑ÆÂá∫Áé∞ÁöÑÊ¨°Êï∞‰∏∫ÂêéÈù¢Âà´ÁöÑÊï∞ÁöÑÂÖ®ÊéíÂàóÔºåÂç≥ $(n-1)!$  
ÂÖ∂Ê¨°ÊØè‰∏§‰∏™Êï∞ÁöÑÂ∑ÆÂá∫Áé∞ÁöÑÊ¨°Êï∞‰æùÁÑ∂ÊòØ $(n-1)!$ÔºåÂèØ‰ª•Âè™ÁúãÂÅöÂ§ßÂáèÂ∞èÔºåÁÑ∂ÂêéÂá∫Áé∞ÁöÑÊ¨°Êï∞‰πò $2$   
Âú®ÂØπ $[a]$ ÊéíÂ∫èÂêé  
ÂàÜÂ≠ê‰∏∫ $(\sum\limits_{i=1}^na_i(n-1)!)+(2\sum\limits_{i=1}^n\sum\limits_{j=i+1}^n(a_j-a_i)(n-1)!)$  
ÂàÜÊØç‰∏∫ $n!$  
ÂàùÊ≠•ÂåñÁÆÄÂêéÔºö  
ÂàÜÂ≠ê‰∏∫ $(\sum\limits_{i=1}^na_i)+(2\sum\limits_{i=1}^n\sum\limits_{j=i+1}^n(a_j-a_i))$  
ÂàÜÊØç‰∏∫ $n$   
ÂêéÈù¢ÈÇ£‰∏™‰∏§ÈáçÂæ™ÁéØÂèØ‰ª•Áõ¥Êé•Áî®ÂâçÁºÄÂíåÂåñÁÆÄÔºåÂç≥ $\sum\limits_{i=1}^n(a_i\times(i-1)-pre\_sum)$ 

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
inline ll gcd (ll a, ll b) {
        return b ? gcd(b, a % b) : a;
}
 
int main () {
        ios::sync_with_stdio(false);
        cin.tie(nullptr);
 
        int n; cin >> n;
        vector<ll> a(n); for (ll &i : a) cin >> i;
        sort(a.begin(), a.end());
 
        ll up = 0, down = n;
        ll pre_sum = 0;
        for (int i = 0; i < n; i ++) {
                up += (a[i] * i - pre_sum) * 2;
                up += a[i];
                pre_sum += a[i];
        }
        ll d = gcd(up, down);
        up /= d;
        down /= d;
        cout << up << " " << down << endl;
}
```
<hr>

### CodeForces1609E_IntercityTravelling

#### üîó
<a href="https://codeforces.com/contest/1009/problem/E">![20220705220024](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220705220024.png)</a>

#### üí°  
ÂØπ‰∫éÊØè‰∏ÄÊÆµ‰Ωú‰∏∫ÊØè‰∏Ä‰∏™Áñ≤Âä≥ÂÄºÔºåÁî®ÊéíÂàóÁªÑÂêàÊ±Ç‰∏Ä‰∏™Ë¥°ÁåÆÊ¨°Êï∞  
  
Á†îÁ©∂Á¨¨‰∫å‰∏™Ê†∑‰æã  
<b>Á¨¨‰∏ÄÊÆµÔºö</b>  
‰Ωú‰∏∫ $a_1$ Ôºö  
Ë¥°ÁåÆÊ¨°Êï∞‰∏∫ÂêéÈù¢ÁöÑÊñ≠ÁÇπÊï∞‰ªªÈÄâÂç≥ $2^3$  
<b>Á¨¨‰∫åÊÆµÔºö</b>  
‰Ωú‰∏∫ $a_1$ Ôºö  
Ë¥°ÁåÆÊ¨°Êï∞‰∏∫Âç†‰∫ÜÂâçÈù¢‰∏Ä‰∏™Êñ≠ÁÇπÂêéÂâçÈù¢ÁöÑÂâ©‰ΩôÊñ≠ÁÇπÊï∞‰ªªÈÄâÂç≥ $2^0$ Ôºå‰πò‰∏äÂêéÈù¢ÁöÑÊñ≠ÁÇπÊï∞‰ªªÈÄâÂç≥ $2^2$  
‰Ωú‰∏∫ $a_2$ Ôºö  
Ë¥°ÁåÆÊ¨°Êï∞‰∏∫ÂêéÈù¢ÁöÑÊñ≠ÁÇπÊï∞‰ªªÈÄâÂç≥ $2^2$    
<b>Á¨¨‰∏âÊÆµÔºö</b>  
‰Ωú‰∏∫ $a_1$ Ôºö  
Ë¥°ÁåÆÊ¨°Êï∞‰∏∫Âç†‰∫ÜÂâçÈù¢‰∏Ä‰∏™Êñ≠ÁÇπÂêéÂâçÈù¢ÁöÑÂâ©‰ΩôÊñ≠ÁÇπÊï∞‰ªªÈÄâÂç≥ $2^1$ Ôºå‰πò‰∏äÂêéÈù¢ÁöÑÊñ≠ÁÇπÊï∞‰ªªÈÄâÂç≥ $2^1$  
‰Ωú‰∏∫ $a_2$ Ôºö  
Ë¥°ÁåÆÊ¨°Êï∞‰∏∫Âç†‰∫ÜÂâçÈù¢‰∏Ä‰∏™Êñ≠ÁÇπÂêéÂâçÈù¢ÁöÑÂâ©‰ΩôÊñ≠ÁÇπÊï∞‰ªªÈÄâÂç≥ $2^0$ Ôºå‰πò‰∏äÂêéÈù¢ÁöÑÊñ≠ÁÇπÊï∞‰ªªÈÄâÂç≥ $2^1$  
‰Ωú‰∏∫ $a_3$ Ôºö  
Ë¥°ÁåÆÊ¨°Êï∞‰∏∫ÂêéÈù¢ÁöÑÊñ≠ÁÇπÊï∞‰ªªÈÄâÂç≥ $2^1$  
<b>Á¨¨ÂõõÊÆµÔºö</b>  
‰Ωú‰∏∫ $a_1$ Ôºö  
Ë¥°ÁåÆÊ¨°Êï∞‰∏∫Âç†‰∫ÜÂâçÈù¢‰∏Ä‰∏™Êñ≠ÁÇπÂêéÂâçÈù¢ÁöÑÂâ©‰ΩôÊñ≠ÁÇπÊï∞‰ªªÈÄâÂç≥ $2^2$ Ôºå‰πò‰∏äÂêéÈù¢ÁöÑÊñ≠ÁÇπÊï∞‰ªªÈÄâÂç≥ $2^0$  
‰Ωú‰∏∫ $a_2$ Ôºö  
Ë¥°ÁåÆÊ¨°Êï∞‰∏∫Âç†‰∫ÜÂâçÈù¢‰∏Ä‰∏™Êñ≠ÁÇπÂêéÂâçÈù¢ÁöÑÂâ©‰ΩôÊñ≠ÁÇπÊï∞‰ªªÈÄâÂç≥ $2^1$ Ôºå‰πò‰∏äÂêéÈù¢ÁöÑÊñ≠ÁÇπÊï∞‰ªªÈÄâÂç≥ $2^0$  
‰Ωú‰∏∫ $a_3$ Ôºö  
Ë¥°ÁåÆÊ¨°Êï∞‰∏∫Âç†‰∫ÜÂâçÈù¢‰∏Ä‰∏™Êñ≠ÁÇπÂêéÂâçÈù¢ÁöÑÂâ©‰ΩôÊñ≠ÁÇπÊï∞‰ªªÈÄâÂç≥ $2^0$ Ôºå‰πò‰∏äÂêéÈù¢ÁöÑÊñ≠ÁÇπÊï∞‰ªªÈÄâÂç≥ $2^0$  
‰Ωú‰∏∫ $a_1$ Ôºö  
Ë¥°ÁåÆÊ¨°Êï∞‰∏∫ÂêéÈù¢ÁöÑÊñ≠ÁÇπÊï∞‰ªªÈÄâÂç≥ $2^0$    
  
ÂàíÂàÜ‰∏ãÊù•Âç≥Ôºö  
$(2^3+3\times 2^2)a_1+\\(2^2+2\times 2^1)a_2+\\(2^1+1\times2^0)a_3+\\(2^0)a_4$  
ÊØè‰∏Ä‰∏™ $a_i$ ÊúÄÂâçÈù¢ÁöÑÊòØÁ¨¨ $i$ ÊÆµ‰ΩøÁî®ÂÆÉÁöÑË¥°ÁåÆÊ¨°Êï∞ÔºåÂêéÈù¢Êúâ $n-i$ ‰∏™Êñ≠ÁÇπÔºåÊâÄ‰ª•ÊòØ $2^{n-i}Ê¨°$ „ÄÇËÄåÂêéÈù¢ÁöÑÂàôÊòØÁ¨¨ $i$ ÊÆµ‰πãÂêéÁöÑ $(n-i)$ ‰∏™ÊÆµ‰ΩøÁî®ÂÆÉÔºåÊåáÊï∞ÊòØ‰∫íË°•ÁöÑÔºàÂ∑¶Âä†Âè≥ÂáèÔºâÔºåÂç≥ $2^{n-i-1}Ê¨°$  
ÂàôÁ≠îÊ°à‰∏∫ $\sum\limits_{i=1}^n2^{n-i}+(n-i)2^{n-i-1}$   

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
const int mod = 998244353;
inline ll ksm (ll a, ll b) { if (b < 0) return 0; ll res = 1; while (b) { if (b & 1) res = res * a % mod; a = a * a % mod; b >>= 1; } return res; }
inline ll inv (ll x) { return ksm(x, mod - 2); }
 
int main () {
        ios::sync_with_stdio(false);
        cin.tie(nullptr);
 
        int n; cin >> n;
        vector<ll> a(n + 1); for (int i = 1; i <= n; i ++) cin >> a[i];
 
        ll res = 0;
        for (int i = 1; i <= n; i ++) {
                res += (ksm(2, n - i) + (n - i) * ksm(2, n - i - 1) % mod) % mod * a[i] % mod;
                res %= mod;
        }
        cout << res << endl;
}
```
<hr>


### CodeForces1371E1_AsterismÔºàEasy VersionÔºâ

#### üîó
<a href="https://codeforces.com/contest/1371/problem/E1">![20220705210527](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220705210527.png)</a>

#### üí°
‰∏Ä‰∏™ÊéíÂàóÊï∞ÈóÆÈ¢ò  
Ê≥®ÊÑèÂà∞ÂØπ‰∫é $f(x)$ Ôºå‰ªé $0\to n-1$ ÁöÑ‰ΩçÁΩÆÊâãÈáåÁöÑÁ≥ñÊï∞ÊòØ $x\to x+n-1$   
ÂàôÊØè‰∏Ä‰∏™‰ΩçÁΩÆÂ∫îÈÉΩÊúâ‰∏Ä‰∫õÊÄ™ÂÖΩÂèØ‰ª•ÊîæÁΩÆÔºå‰∏îÊòØÂçáÂ∫èÁöÑÔºåÂπ∂‰∏îËÉΩÊîæÂú® $x$ ‰ΩçÁΩÆ‰∏äÁöÑÊÄ™ÂÖΩÔºå‰πü‰∏ÄÂÆöËÉΩÊîæÂú® $x+10$ ÁöÑ‰ΩçÁΩÆ‰∏äÔºåËøôÊòØ‰∏Ä‰∏™ÂåÖÂê´ÁöÑ   
Áé∞Âú®Â∞±ÊòØÁúãÂ¶ÇÊûúÊúâ $i$ È¢óÁ≥ñÔºåÂèØ‰ª•Â∫î‰ªòÂá†Âè™ÊÄ™ÂÖΩÔºåÁî±Ê≠§È¢ÑÂ§ÑÁêÜÂá∫Êù• $[b]$   
Êàë‰ª¨Âú®Ê±Ç $f(x)$ Êó∂ÔºåÂØπ‰∫éÊúâ $i$ È¢óÁ≥ñÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨ËøôÈáåÂèØ‰ª•Êîæ $b_i$ ‰∏™ÊÄ™ÂÖΩÔºå‰ΩÜÊòØ‰πãÂâçËøá‰∫Ü $i-x$ ‰∏™ÊÄ™ÂÖΩ‰∫ÜÔºåÊâÄ‰ª•Ë¶ÅÂáèÂéª„ÄÇËÆ©Ëøô‰∫õËøõË°åÁ¥Ø‰πòÂç≥ÂèØÔºåÂÖ¨ÂºèË°®Á§∫‰∏∫Ôºö  
$$f(x)=\prod\limits_{i=x}^{x+n-1}b_i-(i-x)$$  
Âú®ËøôÈáåÈù¢Âà§Êñ≠ÊòØÂê¶Â≠òÂú® $b_i-(i-x)\equiv 0(mod\;p)$ Âç≥ÂèØ   

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
const int N = 4100;
int n, p;
int a[N], b[N];

int main () {
        ios::sync_with_stdio(false);
        cin.tie(nullptr);

        cin >> n >> p;
        for (int i = 0; i < n; i ++) cin >> a[i];
        
        sort(a, a + n);
        for (int i = max(0, a[n - 1] - n + 1); i <= a[n - 1] + n - 1; i ++) b[i] = upper_bound(a, a + n, i) - a;
        vector<int> res;
        for (int x = max(0, a[n - 1] - n + 1); x <= a[n - 1]; x ++) {
                for (int i = x; i <= x + n - 1; i ++) {
                        if ((b[i] - (i - x)) % p == 0) goto end;
                }
                res.push_back(x);
                end:;
        }

        cout << res.size() << endl;
        for (int i : res) cout << i << " ";
}
```
<hr>

### CodeForces1371E1_AsterismÔºàHard VersionÔºâ

#### üîó
<a href="https://codeforces.com/contest/1371/problem/E2">![20220705212323](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220705212323.png)</a>

#### üí°
Ê†πÊçÆ‰∏äÈù¢ÁöÑÊÄùË∑ØÊúâÔºö   
Âà§Êñ≠ÊòØÂê¶ $b_i-(i-x)\equiv 0(mod\;p)$  
ÂèØËΩ¨Âåñ‰∏∫Âà§Êñ≠ÊòØÂê¶ $i-b_i\equiv x(mod\;p)$   
ËøôÈáå $i-b_i$ ÂèØ‰ª•Áõ¥Êé•È¢ÑÂ§ÑÁêÜÂ≠ò‰∏Ä‰∏ãÔºåÂç≥Â≠ò $(i-b_i)\%p$ ÔºåÁÑ∂ÂêéÂú®Êûö‰∏æ $x$ Êó∂Âà§Êñ≠ $x\%p$ ÊòØÂê¶Â≠òËøáÂç≥ÂèØ  
‰ΩÜÊòØÊ≥®ÊÑèÂà∞ËΩÆÊï∞‰∏ç‰∫íÈÄöÔºåÂõ†‰∏∫ËΩ¨Âåñ‰πãÂêéÁöÑÂÖ¨Âºè‰∏∫ $f(x)=\prod\limits_{i=x}^{x+n-1}x-(i-b_i)$ ÔºåÊàë‰ª¨Êûö‰∏æÁöÑÊòØ $x$ ÔºåÂΩì $x+1$ ÂêéÔºå‰∏ä‰∏ÄËΩÆÁöÑ $i=x$ Â∞±‰∏çËÉΩÁî®‰∫Ü  
ÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•ÂÖàÂ≠òÂÖ•Á¨¨‰∏ÄËΩÆÔºåÁÑ∂ÂêéÂú®Âà§Êñ≠ÂÆå‰∏Ä‰∏™ $x$ ÊòØÂê¶ËÉΩÁî®ÂêéÔºåÂ∞Ü $i=x$ Êó∂ÁöÑ $i-b_i$ Âà†ÂéªÔºåÂä†ÂÖ•‰∏ã‰∏ÄËΩÆÁöÑ $i-b_i$ ÔºåÂç≥ $i=x+n$ Êó∂ÁöÑ  
ËøôÊ†∑Âà§Êñ≠‰∏ãÂéªÂ∞±Ë°å‰∫Ü   


#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
const int N = 1e5 + 10;
int n, p;
int a[N];
inline int sub (int a, int b) { return ((a - b) % p + p) % p; }
 
int vis[N];
 
int main () {
        ios::sync_with_stdio(false);
        cin.tie(nullptr);
 
        cin >> n >> p;
        for (int i = 0; i < n; i ++) cin >> a[i];
 
        sort(a, a + n);
 
        for (int i = a[n - 1] - n + 1; i <= a[n - 1]; i ++) {
                vis[sub(i, upper_bound(a, a + n, i) - a) % p] ++;
        }
 
        vector<int> res;
        for (int x = max(0, a[n - 1] - n + 1); x <= a[n - 1]; x ++) {
                if (!vis[x % p]) res.push_back(x);
                vis[sub(x, upper_bound(a, a + n, x) - a) % p] --; // Âà†Èô§ i=x ÁöÑËÆ∞ÂΩï
                vis[sub(x + n, upper_bound(a, a + n, x + n) - a) % p] ++; // Âä†ÂÖ• i=x+n ÁöÑËÆ∞ÂΩï
        }
        cout << res.size() << endl;
        for (int i : res) cout << i << " ";
}
```
<hr>


### CodeForces1422C_Bargain

#### üîó
<a href="https://codeforces.com/contest/1422/problem/C">![20220705154656](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220705154656.png)</a>

#### üí°
ËøôÁßçÂØπÊï∞ËøõË°åÊìç‰ΩúÔºåÁÆóÊâÄÊúâÁªìÊûúÁöÑÂíåÁöÑÔºåÁõ¥Êé•ÁÆóÊØè‰∏Ä‰∏™Êï∞ÂÅöÂá∫Ë¥°ÁåÆÁöÑÊ¨°Êï∞  
‰ΩÜÊòØÁî±‰∫éÊàë‰ª¨ÂèØ‰ª•Âà†‰∏Ä‰ΩçÂêéÈù¢ÁöÑÊï∞ÔºåÂÆÉÊâÄÂú®ÁöÑ‰ΩçÊï∞‰ºöÂèëÁîüÊîπÂèòÔºåÊâÄ‰ª•Êàë‰ª¨Ë¶ÅÁÆóÁöÑÊòØÂÆÉ‰Ωú‰∏∫Á¨¨Âá†‰ΩçÊâÄÂÅöÂá∫ÁöÑË¥°ÁåÆÊòØÂ§öÂ∞ë  
  
ÂØπÁ¨¨ $k$ ‰ΩçÁöÑÊï∞ $x$ ÂÅö‰∏Ä‰∏ãÂàÜÁ±ªËÆ®ËÆ∫Ôºö  
‰Ωú‰∏∫Á¨¨ $1$ ‰ΩçÔºöÂêéÈù¢ÂÖ®Âà†  
‰Ωú‰∏∫Á¨¨ $2$ ‰ΩçÔºöÂêéÈù¢Âà†Âà∞Ââ© $1$ ‰∏™  
‰Ωú‰∏∫Á¨¨ $3$ ‰ΩçÔºöÂêéÈù¢Âà†Âà∞Ââ© $2$ ‰∏™  
$...$   
‰Ωú‰∏∫Á¨¨ $k$ ‰ΩçÔºöÂâçÈù¢Âà†‰ªªÊÑèÂ≠êÊÆµ  
Â¶ÇÊûúÊï∞Êúâ $n$ ‰ΩçÔºåÈÇ£‰πàÁ¨¨ $k$ ‰Ωç‰Ωú‰∏∫ $[1,k-1]$ ‰ΩçÁöÑË¥°ÁåÆ‰∏∫ $a_k\times (k-1)(k-2)...321$ ËøôÊ†∑ÁöÑÊï∞ÔºåÊàë‰ª¨ÂèØ‰ª•È¢ÑÂ§ÑÁêÜÂá∫Êù•‰∏Ä‰∏™ $1,21,321,4321,...$ ËøôÊ†∑ÁöÑÊï∞ÁªÑ `\_dots321`  
ËÄå‰Ωú‰∏∫Á¨¨ $k$ ‰ΩçÁöÑË¥°ÁåÆÊ¨°Êï∞ÔºåÂâçÈù¢Êúâ $n-k$ ‰∏™Êï∞ÔºåÊâÄ‰ª•Êúâ $\binom{n-k}{2}$ ÁßçÂ≠êÊÆµÊà™ÂèñÊñπÂºèÔºåÂÜç‰πò‰∏äÂÆÉÂØπÂ∫îÁöÑ‰ΩçÊï∞Âç≥ $10^{k}$ ÔºåÂàôË¥°ÁåÆÊòØ $a_k\times \binom{n-k}{2}10^k$   
  
Áî±‰∫é‰∏äÈù¢ËØ¥ÁöÑÊòØ‚Äú‰Ωç‚Äù‰∏çÊòØ‚Äú‰∏ãÊ†á‚Äù  
ÂàôËΩ¨Êç¢‰∏∫‰∏ãÊ†áÁöÑÊúÄÁªàÁªìÊûú‰∏∫Ôºö  
$$\sum\limits_{i=1}^n(\binom{i-1}{2}10^{n-i}+\_dots321_{n-i})s_i$$


#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
const ll N = 1e5 + 10;
const ll mod = 1e9 + 7;
inline ll ksm (ll a, ll b) { ll res = 1; while (b) { if (b & 1) res = res * a % mod; a = a * a % mod; b >>= 1; } return res; }
inline ll inv (ll x) { return ksm(x, mod - 2); }

ll _dots321[N];
ll pw10[N];
ll iv2;

int main () {
        ios::sync_with_stdio(false);
        cin.tie(nullptr);

        _dots321[0] = 0;
        _dots321[1] = 1;
        for (int i = 2; i < N; i ++) _dots321[i] = (_dots321[i - 1] * 10 % mod + 1) % mod;
        for (int i = 2; i < N; i ++) _dots321[i] = (_dots321[i - 1] * 10 % mod + _dots321[i]) % mod;
        pw10[0] = 1;
        for (int i = 1; i < N; i ++) pw10[i] = pw10[i - 1] * 10 % mod;
        iv2 = inv(2);


        ll res = 0;

        string s; cin >> s; s = "0" + s;
        ll n = s.size() - 1;
        for (int i = n; i >= 1; i --) {
                ll pre = 1ll * (i - 1) * i % mod * iv2 % mod * pw10[n - i] % mod;
                res += (pre + _dots321[n - i]) % mod * (s[i] - '0') % mod;
                res %= mod;
        }
        cout << res << endl;
}
```
<hr>


### CodeForces1536B_AdvertisingAgency

#### üîó
<a href="https://codeforces.com/problemset/problem/1536/B"><img src="https://img-blog.csdnimg.cn/20210410211951223.png"></a>

#### üí°
Êàë‰ª¨‰ªé‰∏äÂêë‰∏ãÂèñÊï∞ÔºåÊúÄÂ§öËÉΩÂèñÁöÑ‰∏™Êï∞ÂèñÂÜ≥‰∫éÔºöÊàë‰ª¨ÈúÄË¶ÅÂ§öÂ∞ë‰∏™Ë∑üÁ¨¨k‰∏™Êï∞Áõ∏Á≠âÁöÑÊï∞ned„ÄÅË∑üÁ¨¨k‰∏™Êï∞Áõ∏Á≠âÁöÑÊï∞ÁöÑ‰∏™Êï∞num„ÄÇ  
Ëøô‰∏§‰∏™ÂæóÂà∞ËøòÊòØÊØîËæÉÂÆπÊòìÁöÑÔºåÂ∞±ËÄÉÈ™å‰∫ÜÂÜôÁ†ÅÁöÑ‰∏•Ë∞®ÊÄßÔºåËÄåËøô‰∏™‰∏™Êï∞ÊòéÊòæÊòØÁªÑÂêàÊï∞ÔºåÂÄº‰∏∫(num!) / (ned!) / ((num-ned)!)Âπ∂ÂèñÊ®°  
Ëß£ÁªÑÂêàÊï∞Êúâ‰∏§ÁßçÊñπÂºèÔºö  
1.Êù®Ëæâ‰∏âËßíÈÄíÊé®Ê≥ïÔºà1000*1000ÔºâÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶  
2.Âú®ÁªìÊûú‰∏äÂÅöËøêÁÆóÔºö**Ê±ÇÈÄÜÂÖÉ**  

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >

```cpp
const ll mod = 1e9 + 7;
int cass;
ll n, k;

ll qpow(ll a,ll b){//ksm
    ll ans = 1;
    while(b){
        if(b&1)
            ans = ans * a % mod;
        a = a * a % mod;
        b >>= 1;
    }
    return ans%mod;
}

ll Inv(ll a,ll p){//ÈÄÜÂÖÉ
    return qpow(a, p - 2);
}

void solve(){
    vector<ll> vec;
    cin >> n >> k;
    for (int i = 0,x; i < n; i++){
        cin >> x;
        vec.push_back(x);
    }
    sort(vec.begin(), vec.end(), greater<ll>());//ÂêàÂπ∂Âá∫ÊúÄÂ§ßÊï∞ÔºåÂ∞±Ë¶ÅÈôçÂ∫èint cur = k;
    map<int, ll> mp;//mp[i]Ë°®iÁöÑÂá∫Áé∞Ê¨°Êï∞
    for (int i = 0; i < vec.size(); i++)
    {
        if(mp[vec[i]]==0)
            mp[vec[i]] = 1;
        else
            mp[vec[i]]++;
    }
    k--;//Êàë‰ª¨‰ªé0ÂºÄÂßãÂ≠òÁöÑÔºåÁ¨¨k‰∏™ÁöÑ‰∏ãÊ†á‰∏∫k-1
    ll num = mp[vec[k]];//Á¨¨k‰∏™Êï∞ÊúâÂ§öÂ∞ë‰∏™
    ll ned = 0;//Êàë‰ª¨ÈúÄË¶ÅÂ§öÂ∞ë‰∏™Á¨¨k‰∏™Êï∞
    for (int i = k; i >= 0; i--){
        if(i==0||vec[i]!=vec[i-1]){
            ned = k - i + 1;
            break;
        }
    }

    //ÂâçÈù¢ÁöÑÂ∞èÂùëÁªìÊùü‰∫ÜÔºåÂºÄÂßãÁªÑÂêàÊï∞ÂèñÊ®°
    ll on = 1;//ÂàÜÂ≠ê
    for (int i = ned + 1; i <= num; i++)
        on = on * i % mod;
    ll dn = 1;//ÂàÜÊØç
    for (int i = 1; i <= num - ned; i++)
        dn = dn * i % mod;
    cout << on * Inv(dn, mod) % mod << endl;
}

int main()
{
    each_cass(cass){
        solve();
    }
    return 0;
}
```

<hr>

### CodeForces1557C_MoamenAndXOR

#### üîó
<a href="https://codeforces.com/problemset/problem/1557/C"><img src="https://i.loli.net/2021/09/13/7RtnEshvGNxBioz.png"></a>

::: details ÊÄùË∑Ø‰∏Ä

#### üí°
È¶ñÂÖàÊääÊï¥‰∏™<img src="https://latex.codecogs.com/svg.image?n" title="n" />‰∏™k‰ΩçÊï∞ÁîªÊàê‰∏Ä‰∏™<img src="https://latex.codecogs.com/svg.image?n\times&space;k" title="n\times k" />ÁöÑÁü©Èòµ  
ÁÑ∂ÂêéÂØπ‰∫éÊØè‰∏ÄÂàóÔºå‰πüÂ∞±ÊòØ<img src="https://latex.codecogs.com/svg.image?n" title="n" />‰∏™Êï∞ÁöÑÊØè‰∏Ä‰Ωç  
Â¶ÇÊûúÂÖ®<img src="https://latex.codecogs.com/svg.image?1" title="1" />‰∫ÜËØù<img src="https://latex.codecogs.com/svg.image?\And&space;=1" title="\And =1" />ÔºåÊúâ‰∏Ä‰∏™<img src="https://latex.codecogs.com/svg.image?0" title="0" />Â∞±ÊòØ<img src="https://latex.codecogs.com/svg.image?0" title="0" />„ÄÇ  
ÂÅ∂Êï∞‰∏™<img src="https://latex.codecogs.com/svg.image?1" title="1" />‰∫ÜËØù<img src="https://latex.codecogs.com/svg.image?\bigoplus&space;=0" title="\bigoplus =0" />ÔºåÂ•áÊï∞‰∏™<img src="https://latex.codecogs.com/svg.image?\bigoplus&space;=1" title="\bigoplus =1" />  
  
ÂæóÂà∞‰∏§Êù°ÊÄßË¥®Ôºö  
**n‰∏∫Â•áÊï∞Êó∂Ôºö** Ëøô‰∏Ä‰ΩçÊúÄÂ§öÂú®Âê´ÊúâÂÅ∂Êï∞‰∏™<img src="https://latex.codecogs.com/svg.image?1" title="1" />ÁöÑÊó∂ÂÄô‰∏éÂíåÂºÇÊàñÁõ∏Á≠âÔºåÈÉΩÊòØ<img src="https://latex.codecogs.com/svg.image?0" title="0" />  
**n‰∏∫ÂÅ∂Êï∞Êó∂Ôºö** Ëøô‰∏Ä‰ΩçÂú®ÂÖ®<img src="https://latex.codecogs.com/svg.image?1" title="1" />Êó∂Ôºå<img src="https://latex.codecogs.com/svg.image?\And&space;=1" title="\And =1" />Ôºå<img src="https://latex.codecogs.com/svg.image?\bigoplus&space;=0" title="\bigoplus =0" />„ÄÇËÄåÂú®ÂÖ®<img src="https://latex.codecogs.com/svg.image?1" title="1" />‰ª•‰∏ãÁöÑÂÅ∂Êï∞‰∏™Êó∂Ôºå<img src="https://latex.codecogs.com/svg.image?\And&space;=\bigoplus&space;=0" title="\And =\bigoplus =0" />  
  
ÈÇ£‰πàÊúâ‰∏§Á±ªËß£ÂÜ≥ÊñπÊ°àÔºö  
**n‰∏∫Â•áÊï∞Êó∂Ôºö**   
ÊØè‰∏Ä‰ΩçÊúÄÂ§öÂè™ËÉΩÁõ∏Á≠âÔºåÂ∞±ÊòØÂú®ÊØè‰∏Ä‰ΩçÈÉΩÊúâÂÅ∂Êï∞‰∏™<img src="https://latex.codecogs.com/svg.image?1" title="1" />ÊàñËÄÖÂÖ®<img src="https://latex.codecogs.com/svg.image?1" title="1" />ÁöÑÊÉÖÂÜµ‰∏ã  
ÊâÄ‰ª•Êàë‰ª¨ÂØπÊØè‰∏Ä‰ΩçÁöÑn‰∏™Êï∞Â≠óËøõË°åÊéíÂàóÁªÑÂêàÔºåËÆæÂÅ∂Êï∞‰∏™<img src="https://latex.codecogs.com/svg.image?1" title="1" />ÂíåÂÖ®<img src="https://latex.codecogs.com/svg.image?1" title="1" />ÁöÑÁªÑÂêàÊÉÖÂÜµÁ¥ØÂä†‰∏∫<img src="https://latex.codecogs.com/svg.image?has\_Eve&plus;1" title="has\_Eve+1" />    
ÈÇ£‰πàÁ≠îÊ°àÂ∞±ÊòØ  
<img src="https://latex.codecogs.com/svg.image?(has\_Eve&plus;1)^k" title="(has\_Eve+1)^k" />   
**n‰∏∫ÂÅ∂Êï∞Êó∂Ôºö**  
ÊØè‰∏Ä‰ΩçÂèØ‰ª•ÊòØÁõ∏Á≠âÔºåÂ∞±ÊòØÂú®ÊØè‰∏Ä‰ΩçÂú®ÈùûÂÖ®<img src="https://latex.codecogs.com/svg.image?1" title="1" />‰∏îÊúâÂÅ∂Êï∞‰∏™ÁöÑÊÉÖÂÜµ‰∏ãÔºåËÆæ‰∏∫<img src="https://latex.codecogs.com/svg.image?has\_Eve" title="has\_Eve" />  
ÂΩìÂâç‰ΩçËøòÂèØ‰ª•Â§ß‰∫éÔºåÂ∞±ÊòØÂú®Ëøô‰∏Ä‰Ωç(ËÆæ‰∏∫<img src="https://latex.codecogs.com/svg.image?i" title="i" />)ÂÖ®<img src="https://latex.codecogs.com/svg.image?1" title="1" />ÁöÑÊÉÖÂÜµ‰∏ãÔºåÈÇ£‰πàÂâçÈù¢ÁöÑÊâÄÊúâ‰ΩçÈÉΩÂèØ‰ª•‰ªªÊÑè‰∏™<img src="https://latex.codecogs.com/svg.image?\And&space;=1" title="\And =1" />ÁªÑÂêàÔºåÊñπÊ°àÊúâ<img src="https://latex.codecogs.com/svg.image?(2^n)^{i-1}" title="(2^n)^{i-1}" />‰∏™  
ÊâÄ‰ª•Ëøô‰∏Ä‰ΩçÂ∞±ÊòØË¶ÅÈÄíÊé®ÔºåÁ≠îÊ°àÊòØ  
<img src="https://latex.codecogs.com/svg.image?\begin{aligned}i\{1\to&space;k\}:\\&res=res\times&space;has\_Eve&space;&plus;&space;(2^n)^{i-1}\end{aligned}" title="\begin{aligned}i\{1\to k\}:\\&res=res\times has\_Eve + (2^n)^{i-1}\end{aligned}" />

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >

```cpp
const int N = 2e5 + 10;
const int mod = 1e9 + 7;
ll f[N];

inline void Get_F () {
        f[0] = 1;
        for ( int i = 1; i < N; i ++ ) 
                f[i] = f[i - 1] * i % mod;
}
inline ll ksm ( ll a, ll b ) {
        ll res = 1;
        while ( b > 0 ) {
                if ( b & 1 ) res = res * a % mod;
                a = a * a % mod;
                b >>= 1;
        }
        return res;
}
inline ll C ( ll a, ll b ) {
        return f[a] * ksm(f[b], mod - 2) % mod * ksm(f[a - b], mod - 2) % mod;
}

inline void solve () {
        ll n, k; cin >> n >> k;

        ll has_Eve = 0; for ( ll i = 0; i < n; i += 2 ) has_Eve = (has_Eve + C(n, i)) % mod;
        if ( n & 1 ) {
                cout << ksm ( has_Eve + 1, k) << endl; // ÊØè‰∏Ä‰ΩçÈÉΩÊòØË¶Å‰πàÈÄâÂÅ∂Êï∞‰∏™Ë¶Å‰πàÂÖ®ÈÄâÔºåÂè™ÊúâËøôÊ†∑ÊâçËÉΩÁõ∏Á≠â
        } else {
                ll res = 1;
                for ( ll i = 1; i <= k; i ++ ) {
                        res = res * has_Eve % mod;                 // Á¨¨i‰Ωç‰∏çÂÖ®ÊòØ1 -- Ââç‰∏Ä‰ΩçÊª°Ë∂≥ÁöÑÊñπÊ°àÊï∞‰πòÂÆÉ
                        res = (res + ksm(ksm(2, n), i - 1)) % mod; // Á¨¨i‰ΩçÂÖ®ÊòØ1 -- ÂâçÈù¢ÁöÑÂèØ‰ª•ÈöèÊÑèÊêû
                }
                cout << res << endl;
        }
}

int main () {
#ifndef ONLINE_JUDGE
        freopen("in.in", "r", stdin);
        freopen("out.out", "w", stdout);
#endif
        Get_F();
        int cass;
        for ( cin >> cass; cass; cass -- ) {
                solve();
        }
}
```

:::

::: details ÊÄùË∑Ø‰∫å

#### üí°

Âíå [Ê∏ÖÊñ∞È¢ò](#ÁâõÂÆ¢ÊåëÊàòËµõ58b-Ê∏ÖÊñ∞È¢ò) ÊÄùË∑ØËß£Ê≥ï‰∏ÄÊ†∑Ôºå‰ΩøÁî®ÂØπ‰∫éÊØè‰∏Ä‰ΩçËÄÉËôëÂâçÁõ∏ÂêåÔºåÊ≠§‰ΩçÂ§ßÔºåÂêéÈöèÊÑèÁöÑÊñπÂºè  
È¶ñÂÖàÈ¢ÑÂ§ÑÁêÜÂá∫ $one\_one$ Âíå $zero\_zero$ Ë°®Á§∫Â∑¶Âè≥Âùá‰∏∫ $0$ Âíå $1$ ÁöÑÊñπÊ°àÊï∞  
ÂâçÁõ∏ÂêåÂç≥ $(one\_one+zero\_zero)^{i-1}$   
Ê≠§‰ΩçÂ§ßÂ∞±ÊòØËøô‰∏Ä‰ΩçÂ∑¶‰æß‰∏∫ $1$ Âè≥‰æß‰∏∫ $0$ ÔºåÂΩì‰∏î‰ªÖÂΩì $n$ ‰∏∫ÂÅ∂Êï∞Êó∂ÂèØ‰ª•  
ÂêéÈöèÊÑèÂ∞± $2^{k-i}$   
ÊúÄÂêéÂä†‰∏äÊâÄÊúâÁõ∏ÂêåÂç≥ $(one\_one+zero\_zero)^k$   
  
#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >

```cpp
const int mod = 1e9 + 7;
 
inline ll ksm ( ll a, ll b ) { ll res = 1; while ( b ) { if ( b & 1 ) res = res * a % mod; a = a * a % mod; b >>= 1; } return res; }
inline ll inv ( ll x ) { return ksm(x, mod - 2); }
ll f[200005];
inline ll C ( ll n, ll m ) { return f[n] * inv(f[m]) % mod * inv(f[n - m]) % mod; }
 
inline void Solve () {
        ll n, k; cin >> n >> k;
        
        ll one_one = n % 2;
        ll zero_zero = 0;
        for ( int i = 0; i <= n; i += 2 ) {
                zero_zero += C(n, i);
                zero_zero %= mod;
        } if ( n % 2 == 0 ) zero_zero --, zero_zero = (zero_zero % mod + mod) % mod;
 
        ll res = ksm((one_one + zero_zero) % mod, k);
        for ( int i = 1; i <= k; i ++ ) {
                res += ksm((one_one + zero_zero) % mod, i - 1)
                       * (n % 2 == 0) % mod
                       * ksm(ksm(2, n), k - i) % mod;
                res %= mod;
        }
        cout << res << endl;
}
 
int main () {
        cin.tie(0)->sync_with_stdio(0);
        cin.exceptions(cin.failbit);
        f[0] = 1; for ( int i = 1; i < 200005; i ++ ) f[i] = f[i - 1] * i % mod;
        int cass; cin >> cass; while ( cass -- ) {
                Solve ();
        }
}
```

:::

<hr>

### CodeForces1594B_SpecialNumbers

#### üîó
<a href="https://codeforces.com/contest/1594/problem/B"><img src="https://i.loli.net/2021/10/09/RMkqpLPQY5TFEr1.png"></a>

#### üí°
ÂØπ‰∏Ä‰∏™bËøõË°åÂàÜÂâ≤  
È¶ñÂÖàÁúã‰∏Ä‰∏ãÊåâÈ°∫Â∫èÁöÑÊéíÂàóÊÉÖÂÜµÔºö  
0 (1)  
1 0+1 (2)   
2 0+2 1+2 0+1+2 (4)   
3 0+3 1+3 2+3 0+1+3 0+2+3 1+2+3 0+1+2+3 (8)  
...  
È¶ñÂÖàÊÉ≥Âà∞ÂØπbËøõË°åÊü•ÊâæÔºåÁúãÁúãÊòØÂ≠òÂú®‰∫éÂì™‰∏ÄÁªÑÔºàËÆæ‰∏∫basÔºâ‰∏≠  
ÁÑ∂Âêé`b -= (1ll << bas)`  
ÂèØ‰ª•ÂèëÁé∞Ââ©‰∏ãÁöÑ‰πüÂ∞±ÊòØË¢´ÊãÜËøá‰πãÂêéÁöÑÂÄºÔºåÂèØ‰ª•ÁªßÁª≠ËøõË°åÂàÜÂâ≤ÔºåÁÑ∂ÂêéÊü•Êâæ  
ÈÇ£‰πàÊØèÊ¨° `res` ‰πüÂ∞±ÊòØÂä†‰∏ä a^basÔºåÁõ¥Âà∞bË¢´ÊãÜÂà∞0  

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >

```cpp
const int mod = 1e9 + 7;

inline ll ksm ( ll a, ll b ) {
	ll res = 1;
	while ( b ) {
		if ( b & 1 ) res = res * a % mod;
		a = a * a % mod;
		b >>= 1;
	}
	return res;
}

inline void Solve() {
	ll a, b; cin >> a >> b;
	ll res = 0;
	while ( b > 0 ) {
		ll bas = 0, sum = 0;
		while ( sum + (1ll << bas) < b ) {
			sum += (1ll << bas);
			bas ++;
		}
		res = (res + ksm(a, bas)) % mod;
		b -= (1ll << bas);
	}
	cout << res << endl;

}

int main () {
	int cass; cin >> cass; while ( cass -- ) {
		Solve();
	}
        return 0;
}
```

<hr>

### CodeForces1594E1_Rubik'sCubeColoring(easyversion)

#### üîó
<a href="https://codeforces.com/contest/1594/problem/E1"><img src="https://i.loli.net/2021/10/09/D1sUwZuREFK5rkV.png"></a>

#### üí°
È¶ñÂÖàÂ∫îËØ•ËÉΩÂæàÂø´ÊÉ≥Âà∞ÔºåÂè™ÊúâÁ•ñÂÖàËäÇÁÇπÊúâ6ÁßçÈ¢úËâ≤ÂèØ‰ª•ÈÄâÔºåÈÇ£‰πàÂØπ‰∫éÊØè‰∏™ÊúâÁà∂ËäÇÁÇπÁöÑËäÇÁÇπÔºå‰ªñ‰ª¨ÈÉΩÂè™ËÉΩÈÄâÂõõ‰∏™  
‰∏ÄÂÖ±Êúâ<img src="https://latex.codecogs.com/svg.image?2^k-1" title="2^k-1" />‰∏™ËäÇÁÇπ  
ÈÇ£‰πàÁ≠îÊ°àÂÖ¨ÂºèÂ∞±ÊòØ<img src="https://latex.codecogs.com/svg.image?6\times&space;4^{2^k-2}" title="6\times 4^{2^k-2}" />  
  
Ê≠§Êó∂k‰∏çËøá60ÊâÄ‰ª•Êàë‰ª¨‰πüÊ≤°ÊúâÂøÖË¶ÅÁî®Âø´ÈÄüÂπÇÊ±ÇÊåáÊï∞  
Â¶ÇÊûúÈùûË¶ÅÁî®ÁöÑËØùÔºåÊ®°Êï∞Ë¶ÅÈÄâÊã©<img src="https://latex.codecogs.com/svg.image?10^9&plus;6" title="10^9+6" />ÔºåÂõ†‰∏∫Ê†πÊçÆÊ¨ßÊãâÂÆöÁêÜÔºåÊåáÊï∞ÂèñÊ®°Êó∂Âú®<img src="https://latex.codecogs.com/svg.image?gcd(up,&space;mod)=1" title="gcd(up, mod)=1" />Êó∂Ë¶ÅÂèñ<img src="https://latex.codecogs.com/svg.image?\phi(mod)" title="\phi(mod)" />

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >

```cpp
const int mod = 1e9 + 7;

inline ll ksm ( ll a, ll b ) {
	ll res = 1;
	while ( b ) {
		if ( b & 1 ) res = res * a % mod;
		a = a * a % mod;
		b >>= 1;
	}
	return res;
}

int main () {
	ll n; cin >> n;
	cout << 6 * ksm(4, (1ll << n) - 2) % mod << endl;
        return 0;
}
```

<hr>

### CodeForces1644D_CrossColoring

#### üîó
<a href="https://codeforces.com/contest/1644/problem/D"><img src="https://img-blog.csdnimg.cn/e9a42398e1094cf1815b59ef9ee1d3ab.png"></a>

#### üí°
Ëøô‰∏™ÊòØË¶ÅËÉΩÂØπÁªìÊûúËøõË°åÂàÜÂå∫ÂÜçÁªÑÂêà  
Ê±ÇÂá∫Êàë‰ª¨ÂèØ‰ª•Âêë‰∏ãÁßªÂä®ÁöÑÊ¨°Êï∞ `can_dwn` ÂíåÂèØ‰ª•ÂêëÂè≥ÁßªÂä®ÁöÑÊ¨°Êï∞ `can_rgt`  

È¶ñÂÖàÊàë‰ª¨Ë¶ÅÊâæÂà∞ÁúüÊ≠£ÂèØ‰ª•ÁßªÂä®ÁöÑÈÉ®ÂàÜ  
Âç≥ $s[i]!=s[i+1]$ ÁöÑ‰ΩçÁΩÆÔºàÁ¨¨‰∏Ä‰∏™ÊãêËßí  
ÂÖàÊ±ÇÂá∫ÂΩªÂ∫ïÂåÖÂê´Á¨¨‰∏Ä‰∏™ÊãêËßí‰πãÂêéÁöÑË∑ØÂæÑÁöÑË°åÊï∞ `r` ÂíåÂàóÊï∞ `c`  
ÈÇ£‰πà  
<b>Á¨¨‰∏Ä‰∏™ÈÉ®ÂàÜ</b>ÊòØÊàë‰ª¨‰∏ÄÁõ¥ÂêëÂè≥ÁßªÂä®ÂèØ‰ª•Â§öË¶ÜÁõñÁöÑÈù¢ÁßØÔºö$can\_rgt\times c$  
<b>Á¨¨‰∫å‰∏™ÈÉ®ÂàÜ</b>ÊòØÊàë‰ª¨‰∏ÄÁõ¥Âêë‰∏ãÁßªÂä®ÂèØ‰ª•Â§öË¶ÜÁõñÁöÑÈù¢ÁßØÔºö$can\_dwn\times r$  
<b>Á¨¨‰∏â‰∏™ÈÉ®ÂàÜ</b>ÊòØÊàë‰ª¨ÂºÄÂßãÊó∂Ë¶ÜÁõñÁöÑÈù¢ÁßØÔºö$s.size()+1$  
<b>Á¨¨Âõõ‰∏™ÈÉ®ÂàÜ</b>ÊòØÊàë‰ª¨Âè≥‰∏ãËßíÁöÑÈù¢ÁßØÔºö$can\_dwn\times can\_rgt$  

Â∞ÜËøôÂõõÈÉ®ÂàÜÂä†Âú®‰∏ÄËµ∑Âç≥ÂèØ  

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
inline void Solve () {
        int n; cin >> n; n --;
        string s; cin >> s;
        ll rgt = 0, dwn = 0;
        for ( int i = 0; i < s.size(); i ++ ) {
                rgt += s[i] == 'R';
                dwn += s[i] == 'D';
        }
        ll canr = n - rgt;
        ll cand = n - dwn;
 
        string tmp = s; sort ( tmp.begin(), tmp.end() );
        if (tmp[0] == tmp.back()) {
                cout << n + 1 << endl;
                return;
        }
 
        int id = 0;
        for ( int i = 0; i < s.size(); i ++ ) {
                if ( s[i] != s[i + 1] ) {
                        id = i;
                        break;
                }
        }
        rgt = dwn = 1;
        for ( int i = id + 1; i < s.size(); i ++ ) rgt += s[i] == 'R', dwn += s[i] == 'D';
 
 
        ll dwn_num = rgt * cand;
        ll rgt_num = dwn * canr;
        cout << canr * cand + s.size() + 1 + dwn_num + rgt_num << endl;
}
```
<hr>

### CodeForces1649E_TylerAndStrings

#### üîó
<a href="https://codeforces.com/contest/1649/problem/E">![20220308115240](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220308115240.png)</a>

#### üí°
ËÄÉËôë‰∏Ä‰∏™Ê≤°Êúâ‰ªª‰ΩïÈôêÂà∂ÁöÑÊÉÖÂÜµ  
Ëã•Â≠òÂú® $cnt[i]$ ‰∏™ $i$ ÔºåÊûÑÈÄ†Âá∫‰∏çÂêåÁöÑÊï∞ÂàóÁöÑÊñπÊ°àÊï∞ $=\frac{(\sum\limits_{i=1}^Ncnt[i])!}{\prod\limits_{i=1}^Ncnt[i]!}$  
ËøôÈáåÊàë‰ª¨Ë¶ÅËÆ©Â≠óÂÖ∏Â∫è $a<b$  
ÈÇ£‰πà‰πüÂ∞±ÊòØËØ¥ÂøÖÈ°ªË¶ÅÂê´‰∏Ä‰∏≤Áõ∏ÂêåÁöÑÂâçÁºÄÔºåÁÑ∂ÂêéÂØπ‰∫éÁ¨¨‰∏Ä‰∏™ÈùûÂâçÁºÄÁöÑ‰ΩçÁΩÆÔºåËÆ© $a[i]<b[i]$  
Êûö‰∏æ‰ªéÁ¨¨ $i$ ‰∏™‰∏∫Á¨¨‰∏Ä‰∏™ÈùûÂêåÂâçÁºÄÁöÑ‰ΩçÁΩÆ  
- ÂâçÈù¢Áî±‰∫éÁõ∏ÂêåÔºåÊñπÊ°àÊï∞‰∏∫ $1$ 
- Á¨¨ $i$ ‰∏™‰ΩçÁΩÆÂèØ‰ª•ÈÄâÁöÑÊï∞ÁöÑ‰∏™Êï∞‰∏∫Â∞è‰∫é $b[i]$ ÁöÑÊï∞ÁöÑ‰∏™Êï∞ 
- ÂêéÈù¢ÂèØ‰ª•ÈöèÊÑèÊéíÂàóÔºå‰∏∫ $(n-i)!$
- ÊúÄÂêéË¶ÅÈô§ $\prod\limits_{i=1}^Ncnt[i]!$

ËÄÉËôë‰∏Ä‰∏™ÈÄíËøõÁöÑËÆ∞ÂΩïÔºåËøôÊ†∑ÂèØ‰ª•Èò≤Ê≠¢ÊØèÊ¨°Êàë‰ª¨Ë¶ÅÈáçÊñ∞ÂØπÊØè‰∏Ä‰∏™Êï∞ÁÆó $\prod\limits_{i=1}^Ncnt[i]!$ ‰∏é $\sum\limits_{j=1}^{b[i]-1}cnt[j]$  

$ifac,fac$ ÈÉΩÂèØ‰ª•ÊèêÂâçÈ¢ÑÂ§ÑÁêÜ  
ÂâçËÄÖÂèØ‰ª•Áª¥Êä§‰∏Ä‰∏™ $div\_permutation=\frac{1}{\prod\limits_{i=1}^Ncnt[i]!}$ ÔºåÊØèÊ¨°‰Ωø $cnt[b[i]]-1$ Êó∂ÊÑèÂë≥ÁùÄË¶ÅÂ∞ëÈô§‰∏Ä‰∏™ $cnt[b[i]]$ ÔºåÈÇ£‰πàËÆ© $div\_permutation\times cnt[b[i]]$ Âç≥ÂèØ  
ÂêéËÄÖÂèØ‰ª•Áî®Ê†ëÁä∂Êï∞ÁªÑÂéªËÆ∞ÂΩï  

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
const int N = 2e5 + 10;
const int mod = 998244353;
struct modint{ /*.....*/ };
# define mi modint

int n, m;
int a[N], b[N];
int cnt[N];
 
int t[N];
inline int lowbit ( int x ) { return x & -x; }
inline void Update ( int x, int c ) {
        while ( x < N ) t[x] += c, x += lowbit(x);
}
inline mi Query ( int x ) {
        mi res = 0;
        while ( x > 0 ) res += t[x], x -= lowbit(x);
        return res;
}
 
mi fac[N], ifac[N];
 
int main () {
        fac[0] = ifac[0] = 1;
        for ( int i = 1; i < N; i ++ ) fac[i] = fac[i - 1] * i, ifac[i] = ifac[i - 1] / i;
 
 
        scanf("%d%d", &n, &m);
        for ( int i = 1; i <= n; i ++ ) scanf("%d", &a[i]), cnt[a[i]] ++, Update(a[i], 1);
        for ( int i = 1; i <= n; i ++ ) scanf("%d", &b[i]);
 
        mi div_permutation = 1;
        for ( int i = 1; i < N; i ++ ) div_permutation *= ifac[cnt[i]];
 
        mi res = 0;
        bool flag = true;
        for ( int i = 1; i <= min(n, m); i ++ ) {
                res += Query(b[i] - 1) * fac[n - i] * div_permutation;
                div_permutation *= cnt[b[i]];
                cnt[b[i]] --;
 
                if ( cnt[b[i]] < 0 ) {
                        flag = false;
                        break;
                }
 
                Update(b[i], -1);
        }       
        if ( flag && n < m ) res += 1;
 
        printf("%d", res);
}
```
<hr>

### CodeForces1699C_TheThirdProblem

#### üîó
<a href="https://codeforces.com/contest/1699/problem/C">![20220705103135](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220705103135.png)</a>

#### üí°
È¶ñÂÖà $0„ÄÅ1$ ÁöÑ‰ΩçÁΩÆ‰∏ÄÂÆöÊòØÂõ∫ÂÆöÁöÑÔºåÂõ†‰∏∫Ë¶ÅÈÄöËøá $0„ÄÅ1$ ÁöÑ $[l,r]$ Á°ÆÂÆöÂá∫Êù• $mex=2$   
ÊâÄ‰ª•ÂèØ‰ª•ÂæÄÊï∞ÂÄº‰ªé $1,2,3,4,5,...$ ËÄÉËôëÁöÑÊñπÂºèÁùÄÊâã  
ËÄÉËôëËøôÊ†∑ÁöÑÂ∫èÂàó $[0,2,3,4,1]$ ÔºåÂÖ∂‰∏≠ÂØπ‰∫é $x\in\{2,3,4\}$ ÊÄé‰πàÊëÜÈÉΩ‰∏ç‰ºöÂΩ±Âìç $[l=1,r=5]$ ‰πü‰∏ç‰ºöÂΩ±Âìç $1$ Âà∞ $x$ Âíå $0$ Âà∞ $x$ ÂΩ¢ÊàêÁöÑ $mex[l,r]$ ÔºåÂõ†‰∏∫Á®≥ÂÆö‰∏äÂçá $mex$ ÁöÑÂå∫Èó¥Â∑≤ÁªèÂõ∫ÂÆö‰∫ÜÔºåÈáåÈù¢ÁöÑÊï∞ÂÄº‰∏çÁÆ°ÊÄé‰πàÊëÜÈÉΩ‰∏ç‰ºöÂΩ±ÂìçËøô‰∏™ $mex[l,r]$     
ËÄåÂ¶ÇÊûúËÄÉËôë $[0,3,4,1,2]$ ÔºåÁî±‰∫é $2$ ‰ºöËÆ© $[l,r]$ ÂêëÂ§ñÊõ¥Êñ∞ÔºåÊâÄ‰ª•Áî± $0,1,2$ Âõ∫ÂÆöÁöÑÂå∫Èó¥ $[l=1,r=5]$ ÊòØÂõ∫ÂÆöÁöÑÔºåÈÇ£‰πà $2$ ÁöÑ‰ΩçÁΩÆ‰πüÊòØÂõ∫ÂÆöÁöÑ    
  
Âú®ÂæÄ‰∏äÂêåÁêÜÔºåÂæóÂà∞ËøôÊ†∑‰∏Ä‰∏™ÊÄßË¥®Ôºö  
Â¶ÇÊûúÂØπ‰∫éÂΩìÂâçÊâ´ÊèèÁöÑ $x$ Âú® $[l,r]$ ÂÜÖÔºåÂàô $[l,r]$ ÂÜÖÁöÑÁ©∫‰ΩçÈÉΩÂèØ‰ª•‰æõ $x$ ÈÄâÊã©  
Â¶ÇÊûúÂØπ‰∫éÂΩìÂâçÊâ´ÊèèÁöÑ $x$ ‰∏çÂú® $[l,r]$ ÂÜÖÔºåÂàô $x$ ÊòØÂõ∫ÂÆöÁöÑÔºåÂêåÊó∂ÂêëÂ§ñÊâ©Âº† $[l,r]$   
Áî®Ëøô‰∏™ÊÄßË¥®Ê±ÇËß£Âç≥ÂèØ    


#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
inline void Solve () {
        int n; cin >> n;
        int l, r;
        vector<int> id(n);
        vector<int> a(n); for (int i = 0; i < n; i ++) {
                cin >> a[i];
                id[a[i]] = i;
                if (!a[i]) l = r = i;
        }
        ll res = 1;
        for (int i = 1; i < n; i ++) {
                if (id[i] < l || id[i] > r) l = min(l, id[i]), r = max(r, id[i]);
                else res = res * (1ll * r - l + 1 - i) % mod;
        }
        cout << res << endl;
}
```
<hr>

### HDU2021Â§öÊ†°7D_LinkWithBalls 

#### üîó
<a href="https://vjudge.net/contest/461347#problem/D">![20221113230923](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20221113230923.png)</a>

#### üí°
‰∏§Ê≠•ÈÉΩËµ∞Âà∞ÊàëÊÉ≥Ë±°‰∏çÂà∞ÁöÑÂú∞Êñπ...  
  
‰∏§‰∏™ÈÉΩÊúâÈôêÂà∂ÔºåÂç≥Â•áÊï∞ $2x-1$ Ë¶ÅÊ±ÇÊòØÈÄâ $x$ ÁöÑÂÄçÊï∞ÔºåÂÅ∂Êï∞ $2x$ Ë¶ÅÈÄâ‰∏çË∂ÖËøá $x$  
ËÄÉËôëÈôêÂà∂ÂíåÈôêÂà∂ÂèñÂπ∂ÈõÜËÉΩÂê¶ÂèòÂæóÊ≤°ÊúâÈôêÂà∂ÔºåÂèëÁé∞Â∞ÜÈÄâ $x$ ÁöÑÂÄçÊï∞Âíå‰∏çË∂ÖËøá $x-1$ ÁöÑ‰∏§‰∏™ÂùóÂêàÂπ∂Âà∞‰∏Ä‰∏™ÂùóÔºåÂàôÂØπ‰∫éËøô‰∏™ÂùóÊòØ‰ªªÈÄâ‰ªªÊÑèÊï∞ÈáèÁöÑ  
ÂêàÂπ∂ÁöÑÂùó‰∏∫Ôºö$1,(2,3),(4,5),...,(2n-2,2n-1),2n$  
Ââç $n$ ‰∏™ÈÉΩÊòØ‰ªªÈÄâÔºåÊúÄÂêé‰∏Ä‰∏™ÂùóÊòØÂèØ‰ª•ÈÄâ‰∏çË∂ÖËøá $n$ ‰∏™  
ÈÇ£‰πàÈ¶ñÂÖàÊúâ‰∏Ä‰∏™ÂºèÂ≠êÂ∞±ÊòØÊûö‰∏æÊúÄÂêé‰∏Ä‰∏™ÂùóÈÄâ $i$ ‰∏™ÔºåÁÑ∂ÂêéÂâç $m-i$ ‰∏™Áõ∏ÂêåÁöÑ‰∏úË•øÂàÜÈÖçËøõ $n$ ‰∏™‰∏çÂêåÁöÑÂùóÂÜÖ  
Âç≥ $\sum\limits_{i=0}^{min(n,m)}C_{m-i+n-1}^{n-1}$  
  
Ëøô‰∏™ÂºèÂ≠êÊó∂Èó¥Â§çÊùÇÂ∫¶Ëøá‰∏çÂéªÔºåÈúÄË¶Å‰ºòÂåñ  
ÁúãÂà∞ËøôÊòØ‰∏Ä‰∏™ÊÄªÈáèËøûÁª≠ÁöÑÊ±ÇÂíå  
Âú®ÁªÑÂêàÊï∞ÁöÑÊù®Ëæâ‰∏âËßíÊ±ÇËß£ÈáåÈù¢Ôºå$C_{n-1}^{m-1}=C_n^m-C_{n-1}^m$ ‰πüÊòØ‰∏Ä‰∏™ËøûÁª≠ÁöÑ‰∏úË•øÔºåÊãøËøô‰∏™Â•ó‰∏Ä‰∏™Âü∫Á°ÄÁöÑÂºèÂ≠êÁúãÁúã  
$C_{n-1}^{m-1}+C_{n-2}^{m-2}=C_n^m-C_{n-1}^m+C_{n-1}^m-C_{n-2}^m=C_n^m-C_{n-2}^m$  
ËÄåÊé®ÁöÑÂéüÂºè‰∏∫ $C_{m+n-1}^{n-1}+C_{m+n-2-1}^{n-1}+...+C_{m+n-min(n,m)-1}^{n-1}$  
Â∞±ÂèØ‰ª•ËøõË°åÂåñÁÆÄ‰∏∫ $C_{m+n}^n-C_{m+n-min(n,m)-1}^n$  
ÊúÄÁªàÂºèÂ≠êÂ∑≤Âá∫Ôºå$O(1)$ ÁÆóÂç≥ÂèØ   

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
const int mod = 1e9 + 7;
const int N = 2e6 + 10;
inline int ksm (int a, int b) {
    int res = 1;
    while (b) {
        if (b & 1) res = (ll)res * a % mod;
        a = (ll)a * a % mod;
        b >>= 1;
    }
    return res;
}
inline int inv (int x) {return ksm(x, mod - 2);}

int f[N], ivf[N];
inline int C (int n, int m) {
    if (n < m) return 0;
    return (ll)f[n] * ivf[n - m] % mod * ivf[m] % mod;
}

int main () {
    f[0] = 1;
    for (int i = 1; i < N; i ++) f[i] = (ll)f[i - 1] * i % mod;
    ivf[N - 1] = inv(f[N - 1]);
    for (int i = N - 2; i >= 0; i --) ivf[i] = (ll)ivf[i + 1] * (i + 1) % mod;

    int t; scanf("%d", &t); while (t --) {
        int n, m; scanf("%d%d", &n, &m);
        printf("%d\n", (C(m + n, n) - C(m - min(n, m) + n - 1, n) + mod) % mod);
    }
}
```
<hr>


### HDU2021Â§öÊ†°8E_SeparatedNumber 

#### üîó
<a href="https://vjudge.net/contest/461348#problem/E">![20221113230653](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20221113230653.png)</a>

#### üí°
‰∏ÄÂÖ±Ë¶ÅÊîæÁΩÆ‰∏çË∂ÖËøá $k-1$ ÂùóÈöîÊùø  
È¶ñÂÖàÊ†πÊçÆÁªèÂÖ∏ÁªÑÂêàÊï∞Â•óË∑ØË¥°ÁåÆÊ¨°Êï∞ÔºåÊàë‰ª¨Ê±Ç $a_i$ ‰πò $10^j$ Êó∂ÁöÑË¥°ÁåÆ  
Â¶ÇÊûú $i+j=n$ ÔºåÈÇ£‰πà $i+j$ ÁöÑÂêéÈù¢ÊîæÈöîÊùøÊòØÊ≠£Â∏∏ÁöÑÔºåÊïÖÊúÄÂ§öËøòÂèØ‰ª•Êîæ $k-1$ ÂùóÔºå‰∏ÄÂÖ±Êúâ $n-j-1$ ‰∏™Á©∫  
Â¶ÇÊûú $i+j<n$ ÔºåÊúÄÂ§öËøòËÉΩÊîæ $k-2$ ÂùóÔºåÊúâ $n-j-1$ ‰∏™Á©∫  
ÂÖ¨ÂºèÂç≥‰∏∫ $\sum\limits_{i=1}^na_i\sum\limits_{j=0}^{n-i}10^j\sum\limits_{\alpha=0}^{k-1-[j\neq n-i]}C_{n-j-1-[j\neq n-i]}^{\alpha}$    
ÊãÜ‰∏Ä‰∏ãÂèòÊàê $\sum\limits_{i=1}^na_i\left\{\begin{aligned}\sum\limits_{j=0}^{n-i-1}10^jF_{n-j-2}^{k-2}\\10^{n-i}F_{n-j-1}^{k-1}\end{aligned}\right.$
Áî±‰∫éÁªÑÂêàÊï∞ÊòØÈ¢ÑÂ§ÑÁêÜÔºåÈÇ£‰πàÂêéÈù¢Ëøô‰∏Ä‰∏™ÁúãÁùÄÂÉèÂâçÁºÄÂíåÁöÑ‰πüÈ¢ÑÂ§ÑÁêÜ  
‰ª§ $F_n^m=\sum\limits_{i=0}^mC_n^i$  
$F_n^m=F_n^{m-1}+C_n^m$ ‰∏î $C_n^m=C_{n-1}^{m-1}+C_{n-1}^m$   
Êé®Âà∞ $\sum$ ÈáåÈù¢ÔºåÁî±‰∫éÂâçÁºÄ‰∏≠Èô§‰∫ÜËØ•‰ΩçÁΩÆÔºåÊØè‰∏Ä‰∏™ÈÉΩÊòØÁî®‰∫Ü‰∏§Ê¨°ÔºåÊïÖ $F_n^m=2F_{n-1}^m-C_{n-1}^m$  
ËøôÊ†∑Ê†πÊçÆ‰∏äÈù¢ÁöÑÂºèÂ≠êÊàë‰ª¨Âè™ÈúÄË¶ÅÈ¢ÑÂ§ÑÁêÜÂá∫ $F_{[]}^{k-1}$ Âíå $F_{[]}^{k-2}$ Âç≥ÂèØ  
ÈÇ£‰πàÂú®Ê±ÇÁöÑÊó∂ÂÄôËøòÊúâ‰∏Ä‰∏™Âõ∞ÈöæÂ∞±ÊòØÂú®Á¨¨‰∏ÄÁ±ªÊ±ÇËß£ÈáåÈù¢ËøòÊúâ‰∏Ä‰∏™Á¥ØÂä†Á¨¶Âè∑  
ÂèëÁé∞Âú®ÂÄíÁùÄÊé®ÁöÑÊó∂ÂÄô $n-i-1$ ÊòØÈÄíÂ¢ûÁöÑÔºå‰∏îÁ¨¨ $i$ È°πÂè™ÊØîÁ¨¨ $i+1$ È°πÂ§ö‰∫Ü $10^{n-i-1}F_{n-(n-i-1)-2}^{k-2}$ ÔºåÂà´ÁöÑÈÉΩÊ≤°ÂèòÔºå‰∫éÊòØÁ¨¨‰∏ÄÁ±ªÂèØ‰ª•ÂÄíÁùÄÊ±ÇÁÑ∂Âêé‰∏çÊñ≠Á¥ØÂä†‰∏äÊñ∞Â¢ûÁöÑÂÄºÔºåÂèØ‰ª•ËßÜ‰Ωú‰∏Ä‰∏™ÂêéÁºÄ  
Á¨¨‰∫åÁ±ªÂ∞±Áõ¥Êé•ÁÆóÂç≥ÂèØ  

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
const int mod = 998244353;
inline int ksm (int a, int b) {
    int res = 1;
    while (b) {
        if (b & 1) res = (ll)res * a % mod;
        a = (ll)a * a % mod;
        b >>= 1;
    }
    return res;
}
inline int inv (int x) {return ksm(x, mod - 2);}

const int N = 1e6 + 10;

int f[N], ivf[N];
inline int C (int n, int m) {
    if (n < m) return 0;
    return (ll)f[n] * ivf[m] % mod * ivf[n - m] % mod;
}

char s[N];
int a[N];

int Fkd1[N], Fkd2[N];
int pw10[N];

inline void Solve () {
    int k; scanf("%d", &k);
    scanf("%s", s + 1);
    int n = strlen(s + 1);
    for (int i = 1; i <= n; i ++) a[i] = s[i] - '0';

    if (k == 1) {
        int res = 0;
        for (int i = 1; i <= n; i ++) res = ((ll)res * 10 % mod + a[i]) % mod;
        printf("%d\n", res);
        return;
    }

    Fkd1[0] = Fkd2[0] = 1;
    for (int i = 1; i < N; i ++) 
        Fkd1[i] = (Fkd1[i - 1] * 2 % mod - C(i - 1, k - 1) + mod) % mod,
        Fkd2[i] = (Fkd2[i - 1] * 2 % mod - C(i - 1, k - 2) + mod) % mod;
    
    int sum_fkd2 = 0;
    int res = 0;
    for (int i = n; i >= 1; i --) {
        if (n - i - 1 >= 0) {
            (sum_fkd2 += (ll)pw10[n - i - 1] * Fkd2[n - (n - i - 1) - 2] % mod) %= mod;
        }
        int num = ((ll)pw10[n - i] * Fkd1[n - (n - i) - 1] % mod + sum_fkd2) % mod;
        (res += (ll)a[i] * num % mod) %= mod;
    }
    printf("%d\n", res);
}


int main () {
    f[0] = 1;
    for (int i = 1; i < N; i ++) f[i] = (ll)f[i - 1] * i % mod;
    ivf[N - 1] = inv(f[N - 1]);
    for (int i = N - 2; i >= 0; i --) ivf[i] = (ll)ivf[i + 1] * (i + 1) % mod;
    pw10[0] = 1;
    for (int i = 1; i < N; i ++) pw10[i] = (ll)pw10[i - 1] * 10 % mod;

    int cass; scanf("%d", &cass); while (cass --) {
        Solve();
    }
}
```
<hr>


### ICPC2018Âçó‰∫¨Á´ôJ_PrimeGame

#### üîó
<a href="https://codeforces.com/gym/101981/attachments">![20220924135831](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220924135831.png)</a>

#### üí°
ÂàöÊãøÂà∞Ëøô‰∏™È¢òÊòØÊÉ≥ÁùÄÊÄé‰πàÂéª‰ºòÂåñÂºèÂ≠êÔºåÂú®ÊÉ≥Áî®‰ªÄ‰πàÊï∞ÊçÆÁªìÊûÑÔºå‰ΩÜÊòØÂå∫Èó¥ÈóÆÈ¢òÁöÑÊó∂ÂÄôÂ∞±ÂæàÈöæÁúã‰∏Ä‰∏™Âå∫Èó¥ÊòØÂê¶Â≠òÂú®‰∏Ä‰∏™Êï∞ÔºåËøôÊ†∑ÁöÑËØùËøòË¶ÅÂÜçÂºÄ‰∏Ä‰∏™Â§çÊùÇÂ∫¶  
Áúã‰∏Ä‰∏ãÈóÆÁöÑÊòØ‰ªÄ‰πàÔºå‚ÄúÂØπ‰∫éÊâÄÊúâÂå∫Èó¥ÔºåÂá∫Áé∞ÁöÑ‰∏çÂêåË¥®Âõ†Êï∞Âíå‚ÄùÔºåÂä†ÂíåÊòØ‰ª•‰∏Ä‰∏™Ë¥®Âõ†Êï∞Âá∫Ê≤°Âá∫Áé∞‰∏∫Âçï‰ΩçÁöÑÔºåÈÇ£Â∞±ÂàÜÂºÄËÄÉËôëË¥®Âõ†Êï∞ÔºåÁ¥ØÂä†ÊØè‰∏Ä‰∏™Ë¥®Âõ†Êï∞ÁöÑË¥°ÁåÆÔºàÁªèÂÖ∏ÁªÑÂêàÂ•óË∑Ø  
È¶ñÂÖàÂ∞ÜÊâÄÊúâË¥®Êï∞Âá∫Áé∞ÁöÑÊâÄÊúâ‰ΩçÁΩÆÁªüËÆ°‰∏ÄÈÅç  
ÂØπ‰∫éË¥®Êï∞ $p$ ÁöÑÂá∫Áé∞‰ΩçÁΩÆÔºö$a,b,c,d$  
ÂÆÉÊâÄË¥°ÁåÆÁöÑÊ¨°Êï∞‰∏∫ $a\times(b-a)+(b-a)\times(c-b)+(d-c)\times(n+1-d)$  
ÊåâËøôÁßçÊñπÂºè‰∏Ä‰∏™Ë¥®Êï∞Ë¥°ÁåÆÁöÑÊ¨°Êï∞‰∏∫ $a_0=0,a_{sz+1}=n+1,\sum\limits_{i=1}^{sz}(a_i-a_{i-1})(a_{i+1}-a_i)$  

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
const int N = 1e6 + 10;
bool ntp[N];
int mnp[N];
vector<int> p;
vector<int> id[N];

int main () {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);

    ntp[0] = ntp[1] = 1;
    for (int i = 2; i < N; i ++) {
        if (!ntp[i]) p.push_back(i), mnp[i] = i;
        for (int j = 0; j < p.size() && 1ll * i * p[j] < N; j ++) {
            ntp[i * p[j]] = 1;
            mnp[i * p[j]] = p[j];
            if (i % p[j] == 0) break;
        }
    }

    for (int i = 2; i < N; i ++) id[i].push_back(0);
    int n; cin >> n;
    for (int i = 1; i <= n; i ++) {
        int x; cin >> x;
        while (x > 1) {
            id[mnp[x]].push_back(i);
            x /= mnp[x];
        } 
    } 
    for (int i = 2; i < N; i ++) id[i].push_back(n + 1);

    ll res = 0;
    for (int i = 2; i < N; i ++) {
        id[i].erase(unique(id[i].begin(), id[i].end()), id[i].end());
        for (int j = 1; j + 1 < id[i].size(); j ++) {
            res += 1ll * id[i][j] * (id[i][j + 1] - id[i][j]);
        }
    }
    cout << res << endl;
}
```
<hr>


### ICPC2020‰∏äÊµ∑Á´ôG_Fibonacci

#### üîó
<a href="https://codeforces.com/gym/102900/problem/G"><img src="https://img-blog.csdnimg.cn/cfad2ab416f3422e86ca29dcbcd0cc6b.png"></a>

#### üí°
fibonacciÊï∞ÂàóÊØèÁ¨¨‰∏â‰∏™Êï∞‰∏ÄÂÆöÊòØÂÅ∂Êï∞  
ÈÇ£‰πà `n/3` Ê±Ç‰∏Ä‰∏ãÂÅ∂Êï∞ÁöÑ‰∏™Êï∞ `eve` 
ÂÅ∂Êï∞ÂíåÊâÄÊúâÊï∞Áõ∏‰πòÈÉΩÊòØÂÅ∂Êï∞ `res = eve * n` ‰ΩÜÊòØ‰∏çËÉΩÂíåËá™Â∑±ÁªÑÂêà `res -= eve`  
ÂÅ∂Êï∞ÂÜÖÈÉ®‰∏§‰∏§ÁªÑÂêà‰πüÂ§öÂä†‰∫Ü‰∏ÄÊ¨°ÔºåË¶ÅÂáèÂéª `res -= eve * (eve - 1) / 2`  

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >

```cpp
int main () {
        ios::sync_with_stdio(false);

        ll n; cin >> n;
        ll eve = n / 3;
        ll res = eve * n - eve;
        res -= eve * (eve - 1) / 2;
        cout << res << endl;
}
```

<hr>

### NamomoCamp2022Êò•Â≠£div1ÊØèÊó•‰∏ÄÈ¢ò_ÊãÜÊãÜ

#### üîó
<a href="http://oj.daimayuan.top/problem/611">![20220324221847](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220324221847.png)</a>

#### üí°
Êàë‰ª¨ÂàÜËß£Ë¥®Âõ†Â≠ê  
$$x=p_1^{a_1}\times p_2^{a_2}\times\dots\times p_k^{a_k}$$  
Áî±‰∫éÊØè‰∏™Âõ†Êï∞‰∏çÂêå‰∏îÁã¨Á´ãÔºåÂØπËøô‰∏™ÈóÆÈ¢òËΩ¨Âåñ‰∏Ä‰∏ãÂÖ∂ÂÆû‰πüÂ∞±ÊòØÂ∞Ü $a_i$ ‰∏™ $p_i$ ÊîæÂÖ• $y$ ‰∏™ÁõíÂ≠êÂÜÖÔºåÁêÉÁõíÊ®°Âûã‰∏ãË°®ËææÂºè‰∏∫ $\binom{a_i+y-1}{y-1}$  
Âà©Áî®‰πòÊ≥ïÂéüÁêÜÂæóÂà∞ÁªìÊûú  
Ê≠£Êï∞ÊòØË¶ÅÂú® $y$ ‰∏≠ÂÅ∂Êï∞‰∏™‰Ωú‰∏∫Ë¥üÊï∞ÔºåÂç≥ $2^{y-1}$  
ËÆ©ÁªìÊûú‰πò‰∏äËøô‰∏™Êï∞Âç≥ÂèØ  
  
‰ΩÜÊòØËøôÈÅìÈ¢òÊó∂Èó¥Âç°ÁöÑÁ¥ßÔºåËÄÉËôë‰ºòÂåñÔºàÁúãÂà∞‰∫Ü‰∏ÄÂ†ÜÈªëÁßëÊäÄ  
::: tip Âø´ÈÄüÊãÜÂàÜË¥®Âõ†Êï∞
‰ª§ `npt[i]` Ë°®Á§∫Á≠õÂá∫Êù• $i$ ‰∏çÊòØË¥®Êï∞ÁöÑÊúÄÂ∞èË¥®Âõ†Êï∞  
ÁÑ∂ÂêéËÆ© $x$ ‰∏çÊñ≠ $x/ntp[x]$ Âç≥ÂèØÂæóÂà∞ÊâÄÊúâÁöÑË¥®Âõ†Êï∞  
```cpp
int ntp[N], prime[N], idx;
inline void Sieve () {
        ntp[1] = 1;
        for ( int i = 2; i < N; i ++ ) {
                if ( !ntp[i] ) prime[idx ++] = i, ntp[i] = i;
                for ( int j = 0; j < idx && 1ll * i * prime[j] < N; j ++ ) {
                        if ( !ntp[i * prime[j]] ) {
                                ntp[i * prime[j]] = prime[j];
                        }
                        if ( i % prime[j] == 0 ) break;
                }
        }
}

vector<int> table; // x ÁöÑË¥®Âõ†Êï∞ÁöÑÊåáÊï∞Ë°®
int lst = ntp[x], t = 1;
x /= ntp[x];
while ( ntp[x] > 1 ) {
        if ( ntp[x] == lst ) {
                t ++;
        } else {
                table.push_back(t);
                lst = ntp[x];
                t = 1;
        }
        x /= ntp[x];
}
if ( lst > 1 ) table.push_back(t);
```
:::

::: tip Âø´ÈÄüÊ±ÇÈò∂‰πòÈÄÜÂÖÉ
Âà©Áî®Â§ßÈò∂‰πòÂÅöÂàÜÊØçÔºåÁÑ∂ÂêéÂêëÂâçÂåñÁÆÄ
```cpp
ivf[n] = inv(f[n]);
for ( int i = n - 1; i >= 0; i -- ) ivf[i] = ivf[i + 1] * (i + 1) % mod;
```
:::

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
const int N = 2e6 + 10;
const int mod = 1e9 + 7;

inline ll ksm ( ll a, ll b ) { ll res = 1; while ( b ) { if ( b & 1 ) res = res * a % mod; a = a * a % mod; b >>= 1; } return res; }
inline ll inv ( ll x ) { return ksm(x, mod - 2); }

namespace Number {
        int ntp[N], prime[N], idx;
        inline void Sieve () {
                ntp[1] = 1;
                for ( int i = 2; i < N; i ++ ) {
                        if ( !ntp[i] ) prime[idx ++] = i, ntp[i] = i;
                        for ( int j = 0; j < idx && 1ll * i * prime[j] < N; j ++ ) {
                                if ( !ntp[i * prime[j]] ) {
                                        ntp[i * prime[j]] = prime[j];
                                }
                                if ( i % prime[j] == 0 ) break;
                        }
                }
        }
        ll f[N], ivf[N];
        inline void get_F () {
                f[0] = 1;
                for ( int i = 1; i < N; i ++ ) f[i] = f[i - 1] * i % mod;
                ivf[N - 1] = inv(f[N - 1]);
                for ( int i = N - 2; i >= 0; i -- ) ivf[i] = ivf[i + 1] * (i + 1) % mod;
        }
} using namespace Number;

inline ll C ( int n, int m ) {
        return f[n] * ivf[m] % mod * ivf[n - m] % mod;
}

inline void Solve () {
        int x, y; cin >> x >> y;

        vector<int> table;
        int lst = ntp[x], t = 1;
        x /= ntp[x];
        while ( ntp[x] > 1 ) {
                if ( ntp[x] == lst ) {
                        t ++;
                } else {
                        table.push_back(t);
                        lst = ntp[x];
                        t = 1;
                }
                x /= ntp[x];
        }
        if ( lst > 1 ) table.push_back(t);

        ll res = 1;
        for ( int i : table ) res = res * C(i + y - 1, y - 1) % mod;
        res = res * ksm(2, y - 1) % mod;
        cout << res << "\n";
}

int main () {
        cin.tie(0)->sync_with_stdio(0);
        cin.exceptions(cin.failbit);

        Sieve(); get_F();

        int cass; cin >> cass; while ( cass -- ) {
                Solve ();
        }
}
```
<hr>


### POJ3734_Blocks

#### üîó
<a href="https://ac.nowcoder.com/acm/contest/24710/D"><img src="https://i.loli.net/2021/11/25/t2savw1RVIrTjGd.png"></a>

#### üí°
È¶ñÂÖàÁîüÊàêÂáΩÊï∞ÊÉ≥‰∏ÄÊ≥¢ÔºåÊääËøôÂõõ‰∏™Á†ñÁöÑÁîüÊàêÂáΩÊï∞‰πòËµ∑Êù•ÂæóÂà∞  <img src="https://latex.codecogs.com/svg.image?\inline&space;\frac{1}{(1-x)^4(1+x)^2}" title="\inline \frac{1}{(1-x)^4(1+x)^2}" />  ÂèëÁé∞Âï•‰πü‰∏çÂï•ÔºåÂëäËæû  
ÁªÑÂêàÊï∞ÊÉ≥‰∏ÄÊ≥¢  
ÂÖ∂ÂÆûÂ∞±ÊòØÂàÜÊàê‰∏§ÈÉ®ÂàÜÔºå‰∏ÄÈÉ®ÂàÜ‰∏ÄÂÆöÊòØÂÅ∂Êï∞Ôºå‰∏ÄÈÉ®ÂàÜÊó†ÊâÄË∞ìÔºåÂÅ∂Êï∞ÈÇ£‰∏ÄÈÉ®ÂàÜÂàÜÊàê‰∏§‰ªΩÂÅ∂Êï∞ÔºåÊó†ÊâÄË∞ìÈÇ£‰∏ÄÈÉ®ÂàÜÂàÜÊàê‰∏§‰ªΩÊó†ÊâÄË∞ì  
 <img src="https://latex.codecogs.com/svg.image?\inline&space;n" title="\inline n" />  ÂùóÁ†ñÈÄâÂÅ∂Êï∞‰∏™Êúâ  <img src="https://latex.codecogs.com/svg.image?\inline&space;2^{n-1}" title="\inline 2^{n-1}" />  ÁßçÔºåÈÄâ‰ªªÊÑè‰∏™Êúâ  <img src="https://latex.codecogs.com/svg.image?\inline&space;2^n" title="\inline 2^n" />  Áßç  
ÈÇ£‰πà‰ªéËøôÂÅ∂Êï∞‰∏™‰∏≠ÈÄâÂÅ∂Êï∞‰∏™ÔºåÂÜç‰ªéÂè¶Â§ñ‰ªªÊÑè‰∏™‰∏≠ÈÄâ‰ªªÊÑè‰∏™ÔºåÂæóÂà∞ÊüøÂ≠ê  
 <img src="https://latex.codecogs.com/svg.image?\inline&space;\sum\limits_{i=0}^{\frac&space;n2\times2}(\binom{n}{i}\times2^{i-1}\times2^{n-i})" title="\inline \sum\limits_{i=0}^{\frac n2\times2}(\binom{n}{i}\times2^{i-1}\times2^{n-i})" />   
Ê≥®ÊÑèÂú®  <img src="https://latex.codecogs.com/svg.image?\inline&space;i=0" title="\inline i=0" />  Êó∂  <img src="https://latex.codecogs.com/svg.image?\inline&space;2^{i-1}" title="\inline 2^{i-1}" />  ÂèØËÉΩ‰ºöÂá∫ÈîôÔºåÊâÄ‰ª•ÊãøÂá∫Êù•  
 <img src="https://latex.codecogs.com/svg.image?\inline&space;\begin{aligned}&\sum\limits_{i=0}^{\frac&space;n2\times2}(\binom{n}{i}\times2^{i-1}\times2^{n-i})\\=&\sum\limits_{i=2}^{\frac&space;n2\times2}(\binom{n}{i}\times2^{i-1}\times2^{n-i})+2^n\\=&2^{n-1}\sum\limits_{i=2}^{\frac&space;n2\times2}\binom{n}{i}+2^n\\=&2^{n-1}\times(2^{n-1}-1)+2^n\end{aligned}" title="\inline \begin{aligned}&\sum\limits_{i=0}^{\frac n2\times2}(\binom{n}{i}\times2^{i-1}\times2^{n-i})\\=&\sum\limits_{i=2}^{\frac n2\times2}(\binom{n}{i}\times2^{i-1}\times2^{n-i})+2^n\\=&2^{n-1}\sum\limits_{i=2}^{\frac n2\times2}\binom{n}{i}+2^n\\=&2^{n-1}\times(2^{n-1}-1)+2^n\end{aligned}" />   
  
Êàë‰ª¨Ëß£Ëøô‰∏™ÊüøÂ≠êÂ∞±Ë°å‰∫Ü  

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >

```cpp
const int mod = 10007;

inline ll ksm ( ll a, ll b ) {
        ll res = 1;
        while ( b ) {
                if ( b & 1 ) res = res * a % mod;
                a = a * a % mod;
                b >>= 1;
        }
        return res;
}

int main () {
        int cass; cin >> cass; while ( cass -- ) {
               ll n; cin >> n;
               ll two_mi = ksm(2, n - 1);
               cout << (two_mi * (two_mi - 1) % mod + two_mi * 2 % mod) % mod << endl;
        }
}
```

<hr>

## ÁîüÊàêÂáΩÊï∞

### Ê¥õË∞∑P6078_Sweets

#### üîó
<a href="https://www.luogu.com.cn/problem/P6078"><img src="https://i.loli.net/2021/11/25/WNiCvjUeZGQRs69.png"></a>

#### üí°
ÂÖàÊ†πÊçÆÈ¢òÁõÆÊûÑÂª∫ÁîüÊàêÂáΩÊï∞  
 <img src="https://latex.codecogs.com/svg.image?\inline&space;i:1+x+x^2+...+x^{m_i}" title="\inline i:1+x+x^2+...+x^{m_i}" />   
Â∞ÜÁîüÊàêÂáΩÊï∞‰πòËµ∑Êù•  <img src="https://latex.codecogs.com/svg.image?\inline&space;\prod\limits_{i=1}^n\frac{1-x^{m_i+1}}{1-x}=\frac{\prod\limits_{i=1}^n(1-x(m_i+1))}{(1-x)^n}" title="\inline \prod\limits_{i=1}^n\frac{1-x^{m_i+1}}{1-x}=\frac{\prod\limits_{i=1}^n(1-x(m_i+1))}{(1-x)^n}" />   
‰∏äÈù¢ÁöÑÂèØ‰ª•ÂèòÊàê‰∏Ä‰∏™Â§öÈ°πÂºè  <img src="https://latex.codecogs.com/svg.image?\inline&space;g(x)" title="\inline g(x)" />   
Áúã‰∏ãÈù¢ÁöÑ   
 <img src="https://latex.codecogs.com/svg.image?\inline&space;\begin{aligned}&=(1-x)^{-n}\\&=\sum\limits_{i\ge0}\binom{-n}i(-x)^i\\&=\sum\limits_{i\ge0}\frac{(-n)\times...\times(-n-i+1)}{i!}(-x)^i\\&=\sum\limits_{i\ge0}\frac{n\times...\times(n+i-1)}{i!}x^i\\&=\sum\limits_{i\ge0}\binom{n+i-1}ix^i\end{aligned}" title="\inline \begin{aligned}=(1-x)^{-n}\\=\sum\limits_{i\ge0}\binom{-n}i(-x)^i\\=\sum\limits_{i\ge0}\frac{(-n)\times...\times(-n-i+1)}{i!}(-x)^i\\=\sum\limits_{i\ge0}\frac{n\times...\times(n+i-1)}{i!}x^i\\=\sum\limits_{i\ge0}\binom{n+i-1}ix^i\end{aligned}" />   
ÂêàÂπ∂Ëµ∑Êù•ÂæóÂà∞  <img src="https://latex.codecogs.com/svg.image?\inline&space;g(x)\sum\limits_{i\ge0}\binom{n+i-1}ix^i" title="\inline g(x)\sum\limits_{i\ge0}\binom{n+i-1}ix^i" />   
  
ÂØπ‰∫é  <img src="https://latex.codecogs.com/svg.image?\inline&space;x^k" title="\inline x^k" />  Ëøô‰∏ÄÈ°πÔºöÔºàÁ≥ªÊï∞ËÆæÁΩÆ‰∏∫  <img src="https://latex.codecogs.com/svg.image?\inline&space;\alpha" title="\inline \alpha" />  )  <img src="https://latex.codecogs.com/svg.image?\inline&space;\alpha&space;x^k\sum\limits_{l\le&space;i+1\le&space;r}\binom{n+i-1}{i}x^i" title="\inline \alpha x^k\sum\limits_{l\le i+1\le r}\binom{n+i-1}{i}x^i" />   
ÈÇ£‰πàËøô‰∏ÄÈ°πË¥°ÁåÆ‰∏∫  <img src="https://latex.codecogs.com/svg.image?\inline&space;\alpha\sum\limits_{i=l-k}^{r-k}\binom{n+i-1}{i}" title="\inline \alpha\sum\limits_{i=l-k}^{r-k}\binom{n+i-1}{i}" />   
Áî±  <img src="https://latex.codecogs.com/svg.image?\inline&space;\binom{n}{m}=\binom{n}{m-1}+\binom{n-1}{m-1}" title="\inline \binom{n}{m}=\binom{n}{m-1}+\binom{n-1}{m-1}" />  ÂèØÂ∞Ü  <img src="https://latex.codecogs.com/svg.image?\inline&space;\sum\limits_{i=l-k}^{r-k}\binom{n+i-1}{i}" title="\inline \sum\limits_{i=l-k}^{r-k}\binom{n+i-1}{i}" />  ÂåñÊàê  <img src="https://latex.codecogs.com/svg.image?\inline&space;\binom{r-k+n}{r-k}-\binom{l-k+n-1}{l-k-1}" title="\inline \binom{r-k+n}{r-k}-\binom{l-k+n-1}{l-k-1}" />   
Âç≥  <img src="https://latex.codecogs.com/svg.image?\inline&space;\alpha(\binom{r+k-n}{r-k}-\binom{l-k+n-1}{l-k-1})" title="\inline \alpha(\binom{r+k-n}{r-k}-\binom{l-k+n-1}{l-k-1})" />   

ÈÇ£‰πàÁ≠îÊ°à‰∏∫  <img src="https://latex.codecogs.com/svg.image?\inline&space;\sum\limits_{i=1}^{SZ_g}\alpha_i(\binom{r+k_i-n}{r-k_i}-\binom{l-k_i+n-1}{l-k_i-1})" title="\inline \sum\limits_{i=1}^{SZ_g}\alpha_i(\binom{r+k_i-n}{r-k_i}-\binom{l-k_i+n-1}{l-k_i-1})" />   

ÂØπ‰∫éÂèñÊ®°ÔºåËßÇÂØü  <img src="https://latex.codecogs.com/svg.image?\inline&space;\binom{x+n}{x}=\frac{(n+1)\times...\times(n+x)}{n!}" title="\inline \binom{x+n}{x}=\frac{(n+1)\times...\times(n+x)}{n!}" />   
Â∞Ü  <img src="https://latex.codecogs.com/svg.image?\inline&space;mod+n!" title="\inline mod+n!" />  ÔºåÂèñÂÆåÊ®°ÊòØÊØî  <img src="https://latex.codecogs.com/svg.image?\inline&space;n!" title="\inline n!" />  Ë¶ÅÂ§ßÁöÑÔºåÈÇ£‰πàËøôÊó∂Â∞±ÂèØ‰ª•Áõ¥Êé•Èô§  <img src="https://latex.codecogs.com/svg.image?\inline&space;n!" title="\inline n!" />  ‰∫Ü  

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >

```cpp
int n, a, b;
int m[15];
map<int, int> g_mps;
vector<pair<int, int> > g; // first: ÊåáÊï∞Ôºåsecond: Á≥ªÊï∞

const int mod = 2004;
ll MOD = mod;
ll fac = 1;
inline int C ( int n, int m ) {
        if ( n < m ) return 0;
        ll res = 1;
        for ( int i = n - m + 1; i <= n; i ++ ) res = res * i % MOD;
        return res / fac % mod;
}

int main () {
        cin >> n >> a >> b;
        for ( ll i = 1; i <= n; i ++ ) fac *= i;
        MOD *= fac;

        g_mps[0] = 1;
        for ( int i = 0; i < n; i ++ ) {
                cin >> m[i];
                vector<pair<int, int> > tmps; 
                for ( auto g_mp : g_mps ) {
                        tmps.push_back({g_mp.first, g_mp.second});
                        tmps.push_back({g_mp.first + m[i] + 1, -g_mp.second});
                }
                g_mps.clear();
                for ( auto tmp : tmps ) {
                        g_mps[tmp.first] += tmp.second;
                }
        }
        for ( auto g_mp : g_mps ) g.push_back({g_mp.first, g_mp.second});

        ll res = 0;
        for ( auto i : g ) {
                int k = i.first;
                res = ((res + (ll)i.second * (C(n + b - k, n) - C(n + a - k - 1, n) + mod) % mod) % mod + mod) % mod;
        }
        cout << res << endl;
}
```

<hr>

### ÁâõÂÆ¢NC207746_ËÉåÂåÖ

#### üîó
<a href="https://ac.nowcoder.com/acm/contest/24710/A"><img src="https://i.loli.net/2021/11/24/KcP56J1EIiOuRFf.png"></a>

#### üí°
Êàë‰ª¨ÂØπÊØè‰∏Ä‰∏™Áâ©ÂìÅ‰∏Ä‰∏™ÁîüÊàêÂáΩÊï∞Â§öÈ°πÂºèÔºåÂêåÊó∂Ê†πÊçÆ‰∏ãÈù¢Ëøô‰∏™ÁªìËÆ∫Â∞Ü‰ªñ‰ª¨ÂåñÁÆÄ     
>ÂØπ‰∫éÁ≠âÊØî  <img src="https://latex.codecogs.com/svg.image?\inline&space;(x)" title="\inline (x)" />  Êï∞ÂàóÊ±ÇÂíåÂÖ¨ÂºèÔºö  <img src="https://latex.codecogs.com/svg.image?\inline&space;\frac{a_0(1-x^n)}{1-x}" title="\inline \frac{a_0(1-x^n)}{1-x}" />   
>Â¶ÇÊûú   <img src="https://latex.codecogs.com/svg.image?\inline&space;(0<x<1)" title="\inline (1\lt&space;x\lt y)" />  
>ÈÇ£‰πà  <img src="https://latex.codecogs.com/svg.image?\inline&space;1-x^n\approx1" title="\inline 1-x^n\approx1" />   
>ÊâÄ‰ª•  <img src="https://latex.codecogs.com/svg.image?\inline&space;\frac{a_0(1-x^n)}{1-x}\approx\frac1{x-1}" title="\inline \frac{a_0(1-x^n)}{1-x}\approx\frac1{x-1}" /> 

 <img src="https://latex.codecogs.com/svg.image?\inline&space;\begin{aligned}(1)&1+x&1+x\\(2)&1+x+x^2&\frac{1-x^3}{1-x}\\(3)&1+x+x^2+x^3&\frac{1-x^4}{1-x}\\(4)&1+x^2+x^4+...&\frac{1}{1-x^2}\\(5)&x+x^3+x^5+...&\frac{x}{1-x^2}\\(6)&1+x^4+x^8+...&\frac{1}{1-x^4}\\(7)&1+x&1+x\\(8)&x+x^3+x^6+...&\frac1{1-x^3}\end{aligned}" title="\inline \begin{aligned}(1)&1+x&1+x\\(2)&1+x+x^2&\frac{1-x^3}{1-x}\\(3)&1+x+x^2+x^3&\frac{1-x^4}{1-x}\\(4)&1+x^2+x^4+...&\frac{1}{1-x^2}\\(5)&x+x^3+x^5+...&\frac{x}{1-x^2}\\(6)&1+x^4+x^8+...&\frac{1}{1-x^4}\\(7)&1+x&1+x\\(8)&x+x^3+x^6+...&\frac1{1-x^3}\end{aligned}" />    

ÂØπÂêéÈù¢ÁöÑÊ±ÇÂíåÂπ∂ÂåñÁÆÄÂæóÂà∞  <img src="https://latex.codecogs.com/svg.image?\inline&space;g(x)=\frac{x}{(1-x)^4}" title="\inline g(x)=\frac{x}{(1-x)^4}" />   
Â±ïÂºÄÂæó  <img src="https://latex.codecogs.com/svg.image?\inline&space;g(x)=x\times&space;(\frac1{1-x})^4=x(1+x+x^2+x^3+...+x^n)^4" title="\inline g(x)=x\times (\frac1{1-x})^4=x(1+x+x^2+x^3+...+x^n)^4" />   
Ê†πÊçÆ‰∫åÈ°πÂºèÂÆöÁêÜÂæóÂà∞ÊúÄÂêé  <img src="https://latex.codecogs.com/svg.image?\inline&space;x^n" title="\inline x^n" />  ÁöÑÁ≥ªÊï∞‰æøÊòØ  <img src="https://latex.codecogs.com/svg.image?\inline&space;\binom{n+2}{n-1}" title="\inline \binom{n+2}{n-1}" />   
   
ÈÇ£‰πàÂ∞±Áõ¥Êé•Ê±Ç  <img src="https://latex.codecogs.com/svg.image?\inline&space;\frac{n\times(n+1)\times(n+2)}{1\times2\times3}" title="\inline \frac{n\times(n+1)\times(n+2)}{1\times2\times3}" />   


#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >

```cpp
const int mod = 1e9 + 7;
inline ll ksm ( ll a, ll b ) {
        ll res = 1;
        while ( b ) {
                if ( b & 1 ) res = res * a % mod;
                a = a * a % mod;
                b >>= 1;
        }
        return res;
}
inline ll inv ( ll x ) {
        return ksm ( x, mod - 2 );
}

int main () {
        ll n; cin >> n;
        ll a = n % mod, b = (n + 1) % mod, c = (n + 2) % mod;
        ll d = inv(6);
        cout << a * b % mod * c % mod * d % mod << endl;
}
```

<hr>

### HDUOJ1521_ÊéíÂàóÁªÑÂêà

#### üîó
http://acm.hdu.edu.cn/showproblem.php?pid=1521

#### üí°


#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >  
  

```cpp
#include <algorithm>
#include <iostream>
#include <cstring>
#include <string>
#include <vector>
#include <cstdio>
#include <stack>
#include <queue>
#include <cmath>
#include <map>
#include <set>
#define G 10.0
#define LNF 1e18
#define eps 1e-6
#define ll long long
#define INF 0x7FFFFFFF
#define Chivas int main()
#define Regal return 0
#define PI acos(-1.0)
#define pb(x) push_back(x)
#define SP system("pause")
#define mm(a, b) memset(a, b, sizeof(a))
#define fir(i, a, n) for (ll i = a; i <= n; i++)
#define rif(i, a, n) for (ll i = a; i >= n; i--)
#define each_cass(cass) for (scanf("%d", &cass); cass; cass--)

using namespace std;

const int maxn = 15;
double c1[maxn], c2[maxn];
ll num[maxn];
ll F[maxn];
ll n, m;

void Factorial(){
    F[0] = 1;
    for (int i = 1; i < maxn; i++)
        F[i] = F[i - 1] * i;
}

void init(){
    mm(c1, 0);
    mm(c2, 0);
    for (int i = 0; i <= num[1]; i++)
        c1[i] = 1.0 / F[i];
}

Chivas{
    Factorial();
    while (scanf("%lld%lld", &n, &m) == 2){
        for (int i = 1; i <= n; i++)
            scanf("%lld", &num[i]);
        init();
        for (int i = 2; i <= n; i++){
            for (int j = 0; j <= m; j++){
                for (int k = 0; k + j <= m && k <= num[i]; k++)
                    c2[j + k] += c1[j] / F[k];
            }
            for (int j = 0; j <= m; j++)
                c1[j] = c2[j], c2[j] = 0;
        }
        printf("%.0f\n", c1[m] * F[m]);
    }
    Regal;
}
```

<hr>

### HDUOJ1028_IgnatiusAndThePrincess3

#### üîó
http://acm.hdu.edu.cn/showproblem.php?pid=1028

#### üí°


#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >  
  

```cpp
#include <algorithm>
#include <iostream>
#include <cstring>
#include <string>
#include <vector>
#include <cstdio>
#include <stack>
#include <queue>
#include <cmath>
#include <map>
#include <set>
#define G 10.0
#define LNF 1e18
#define eps 1e-6
#define ll long long
#define INF 0x7FFFFFFF
#define PI acos(-1.0)
#define pb(x) push_back(x)
#define SP system("pause")
#define mm(a, b) memset(a, b, sizeof(a))
#define fir(i, a, n) for (int i = a; i <= n; i++)
#define rif(i, a, n) for (int i = a; i >= n; i--)
#define each_cass(cass) for (cin >> cass; cass; cass--)

using namespace std;

const int maxn = 200;
int c1[maxn];
int c2[maxn];

void init(){
    for (int i = 0; i < maxn; i++)
        c1[i] = 1, c2[i] = 0;
}

int main(){
    int n;
    while(cin>>n){
        init();
        for (int i = 2; i <= n; i++){//n-1Ê¨°ÂêàÂπ∂
            for (int j = 0; j <= n; j++)//Á¨¨‰∏Ä‰∏™Êã¨Âè∑
                for (int k = 0; k + j <= n; k += i)//Á¨¨‰∫å‰∏™Êã¨Âè∑
                    c2[j + k] += c1[j];
            for (int j = 0; j <= n; j++)//ÊõøÊç¢
                c1[j] = c2[j], c2[j] = 0;
        }
        cout << c1[n] << endl;
    }
    return 0;
}
```

<hr>

### HDUOJ1085_HoldingBin-LadenCaptive

#### üîó
http://acm.hdu.edu.cn/showproblem.php?pid=1085

#### üí°


#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >  
  

```cpp
#include <algorithm>
#include <iostream>
#include <cstring>
#include <string>
#include <vector>
#include <cstdio>
#include <stack>
#include <queue>
#include <cmath>
#include <map>
#include <set>
#define G 10.0
#define LNF 1e18
#define eps 1e-6
#define ll long long
#define INF 0x7FFFFFFF
#define PI acos(-1.0)
#define pb(x) push_back(x)
#define SP system("pause")
#define mm(a, b) memset(a, b, sizeof(a))
#define fir(i, a, n) for (ll i = a; i <= n; i++)
#define rif(i, a, n) for (ll i = a; i >= n; i--)
#define each_cass(cass) for (scanf("%d", &cass); cass; cass--)

using namespace std;

const int maxn = 100010;
int kind[4] = {0, 1, 2, 5};
int c1[maxn];
int c2[maxn];
int num[4];
int sum;

void init(){
    mm(c1, 0);
    mm(c2, 0);
    for (int i = 0; i <= sum; i++)
        c1[i] = 1, c2[i] = 0;
}

int main(){
    while (scanf("%d%d%d", &num[1], &num[2], &num[3]) == 3, num[1] || num[2] || num[3]){
        sum = num[1];
        init();
        for (int i = 2; i <= 3; i++){
            for (int j = 0; j <= sum; j++)
                for (int k = 0; k <= num[i] * kind[i]; k += kind[i])
                    c2[j + k] += c1[j];
            sum += num[i] * kind[i];
            for (int j = 0; j <= sum; j++)
                c1[j] = c2[j], c2[j] = 0;
        }
        for (int i = 0; i <= sum + 1; i++){
            if(!c1[i]){
                printf("%d\n", i);
                break;
            }
        }
    }
    return 0;
}

```

<hr>

### HDUOJ1398_SquareCoins

#### üîó
http://acm.hdu.edu.cn/showproblem.php?pid=1398

#### üí°


#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >  
  

```cpp
#include <algorithm>
#include <iostream>
#include <cstring>
#include <string>
#include <vector>
#include <cstdio>
#include <stack>
#include <queue>
#include <cmath>
#include <map>
#include <set>
#define G 10.0
#define LNF 1e18
#define eps 1e-6
#define ll long long
#define INF 0x7FFFFFFF
#define PI acos(-1.0)
#define pb(x) push_back(x)
#define SP system("pause")
#define mm(a, b) memset(a, b, sizeof(a))
#define each_cass(cass) for (cin >> cass; cass; cass--)

using namespace std;

const ll maxn = 1000;
ll c1[maxn];
ll c2[maxn];
ll a[1000];

void init(){
    for (ll i = 0; i < maxn; i++)
        c1[i] = 1, c2[i] = 0;
    for (ll i = 0; i < 1000; i++)
        a[i] = i * i;
}

int main(){
    ll n;
    while(scanf("%d",&n)==1,n){
        init();
        for (ll i = 2; i <= n; i++){
            for (ll j = 0; j <= n; j++)
                for (ll k = 0; k + j <= n; k += a[i])
                    c2[k + j] += c1[j];
            for (ll j = 0; j <= n; j++)
                c1[j] = c2[j], c2[j] = 0;
        }
        printf("%d\n", c1[n]);
    }
    return 0;
}

```

<hr>

### HDUOJ1709_TheBalance

#### üîó
http://acm.hdu.edu.cn/showproblem.php?pid=1709

#### üí°


#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >  
  

```cpp
#include <algorithm>
#include <iostream>
#include <cstring>
#include <string>
#include <vector>
#include <cstdio>
#include <stack>
#include <queue>
#include <cmath>
#include <map>
#include <set>
#define G 10.0
#define LNF 1e18
#define eps 1e-6
#define ll long long
#define INF 0x7FFFFFFF
#define PI acos(-1.0)
#define pb(x) push_back(x)
#define SP system("pause")
#define mm(a, b) memset(a, b, sizeof(a))
#define fir(i, a, n) for (ll i = a; i <= n; i++)
#define rif(i, a, n) for (ll i = a; i >= n; i--)
#define each_cass(cass) for (scanf("%d", &cass); cass; cass--)

using namespace std;

const int maxn = 100005;
int n;
int A[110];
int c1[maxn];
int c2[maxn];

void init(){
    mm(c1, 0);
    mm(c2, 0);
    c1[0] = c1[A[1]] = 1;
}

main(){
    while (scanf("%d", &n) == 1){
        int sum = 0;
        for (int i = 1; i <= n; i++)
            scanf("%d", &A[i]), sum += A[i];
        init();
        for (int i = 2; i <= n; i++){
            for (int j = 0; j <= sum; j++){
                for (int k = 0; k + j <= sum && k <= A[i]; k += A[i])
                    c2[abs(k - j)] += c1[j], c2[k + j] += c1[j];
            }
            for (int j = 0; j <= sum; j++)
                c1[j] = c2[j], c2[j] = 0;
        }

        vector<int> ans;
        for (int i = 0; i <= sum; i++){
            if(!c1[i]){
                ans.push_back(i);
            }
        }
        printf("%lu\n", ans.size());
        for (int i = 0; i < ans.size(); i++)
            printf("%d%c", ans[i], i == ans.size() - 1 ? '\n' : ' ');
    }
        return 0;
}

```

<hr>

### HDUOJ2152_Fruit

#### üîó
http://acm.hdu.edu.cn/showproblem.php?pid=2152

#### üí°


#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >  
  

```cpp
#include <algorithm>
#include <iostream>
#include <cstring>
#include <string>
#include <vector>
#include <cstdio>
#include <stack>
#include <queue>
#include <cmath>
#include <map>
#include <set>
#define G 10.0
#define LNF 1e18
#define eps 1e-6
#define ll long long
#define INF 0x7FFFFFFF
#define Chivas int main()
#define Regal return 0
#define PI acos(-1.0)
#define pb(x) push_back(x)
#define SP system("pause")
#define mm(a, b) memset(a, b, sizeof(a))
#define fir(i, a, n) for (ll i = a; i <= n; i++)
#define rif(i, a, n) for (ll i = a; i >= n; i--)
#define each_cass(cass) for (scanf("%d", &cass); cass; cass--)

using namespace std;

const ll maxn = 1e4 + 10;
ll n, m;
struct fruit{
    ll a;
    ll b;
    void read(){
        scanf("%lld%lld", &a, &b);
    }
} f[110];
ll c1[maxn];
ll c2[maxn];

void init(){
    mm(c1, 0);
    mm(c2, 0);
    for (ll i = f[1].a; i <= f[1].b; i++)
        c1[i] = 1;
}

Chivas{
    while (scanf("%lld%lld", &n, &m) == 2){
        for (ll i = 1; i <= n; i++)
            f[i].read();
        init();
        for (ll i = 2; i <= n; i++){
            for (ll j = 0; j <= m; j++){
                for (ll k = f[i].a; k + j <= m && k <= f[i].b; k++)
                    c2[j + k] += c1[j];
            }
            for (ll j = 0; j <= m; j++)
                c1[j] = c2[j], c2[j] = 0;
        }
        printf("%lld\n", c1[m]);
    }
    Regal;
}

```

<hr>

## ÂÆπÊñ•ÂéüÁêÜ

### Ê¥õË∞∑P1450_Á°¨Â∏ÅË¥≠Áâ©

#### üîó
<a href="https://www.luogu.com.cn/problem/P1450"><img src="https://i.loli.net/2021/11/10/27LQvBmkElueGT6.png"></a>

#### üí°
Êú¨È¢òÂ∞ùËØïÁîüÊàêÂáΩÊï∞  <img src="https://latex.codecogs.com/svg.image?\inline&space;10" title="\inline 10" /> ÂàÜÔºå  <img src="https://latex.codecogs.com/svg.image?\inline&space;FFT" title="\inline FFT" /> ‰ºòÂåñËøòÊòØ  <img src="https://latex.codecogs.com/svg.image?\inline&space;10" title="\inline 10" /> ÂàÜ...  
  
Áúã‰∫ÜÁúºÊó∂Èó¥ÔºåÂºÄÂßãËÄÅËÄÅÂÆûÂÆûÊÉ≥ËÉåÂåÖ   
Ôºà‰∏ç‰ºöÂêß  <img src="https://latex.codecogs.com/svg.image?\inline&space;O(n)" title="\inline O(n)" /> ÊòØÊûÅÈôêËÄå‰∏î‰∏ç‰∏ÄÂÆöËøáÔºü  
  
ÊèêÂâçÁªôÂÆöÁöÑ  <img src="https://latex.codecogs.com/svg.image?\inline&space;c[0...4]" title="\inline c[0...4]" /> ‰∏ÄÂÆöÊúâÂÖ∂Áî®ÊÑèÔºåÂÖàÊãøÂÆåÂÖ®ËÉåÂåÖÈ¢ÑÂ§ÑÁêÜ‰∏Ä‰∏ã  <img src="https://latex.codecogs.com/svg.image?\inline&space;dp" title="\inline dp" />  Êï∞ÁªÑ  
‰ΩÜÊòØËÆ©Â§öÈáçËÉåÂåÖÔºåÊàë‰ª¨Â∞±ÂÆπÊñ•ÂáèÊéâ‰∏çÂêàÊ≥ïÁöÑ  
ÂÅáËÆæÊàë‰ª¨Êûö‰∏æÁ¨¨  <img src="https://latex.codecogs.com/svg.image?\inline&space;i" title="\inline i" /> ‰∏™ÔºåÊ≠§Êó∂Êàë‰ª¨Â¶ÇÊûúÈ¢ÑÂÖàÊãøËµ∞  <img src="https://latex.codecogs.com/svg.image?\inline&space;d[i]+1" title="\inline d[i]+1" /> ‰∏™ÔºåÈÇ£‰πà‰πãÂêéÁöÑ‰ªªÊÑèÈÄâÊã©ÊñπÂºèÈÉΩÊòØ‰∏çÂêàÊ≥ïÁöÑ  
Ê≠§Êó∂‰∏çÂêàÊ≥ïÁöÑ‰πüÂ∞±ÊòØÂÆπÁßØ  <img src="https://latex.codecogs.com/svg.image?\inline&space;n-c[i]\times&space;(d[i]+1)" title="\inline n-c[i]\times&space;(d[i]+1)" /> ÁöÑËÉåÂåÖÔºåÊàë‰ª¨ÂáèÂéª  <img src="https://latex.codecogs.com/svg.image?\inline&space;dp[n-c[i]*(d[i]+1)]" title="\inline dp[n-c[i]*(d[i]+1)]" />   
ÂΩìÁÑ∂Âõ†‰∏∫ÊòØÂÆπÊñ•ÔºåÊâÄ‰ª•Êàë‰ª¨ËøòË¶ÅÂä†ÂõûÊù•ÊèêÂâç‰∏§‰∏™‰∏çÂêàÊ≥ïÔºåÂáèÊéâÊèêÂâç‰∏â‰∏™‰∏çÂêàÊ≥ï...   
  
‰∫åËøõÂà∂Êûö‰∏æÔºåËßÇÂØüÊó∂Èó¥Â§çÊùÇÁöÑÔºå  <img src="https://latex.codecogs.com/svg.image?\inline&space;T*2^4" title="\inline T*2^4" /> ÂæàÊ≠£Â∏∏ÁöÑÊó∂Èó¥    
  
Â•ΩÂÆ∂‰ºôÔºåÂÆπÊñ•ÊîπÂÆåÂÖ®ËÉåÂåÖ‰∏∫Â§öÈáçËÉåÂåÖ...

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >

```cpp
#include <iostream>

#define ll long long

using namespace std;

const int N = 1e5 + 10;
int c[N], d[N], n;
ll dp[N];

inline void Solve () {
        for ( int i = 0; i < 4; i ++ ) cin >> d[i];
        cin >> n;
        ll res = dp[n];
        for ( int i = 0; i < (1 << 4); i ++ ) { // Êûö‰∏æÊèêÂâçÈÄâÂì™‰∫õÁâ©ÂìÅË∂ÖËøáÈôêÂà∂
                int cnt = 0; ll cur = 0;
                for ( int j = 0; j < 4; j ++ ) {
                        if ( i & (1 << j) ) {
                                cnt ++;
                                cur += (ll)c[j] * (d[j] + 1);
                        }
                }
                if ( cur > n || cur == 0 ) continue; // n‰ª•‰∏ãÊ≤°Êúâ‰∏çÂêàÊ≥ïËß£ ÊàñËÄÖ ÂÖ®ÈÉΩ‰∏çÈÄâ‰∏çÊûÑÊàêËß£‰πü‰∏çÊûÑÊàê‰∏çÂêàÊ≥ïËß£
                if ( cnt & 1 ) res -= dp[n - cur];
                else           res += dp[n - cur];
        }
        cout << res << endl;
}

int main () {
        for ( int i = 0; i < 4; i ++ ) cin >> c[i]; 
        dp[0] = 1; for ( int i = 0; i < 4; i ++ ) for ( int j = c[i]; j < N; j ++ ) dp[j] += dp[j - c[i]]; 

        int cass; cin >> cass; while ( cass -- ) {
                Solve ();
        }
}
```

<hr>

### Ê¥õË∞∑P3166_Êï∞‰∏âËßíÂΩ¢

#### üîó
<a href="https://www.luogu.com.cn/problem/P3166">![20220706185721](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220706185721.png)</a>

#### üí°
È¢òÁõÆÂÖàËØ¥ÁöÑÂÖ®ÈÉ®ÔºåÁÑ∂ÂêéÁªô‰∫ÜÈôêÂà∂ÔºåÊåâÁùÄÂÆÉÁöÑÈ°∫Â∫èÊÉ≥Â∞±ÊòØÁî®ÂÆπÊñ•„ÄÇ  
Êú¨È¢òÊòØÊ†ºÁÇπÔºåÊàë‰ª¨Â∞Ü $n,m$ ÈÉΩ $+1$ ‰ºöÊõ¥Â•ΩÁúã   
È¶ñÂÖàÊâÄÊúâÁöÑÁÇπ‰∏∫Ôºö$C_{nm}^3$  
ÂáèÂéªÂú®Âêå‰∏ÄÊù°Á∫ø‰∏äÁöÑÊÉÖÂÜµÔºö  
<b>$1.$ ‰∏éÂùêÊ†áËΩ¥Âπ≥Ë°åÔºö</b>  
$nC_m^3+mC_n^3$  
<b>$2.$ ‰∏éÂùêÊ†áËΩ¥‰∏çÂπ≥Ë°åÔºö</b>  
Ê≥®ÊÑè $1\le N,M\le1000$ ÔºåÂèØ‰ª• $O(nm)$ ÂÜô  
Êûö‰∏æ‰∏§‰∏™ÁÇπÁöÑÁ∫µÂùêÊ†áÂ∑Æ $i$ ‰∏éÊ®™ÂùêÊ†áÂ∑Æ $j$ ÔºåÂØπ‰∫é‰∏ÄÂØπÁÇπÊòØÂΩ¢Êàê‰∏Ä‰∏™ $i\times j$ ÁöÑÁü©ÂΩ¢   
Ëøô‰∏™Áü©ÂΩ¢ÂØπËßíÁ∫ø‰∏äÈô§‰∫ÜÈ°∂ÁÇπ‰πãÂ§ñÁöÑÁÇπ‰∏ÄÂÖ±Êúâ $gcd(i,j)-1$ ‰∏™  
::: tip ËØÅÊòé  
‰ª§ $d=gcd(i,j)$ ÔºåÂàô‰∏çÁªèËøá‰ªª‰Ωï‰∏Ä‰∏™ÁÇπÁöÑÂùêÊ†áÂ∑ÆÂ∫î‰∏∫ $(\frac{i}{d},\frac{j}{d})$ ÔºåËøô‰∏™ÁÇπ‰∏ÄÂÖ±Êúâ $d$ ‰∏™ÂÄçÊï∞ÔºåÂåÖÂê´‰∫Ü‰∏Ä‰∏™È°∂ÁÇπÔºåÂ∫îÂáèÂéª‰∏∫ $d-1$    
:::  
‰∏Ä‰∏™Áü©ÂΩ¢Êúâ‰∏§‰∏™ÂØπËßíÁ∫øÔºåÂ∫î‰πò $2$   
$n\times m$ ÁöÑÁü©ÂΩ¢Êúâ $(n-i)(m-j)$ ‰∏™ËøôÊ†∑ÁöÑÂ∞èÁü©ÂΩ¢Ôºå‰πò‰∏ä‰∏™Êï∞  
ÂàôËøô‰∏ÄÊù°Â∫îÂáèÂéª $2\sum\limits_{i=1}^{n-1}\sum\limits_{j=1}^{m-1}(n-i)(m-j)(gcd(i,j)-1)$  

ÂàôÁ≠îÊ°à‰∏∫Ôºö  
$$C_{nm}^3-nC_m^3-mC_n^3-2\sum\limits_{i=1}^{n-1}\sum\limits_{j=1}^{m-1}(n-i)(m-j)(gcd(i,j)-1)$$ 

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
inline ll gcd (ll a, ll b) { return b ? gcd(b, a % b) : a; }
int main () {
        ios::sync_with_stdio(false);
        cin.tie(nullptr);

        ll n, m; cin >> n >> m;
        n ++, m ++;

        ll res = n * m * (n * m - 1) * (n * m - 2) / 6;
        
        res -= m * n * (n - 1) * (n - 2) / 6;
        res -= n * m * (m - 1) * (m - 2) / 6;
        for (ll i = 1; i < n; i ++) {
                for (ll j = 1; j < m; j ++) {
                        res -= 2ll * (gcd(i, j) - 1) * (n - i) * (m - j);
                }
        }

        cout << res << endl;
}
```
<hr>

### ÁâõÂÆ¢2021Â§öÊ†°(2)J_CountingTriangles

#### üîó
<a href="https://ac.nowcoder.com/acm/contest/11254/J">![20220919183903](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220919183903.png)</a>

#### üí°
ÂæàÂ¶ôÁöÑÈ¢ò  
Ë¶ÅÂæóÂà∞ÂêåËâ≤Ëæπ‰∏âËßíÂΩ¢ÔºåÂè™ËÉΩÊûö‰∏æÔºå‰∏îÊûö‰∏æ‰∏§‰∏™ÁÇπËøò‰∏çÂ§üÔºåËøòË¶ÅÂéªÊ£ÄÊü•Á¨¨‰∏â‰∏™ÁÇπÊòØÂê¶ÂêàÊ≥ï  
Ê≠£ÈöæÂàôÂèçÔºå‰ªé‰∏Ä‰∏™ÁÇπÂá∫Âèë‰∏çÂêåËâ≤ÁöÑ‰∏§‰∏™ËæπÊòØÂèØ‰ª•Áõ¥Êé•ÁÆóÂá∫Êù•ÁöÑ  
Êûö‰∏æ $u$ ÔºåÊûö‰∏æ $u$ Âá∫ÂèëÁöÑËæπÔºå$cnt[i]$ ‰∏∫È¢úËâ≤‰∏∫ $i$ ÁöÑËæπÊï∞ÔºåÂàô $u$ Âá∫ÂèëÁöÑ‰∏çÂêåËâ≤Ëæπ‰∏∫ $cnt[0]\times cnt[1]$ ÔºåËøôÂ∞±ÊòØ‰∏§‰∏™ËæπÁ°ÆÂÆöÂá∫Êù•ÁöÑ‰∏âËßíÂΩ¢ ÔºåËÆ©Á≠îÊ°à $res$ Âä†‰∏ä    
ÊúÄÂêé‰ºöÊúâÈáçÂ§çÁöÑÔºåÈúÄË¶Å $res/2$   
ÊâÄÊúâÁöÑ‰∏âËßíÂΩ¢Êï∞Èáè‰∏∫‰ªé $n$ ‰∏™ÁÇπ‰∏≠ÈÄâ $3$ ‰∏™ÁÇπÔºåÈÇ£‰πàÂêåËâ≤Ëæπ‰∏âËßíÂΩ¢Êï∞‰∏∫ $C_n^3-res$ 

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
namespace GenHelper
{
    unsigned z1,z2,z3,z4,b,u;
    unsigned get()
    {
        b=((z1<<6)^z1)>>13;
        z1=((z1&4294967294U)<<18)^b;
        b=((z2<<2)^z2)>>27;
        z2=((z2&4294967288U)<<2)^b;
        b=((z3<<13)^z3)>>21;
        z3=((z3&4294967280U)<<7)^b;
        b=((z4<<3)^z4)>>12;
        z4=((z4&4294967168U)<<13)^b;
        return (z1^z2^z3^z4);
    }
    bool read() {
      while (!u) u = get();
      bool res = u & 1;
      u >>= 1; return res;
    }
    void srand(int x)
    {
        z1=x;
        z2=(~x)^0x233333333U;
        z3=x^0x1234598766U;
        z4=(~x)+51;
      	u = 0;
    }
}
using namespace GenHelper;

int e[8001][8001];

int main () {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);

    int n, seed; cin >> n >> seed;
    srand(seed);
    for (int i = 0; i < n; i ++) {
        for (int j = i + 1; j < n; j ++) e[i][j] = e[j][i] = read();
    }

    ll res = 0;
    for (int i = 0; i < n; i ++) {
        int num[2] = {0};
        for (int j = 0; j < n; j ++) {
            if (i != j) num[e[i][j]] ++;
        }
        res -= 1ll * num[0] * num[1];
    }
    res = res / 2 + 1ll * n * (n - 1ll) * (n - 2ll) / 6;

    cout << res << endl;
}
```
<hr>


### ÁâõÂÆ¢2022ÂØíÂÅáÁÆóÊ≥ïÂü∫Á°ÄÈõÜËÆ≠Ëê•K_Êô∫‰πÉÁöÑCËØ≠Ë®ÄÊ®°Èô§ÊñπÁ®ã

#### üîó
<a href="https://ac.nowcoder.com/acm/contest/23478/K"><img src="https://img-blog.csdnimg.cn/6d2ed77c2fe84b679c807b3bf69a7975.png"></a>

#### üí°
Êú¨È¢òÊòØËÆ©Êàë‰ª¨ËÆ°Êï∞  
ËÆ© $[l,r]$ ‰ª• $p$ ‰∏∫Âæ™ÁéØÂå∫Èó¥ËøõË°åÁßªÂä®ÔºåÁúãÂ§öÂ∞ë‰∏™Ê®°ÂêéÂ≠òÂú®‰∫é $[L,R]$ ‰∏≠  
È¶ñÂÖàËÇØÂÆöÊòØË¶ÅÁúãÈúÄ‰∏çÈúÄË¶Å‰ªé $0$ ÁöÑ‰ΩçÁΩÆÂàÜÂºÄËÆ°ÁÆóÁöÑ  

ÂØπ‰∫é $[L,R]$ ÈÉΩÂú®Âêå‰∏ÄËæπÁöÑÔºåÊàë‰ª¨ÂèØ‰ª•ÊÉ≥Âà∞Áî®ÂÆπÊñ•Ôºå $calc(R)-calc(L-1)$ ËøôÁßç  
ÈÇ£‰πà‰∏çÂú®‰∏ÄËæπÁöÑÊàë‰ª¨Ë¶ÅÂàÜÂºÄËÆ°ÁÆóÁÑ∂ÂêéÂä†Ëµ∑Êù•  

ÈÇ£‰πàÂ∞±Â∞ÜÂå∫Èó¥ÈóÆÈ¢òËΩ¨Âåñ‰∏∫ÂâçÁºÄÁöÑÁÇπÈóÆÈ¢ò‰∫Ü  
‰ªªÂä°ÊòØÊ±Ç‰ªé $x$ Âà∞ $0$ ÊúâÂ§öÂ∞ë‰∏™Êï∞Ê®°Âêé‰∏∫ $[l,r]$ Ôºå‰∏äÈù¢Âú®ÂèôËø∞ÈóÆÈ¢òÊó∂Â∑≤ÁªèÂæàÊòéÁôΩ‰∫ÜÔºåËøô‰∏™ËÆ°ÁÆóÂæ™ÁéØËäÇËøõË°å‰ºòÂåñ  
‰ª• $[0,p-1]$ ‰∏∫Âæ™ÁéØËäÇÔºåÊØè‰∏™Âæ™ÁéØËäÇÂÜÖËÆ°ÁÆó $[0,p-1]\cap[l,r]$ ÁöÑ‰∏™Êï∞ÔºåÁÑ∂ÂêéÂæ™ÁéØ $\left\lfloor\frac xp\right\rfloor$ Ê¨°  
Â§öÂá∫Êù•ÁöÑÂ∞±ÁÆó‰∏Ä‰∏ã $[0,x\%p]\cap[l,r]$ Âç≥ÂèØ  
  
Áõ∏‰∫§Âå∫Èó¥ÈïøÂ∫¶Êàë‰ª¨ÂÜô‰∏Ä‰∏™ÂáΩÊï∞ `get_intersection(a, b, c, d)` Êù•ËÆ°ÁÆó   
ÈÇ£‰πàÊàë‰ª¨ÂØπ‰∫éÂæ™ÁéØ `x / p` Ê¨°ÔºåÊØè‰∏™Âæ™ÁéØÊúâ `get_intersection(0, p - 1, l, r)` ‰∏™Áõ∏‰∫§ÔºåÂä†‰∏ä `get_intersection(0, x % p, l, r)` ËøôÊ†∑ÂéªÁÆó  
ËÆ∞ÂæóÂØπ `x` ÂàÜÂ•áÂÅ∂

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
ll P, l, r, L, R;

inline ll get_Intersection ( ll a, ll b, ll c, ll d ) {
        if ( c > b || d < a ) return 0;
        return min(b, d) - max(a, c) + 1;
}
inline ll Query ( ll bondry ) {
        if ( bondry < 0 ) 
                return (- bondry / P) * get_Intersection(- P + 1, 0, l, r) + get_Intersection(bondry % P, 0, l, r );
        else 
                return bondry / P * get_Intersection(0, P - 1, l, r) + get_Intersection(0, bondry % P, l, r);
}

int main () {
        ios::sync_with_stdio(false);

        cin >> P >> l >> r >> L >> R;
        P = llabs(P);
        if ( L <= 0 && R >= 0 ) 
                cout << Query(R) + Query(L) - Query(0) << endl; // ÂàÜÂºÄËÆ°ÁÆóÔºåÂ§öÁÆó‰∫Ü‰∏™ 0
        else if ( L < 0 && R < 0 )
                cout << Query(L) - Query(R + 1) << endl; // Ë¥üÊï∞ÂÆπÊñ•
        else 
                cout << Query(R) - Query(L - 1) << endl; // Ê≠£Êï∞ÂÆπÊñ•
}
```
<hr>


### ÁâõÂÆ¢ÁªÉ‰π†Ëµõ92C_D‰∏éC

#### üîó
<a href="https://ac.nowcoder.com/acm/contest/11182/C"><img src="https://i.loli.net/2021/11/27/Ne98jLhYZSQsnxz.png"></a>

#### üí°
ÁúüÂ∞±ÁúãËßÅËÆ°Êï∞ÊÉ≥ÂÆπÊñ•Âëó  
È¶ñÂÖàÂèØ‰ª•ÂæóÂà∞ÊÄªËæπÊï∞  <img src="https://latex.codecogs.com/svg.image?\inline&space;has\_edge" title="\inline has\_edge" />  ‰∏∫  <img src="https://latex.codecogs.com/svg.image?\inline&space;\frac{n\times&space;(n-1)}2" title="\inline \frac{n\times&space;(n-1)}2" />  
ÂØπ‰∫éËøô‰∫õËæπÊï∞ËÆ©‰∏§‰∫∫‰∏ÄËµ∑Êîæ‰∏ÄÂÖ±Êúâ  <img src="https://latex.codecogs.com/svg.image?\inline&space;\binom{has\_edge}{a}\times\binom{has\_edge}{b}" title="\inline \binom{}{}" /> ÁßçÊÉÖÂÜµÔºåËÆæ‰∏∫  <img src="https://latex.codecogs.com/svg.image?\inline&space;has\_situation" title="\inline has\_situation" />   

Â¶ÇÊûú  <img src="https://latex.codecogs.com/svg.image?\inline&space;a+b\ge&space;has\_edge" title="\inline a+b\ge&space;has\_edge" /> ÈÇ£‰πà‰∏çÁÆ°ÂíãÊîæÈÉΩÊàêÁ´ãÔºåÁõ¥Êé•ËæìÂá∫  <img src="https://latex.codecogs.com/svg.image?\inline&space;has\_situation" title="\inline has\_situation" /> Â∞±Ë°å  
Âê¶ÂàôÁúãÁúã‰∏§‰∫∫Ê≤°ÊúâÂÖ¨ÂÖ±ËæπÁöÑÊÉÖÂÜµ  
Â∞±ÊòØÂú®  <img src="https://latex.codecogs.com/svg.image?\inline&space;has\_edge" title="\inline has\_edge" /> ‰∏≠ÈÄâ  <img src="https://latex.codecogs.com/svg.image?\inline&space;a" title="\inline a" /> ‰∏™ÔºåÂÜç‰ªé  <img src="https://latex.codecogs.com/svg.image?\inline&space;has\_edge-a" title="\inline has\_edge-a" /> ‰∏™‰∏≠ÈÄâ  <img src="https://latex.codecogs.com/svg.image?\inline&space;b" title="\inline b" /> ‰∏™  
ËøôÊ†∑ÁöÑÁ≠îÊ°àÂ∞±ÊòØ  <img src="https://latex.codecogs.com/svg.image?\inline&space;has\_situation-\binom{has\_edge}{a}\times\binom{has\_edge-a}{b}" title="\inline has\_situation-\binom{has\_edge}{a}\times\binom{has\_edge-a}{b}" />   

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >

```cpp
#include <iostream>

#define ll long long

using namespace std;

const int mod = 1e9 + 7;
const int N = 1e6 + 10;

ll f[N];
inline void Get () {
        f[0] = 1;
        for ( ll i = 1; i < N; i ++ ) f[i] = f[i - 1] * i % mod;
}
inline ll ksm ( ll a, ll b ) {
        ll res = 1;
        while ( b ) {
                if ( b & 1 ) res = res * a % mod;
                a = a * a % mod;
                b >>= 1;
        }
        return res;
}
inline ll inv ( ll x ) { return ksm (x, mod - 2); }
inline ll C ( ll n, ll m ) {
        return f[n] * inv(f[m]) % mod * inv(f[n - m]) % mod;
}

int main () {
        Get();
        ll n, a, b; cin >> n >> a >> b;
        ll has_edge = n * (n - 1) / 2;
        ll has_situation = C(has_edge, a) * C(has_edge, b) % mod;
        if ( a + b >= has_edge ) cout << has_situation << endl;
        else {
                ll sub = C(has_edge, a) * C(has_edge - a, b) % mod;
                cout << (has_edge - sub + mod) % mod << endl;
        }
}
```

<hr>

### ABC221E_LEQ

#### üîó
<a href="https://atcoder.jp/contests/abc221/tasks/abc221_e?lang=en"><img src="https://i.loli.net/2021/10/03/zgE36rAUpOTkXHQ.png"></a>

#### üí°
ÈóÆÈ¢òËΩ¨Âåñ‰∏Ä‰∏ãÂ∞±ÊòØ  
‰ªéÂ∑¶ÂêëÂè≥Ôºå<img src="https://latex.codecogs.com/svg.image?a[i]" title="a[i]" />ÁöÑË¥°ÁåÆÂ∞±ÊòØÊØè‰∏™ÂâçÈù¢ÊØîÂÆÉÂ∞èÁöÑ<img src="https://latex.codecogs.com/svg.image?a[j]" title="a[j]" />ÔºåÂú®Ëøô‰∏™‰ΩçÁΩÆ‰∏äÁöÑË¥°ÁåÆ‰∏∫<img src="https://latex.codecogs.com/svg.image?2^{i-j-1}" title="2^{i-j-1}" />  
Áî±‰∫éÂå∫Èó¥ÈïøÂ∫¶ÊÄªÊòØÂèÇÂ∑Æ‰∏çÈΩêÁöÑ  
ÈÇ£‰πàÂØπ‰∫éÊØè‰∏™<img src="https://latex.codecogs.com/svg.image?a[j]" title="a[j]" />ÔºåÊàë‰ª¨ÈÉΩÂèØ‰ª•Áª¥Êä§‰∏Ä‰∏™ÂâçÁºÄË¥°ÁåÆ‰∏∫<img src="https://latex.codecogs.com/svg.image?2^{-j-1}&space;" title="2^{-j-1} " />   
ÁÑ∂ÂêéÂú®<img src="https://latex.codecogs.com/svg.image?i" title="i" />ÁöÑ‰ΩçÁΩÆÁöÑÊó∂ÂÄôÁöÑË¥°ÁåÆÂÆπÊñ•‰∏∫<img src="https://latex.codecogs.com/svg.image?\sum\frac{2^i}{2^{j&plus;1}}" title="\sum\frac{2^i}{2^{j+1}}" />Âç≥ÂèØÔºåÂÖ∂‰∏≠sumÂèØ‰ª•Áî±Ê†ëÁä∂Êï∞ÁªÑÁöÑÂâçÁºÄÂæóÂà∞  
ÊâÄ‰ª•ÊØèÊ¨°Á¥ØÂä†Êü•ËØ¢<img src="https://latex.codecogs.com/svg.image?a[i]" title="a[i]" />‰ΩçÁΩÆ‰ª•ÂâçÁöÑÊÄªË¥°ÁåÆÔºå`query(a[i]) * ksm(2, i)`  
ÁÑ∂ÂêéÂú®<img src="https://latex.codecogs.com/svg.image?a[i]" title="a[i]" />ÁöÑ‰ΩçÁΩÆ‰∏äÊõ¥Êñ∞‰∏Ä‰∏ãËøô‰∏™ÂâçÁºÄË¥°ÁåÆÔºå`update( a[i], ksm(ksm(2, i + 1), mod - 2) )`  

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >

```cpp
#include <iostream>
#include <vector>
#include <algorithm>
#define ll long long
using namespace std;

const int N = 3e5 + 10;
const int mod = 998244353;
ll n, a[N];
vector<ll> nums;

inline ll ksm ( ll a, ll b ) {
	ll res = 1;
	while ( b ) {
		if ( b & 1 ) res = res * a % mod;
		a = a * a % mod;
		b >>= 1;
	}
	return res;
}

namespace TreeArray {
	ll tr[N];
	inline ll lowbit ( ll x ) {
		return x & -x;
	}
	inline void update ( ll id, ll val ) {
		while ( id < N ) tr[id] = (tr[id] + val) % mod, id += lowbit(id);
	}
	inline ll query ( ll id ) {
		ll res = 0;
		while ( id > 0 ) res = (res + tr[id]) % mod, id -= lowbit(id);
		return res;
	}
} using namespace TreeArray;

int main() {
#ifndef ONLINE_JUDGE
	freopen("in.in", "r", stdin);
	freopen("out.out", "w", stdout);
#endif
	cin >> n;
	ll res = 0;
	for ( int i = 1; i <= n; i ++ ) 
		cin >> a[i],
		nums.push_back(a[i]);
	sort ( nums.begin(), nums.end() );
	nums.erase(unique(nums.begin(), nums.end()), nums.end());
	for ( int i = 1; i <= n; i ++ ) a[i] = lower_bound(nums.begin(), nums.end(), a[i]) - nums.begin() + 1;
	for ( int i = 1; i <= n; i ++ ) {
		res = (res + query(a[i]) * ksm(2, i) % mod) % mod;
		update (a[i], ksm(ksm(2, i + 1), mod - 2));	
	}
	cout << res << endl;
	return 0;
}
```

<hr>

### CCPC2021Â®ÅÊµ∑M_810975 

#### üîó
<a href="https://codeforces.com/gym/103428/problem/M">![20220831223041](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220831223041.png)</a>

#### üí°
‰∏Ä‰∏™ÁúãËµ∑Êù•Â∞±ÂæàÂÖ∏ÁöÑÂÆπÊñ•ÈóÆÈ¢ò„ÄÇ  
Âç°Âú® $k$ ‰∏äÂ§™ÈöæÂ§ÑÁêÜÔºå‰∫éÊòØ‰ª§ $f(k)$ Ë°®Á§∫ÊúÄÂ§ßËøûËÉúÈïøÂ∫¶‰∏ç‰Ωé‰∫é $k$ ÔºåÁ≠îÊ°àÂç≥‰∏∫ $f(k+1)-f(k)$  
ÂØπ‰∫é $f(k)$ ÂÖàÂÆâÊéí‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫ $k$ ÁöÑËøûËÉúÊÆµÔºåÂà´ÁöÑ‰ªªÊÑèÂàÜÈÖçÔºåÂÅáËÆæËøô‰∏™ÊÆµÂàÜÈÖçÂà∞ $a$ ‰ΩçÁΩÆÔºå$b$ ‰ΩçÁΩÆÂèàÊîæ‰∫Ü $k$ ‰∏™ËÉúÂú∫ÔºåËÄåÂèçËøáÊù•Âèà‰ºöÈáçÊñ∞ËÆ°Êï∞‰∏ÄÊ¨°ÔºåËøôÂ∞±ÊòØÂÆπÊñ•‰∫Ü„ÄÇÊâÄ‰ª•ÂÖàËÆ°ÁÆóÊéí‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫ $k$ ÁöÑËøûÁª≠ÊÆµÂâ©‰∏ãËÉúÂú∫Èöè‰æøÊéíÁöÑÊï∞ÈáèÔºåÂÜçÂáèÂéªÊéí‰∏§‰∏™ÈïøÂ∫¶‰∏∫ $k$ ÁöÑËøûÁª≠ÊÆµÂâ©‰∏ãËÉúÂú∫Èöè‰æøÊéíÁöÑÊï∞ÈáèÔºåÂÜçÂä†‰∏äÊéí‰∏â‰∏™ÈïøÂ∫¶‰∏∫ $k$ ÁöÑËøûÁª≠ÊÆµÂâ©‰∏ãÂú∫Êï∞Èöè‰æøÊéíÁöÑÊï∞Èáè....  
ÂØπ‰∫éÈÄâ $i$ ‰∏™ËøûËÉúÊÆµÔºåÂÖàÂú®Ââ©‰∏ãÁöÑ $n-ik$ ‰∏™Âú∫ÈÄâ $n-m$ ‰∏™Ë¥•Âú∫ÔºåÂú®Ë¥•Âú∫ÁöÑ $n-m+1$ ‰∏™Á©∫‰∏≠Êèí $i$ ‰∏™ÊùøÂ≠êÔºåÊúâÊïàÈò≤Ê≠¢‰∫ÜÂá∫Áé∞ $\checkmark\underline{\checkmark\checkmark...\checkmark}$ Âíå $\underline{\checkmark\checkmark...\checkmark}\checkmark$ ÁöÑÂÜ≤Á™Å„ÄÇÊïÖËÆ°Êï∞‰∏∫  
$f(k)=\sum\limits_{i=1}^{ik<=m}(-1)^{i+1}\binom{n-m+1}{i}\binom{n-ik}{n-m}$    
ÊúÄÂêéÊ±Ç‰∏Ä‰∏ã $f(k+1)-f(k)$  
Ê≥®ÊÑèÁâπÂà§‰∏Ä‰∏ã $k=0$ Ôºå‰∏çÁÑ∂‰ºö $RE$  
    
ËÄåÂØπ‰∫é $g(k)$ Ë°®Á§∫ÊúÄÂ§ßËøûËÉúÈïøÂ∫¶‰∏çÂ§ö‰∫é $k$  
Êúâ‰∏Ä‰∏™ÁîüÊàêÂáΩÊï∞Ê±Ç $g(k)$ ÁöÑÊÄùËÄÉÊñπÂºè  
Êúâ $n-m+1$ ‰∏™Á©∫ÔºåÊØè‰∏™Á©∫ÊúÄÂ§öÊîæ $k$ ‰∏™ÔºåÂÖ∂ÁîüÊàêÂáΩÊï∞‰∏∫ $1+x+x^2+...+x^k$  
ÂØπ‰∫éÊâÄÊúâÁöÑÁ©∫ÂêàÂπ∂Ëµ∑Êù•Â∞±ÊòØ $(1+x+x^2+...+x^k)^{n-m+1}$ ÔºåËÄåÊúÄÂêéË¶ÅÊ±ÇÊúâ $m$ ‰∏™ËÉúÂú∫ÔºåËøîÂõûËøô‰∏™Â§öÈ°πÂºèÁöÑÂπÇÁöÑ $m$ Ê¨°È°πÁ≥ªÊï∞Âç≥ÂèØ  
ËøôÈáåÂ∞±ÈúÄË¶ÅÊîØÊåÅÈïøÂ§öÈ°πÂºèÁöÑÂ§öÈ°πÂºèÂø´ÈÄüÂπÇ‰∫ÜÔºà‰∏ç‰ºöÂÜôÔºâ

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
const int mod = 998244353;
const int N = 1e5 + 10;
int f[N], ivf[N];
inline int ksm (int a, int b) {
    int res = 1;
    while (b) {
        if (b & 1) res = 1ll * res * a % mod;
        a = 1ll * a * a % mod;
        b >>= 1;
    }
    return res;
}
inline int inv (int x) {return ksm(x, mod - 2);}
inline int C(int n, int m) {
    return 1ll * f[n] * ivf[m] % mod * ivf[n - m] % mod;
}

int n, m, k;
inline int Calc (int x) {
    int ret = 0;
    for (int i = 1; i * x <= m; i ++) {
        if (i & 1) ret += 1ll * C(n - m + 1, i) * C(n - i * x, n - m) % mod;
        else ret -= 1ll * C(n - m + 1, i) * C(n - i * x, n - m) % mod;
        ret = (ret % mod + mod) % mod;
    }
    return ret;
}


inline void Solve () {
    cin >> n >> m >> k;
    if (k == 0) {
        cout << (m == 0) << endl;
    } else {
        cout << ((Calc(k) - Calc(k + 1)) % mod + mod) % mod << endl;
    }
}
```
<hr>


### CodeForces451E_DevuAndFlowers

#### üîó
<a href="https://www.luogu.com.cn/problem/CF451E"><img src="https://i.loli.net/2021/11/24/l2YRfXkU7Aq5bGQ.png"></a>

#### üí°
Ëøô‰∏™Êï∞ÊçÆÈáè...  
ÊÑüËßâÊØçÂáΩÊï∞Ëøá‰∏ç‰∫ÜÔºåÁúã‰∫ÜÁúº  <img src="https://latex.codecogs.com/svg.image?\inline&space;n" title="\inline n" />  ÊÉ≥‰∏Ä‰∏ãÂÆπÊñ•  
  
ÂíåÂ§öÈáçËÉåÂåÖË∂ÖÈôê‰∏ÄÊ†∑  
Êàë‰ª¨ËÄÉËôëËøôÈáåÈù¢ÁöÑÊÄªÊñπÊ°àÂíå‰∏çÂêàÊ≥ïÊñπÊ°à  
Â¶ÇÊûúÁÆ±Â≠êÊó†ÈôêÊúµËä±ÔºåÈÇ£‰πàÂ∞±ÊòØ  <img src="https://latex.codecogs.com/svg.image?\inline&space;\binom{s+n-1}{n-1}" title="\inline \binom{s+n-1}{n-1}" />  ÁßçÂèñÊ≥ï  
>Âç≥ÈóÆÔºö  <img src="https://latex.codecogs.com/svg.image?\inline&space;\sum\limits_{i=1}^nx_i=s" title="\inline \sum\limits_{i=1}^nx_i=s" />   
>ÈÇ£Â∞±ÊòØ‰ΩøÁî®  <img src="https://latex.codecogs.com/svg.image?\inline&space;n-1" title="\line n-1" />  ‰∏™ÈöîÊùøÂ∞Ü  <img src="https://latex.codecogs.com/svg.image?\inline&space;s" title="\inline s" />  ‰∏™Áâ©ÂìÅÂàÜÂâ≤Êàê  <img src="https://latex.codecogs.com/svg.image?\inline&space;n" title="\inline n" />  ‰ªΩ  
>ÈÇ£Â∞±ÊòØÊúâ‰∫Ü  <img src="https://latex.codecogs.com/svg.image?\inline&space;s+n-1" title="\inline s+n-1" />  ‰∏™‰ΩçÁΩÆÂèØ‰ª•Áî®Êù•ÊîæËøô  <img src="https://latex.codecogs.com/svg.image?\inline&space;n-1" title="\inline n-1" />  ‰∏™ÈöîÊùø  
>ÊñπÊ°àÊï∞Â∞±ÊòØ  <img src="https://latex.codecogs.com/svg.image?\inline&space;\binom{s+n-1}{n-1}" title="\inline \binom{s+n-1}{n-1}" /> 

‰∏çÂêàÊ≥ïÊñπÊ°àÂ∞±ÊòØ‚Äú‰Ω†Á¨¨  <img src="https://latex.codecogs.com/svg.image?\inline&space;i" title="\inline i" />  ‰∏™ÁÆ±Â≠êÂè™Êúâ  <img src="https://latex.codecogs.com/svg.image?\inline&space;x_i" title="\inline x_i" />  ÊúµËä±Ôºå‰ΩÜÊòØ‰Ω†Âèñ‰∫Ü  <img src="https://latex.codecogs.com/svg.image?\inline&space;x_i+1" title="\inline x_i+1" />  ÊúµËä±  
  
ÈÇ£‰πàÊàë‰ª¨Â¶ÇÊûúÁõ¥Êé•Âº∫Âà∂Âú®<img src="https://latex.codecogs.com/svg.image?\inline&space;i" title="\inline i" />Âè∑ÁÆ±Â≠êÂèñ  <img src="https://latex.codecogs.com/svg.image?\inline&space;x_i+1" title="\inline x_i+1" />  ÊúµËä±ÔºåÈÇ£‰πàÂà´ÁöÑÊâÄÊúâÂèñÊ≥ïÈÉΩ‰∏çÂêàÊ≥ï  
ËøôÂ∞±ÊòØÂÆπÊñ•ÁöÑÈóÆÈ¢ò‰∫ÜÔºåÂõ†‰∏∫Êûö‰∏æ‰ºöÂá∫Áé∞ÈáçÂ§ç  
ÊâÄ‰ª•Â∞±ÔºàÂ•áÊï∞‰∏™ÁÆ±Â≠êÔºâ-ÔºàÂÅ∂Êï∞‰∏™ÁÆ±Â≠êÔºâ  
  
Áî±‰∫é‰∏ÄÂºÄÂßãÁªôÂá∫ÁöÑ <img src="https://latex.codecogs.com/svg.image?\inline&space;s" title="\line s" /> ÂèØËÉΩÂæàÂ§ßÔºåÊâÄ‰ª•ËøôÈáåÈúÄË¶ÅÁî® <img src="https://latex.codecogs.com/svg.image?\inline&space;Lucas" title="\line Lucas" /> ÂÆöÁêÜ


#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >

```cpp
const int N = 30;
const int mod = 1e9 + 7;

namespace PermutationAndCombination {
        inline ll ksm ( ll a, ll b ) {
                ll res = 1;
                while ( b ) {
                        if ( b & 1 ) res = res * a % mod;
                        a = a * a % mod;
                        b >>= 1;
                }
                return res;
        }
        inline ll inv ( ll x ) { return ksm(x, mod - 2); }

        ll iv[N];
        inline void Get () {
                for ( int i = 1; i < N; i ++ ) iv[i] = inv(i);
        }
        inline ll C ( ll n, ll m ) {
                if ( n < m )   return 0;
                if ( n < mod ) {
                        ll res = 1;
                        for ( ll i = 1; i <= m; i ++ ) {
                                ll a = (n + i - m) % mod;
                                ll b = i % mod;
                                res = res * a % mod * iv[b] % mod;
                        }
                        return res;
                }
                return C ( n / mod, m / mod ) * C ( n % mod, m % mod ) % mod;
        }
} using namespace PermutationAndCombination;

ll a[N], n, s, res;
int main () {
        ios::sync_with_stdio(false);
        Get(); cin >> n >> s;
        for ( int i = 0; i < n; i ++ ) cin >> a[i];
        for ( int i = 0; i < (1 << n); i ++ ) {
                ll np = 1, cur = s;
                for ( int j = 0; j < n; j ++ ) {
                        if ( i & (1 << j) ) {
                                np = -np;
                                cur -= a[j] + 1; 
                        }
                }
                if ( cur < 0 ) continue;
                ll upd = C(cur + n - 1, n - 1);
                res = (res + np * upd) % mod;
        }
        cout << (res + mod) % mod << endl;
}
```

<hr>

### CodeForces979C_KuroAndWalkingRoute

#### üîó
<a href="https://codeforces.com/problemset/problem/979/C"><img src="https://i.loli.net/2021/09/30/BFybalLjWnoRu4X.png"></a>

#### üí°
Áõ¥Êé•Â§ÑÁêÜÂèØ‰ª•Âà∞ËææÁöÑÁÇπÂØπÂæàÈ∫ªÁÉ¶ÔºåË¶ÅËÄÉËôëÂæàÂ§öÁßçÊÉÖÂÜµ  
ÈÇ£‰πàÂèØ‰ª•ÂÆπÊñ•Âú∞Âáè‰∏Ä‰∏ã‰∏çËÉΩÂà∞ËææÁöÑÁÇπ  
Âç≥ÈÄöËøáyÂÜçÂà∞ËææxÂç≥‰πãÂêéÁöÑÁÇπ  
  
Êó¢ÁÑ∂ÊòØ‰∏ÄÊ£µÊ†ë  
ÈÇ£‰πàÂ∞±Áõ¥Êé•Áî®"xÁöÑÂ≠êÊ†ëÂ§ßÂ∞è"‰πò"yÁöÑÂ≠êÊ†ë‰∏≠‰∏çÂåÖÂê´xÁöÑÂ≠êÊ†ëÁöÑÂ§ßÂ∞èÊÄªÂíå"Â∞±ÊòØÊàë‰ª¨Ë¶ÅÂáèÁöÑÂÄº  
Âç≥`res = n * (n - 1) - son[x] * elsSon`  
  
ÂèØ‰ª•ÂÜçÂÜô‰∏Ä‰∏™Âà§Êñ≠Âà§Êñ≠Â≠êÊ†ë‰∏≠ÊúâÊ≤°ÊúâxÁöÑÂáΩÊï∞  
Â§ÑÁêÜÂ•Ωson[]ÂêéÔºåÂØπyÁöÑÂ≠êËäÇÁÇπ‰∏Ä‰∏™‰∏™Âà§Êñ≠Âπ∂‰πò‰∏Ä‰∏ãÂ∞±Ë°å‰∫Ü  


#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >

```cpp
const ll N = 3e5 + 10, M = N * 2;
ll n, X, Y;
ll res;
struct Edge { ll nxt, to; } edge [M]; ll head[M], cnt;

inline void add_Edge ( ll from, ll to ) {
        edge[ ++ cnt ] = { head[from], to };
        head[from] = cnt;
}
ll son[N], sonels;
inline void get_Sz ( ll x, ll fath ) {
        for ( ll i = head[x]; ~i; i = edge[i].nxt ) {
                ll to = edge[i].to;
                if ( to == fath ) continue;
                get_Sz ( to, x );
                son[x] += son[to];
        }
}
inline bool check ( ll x, ll fath ) {
        ll res = 1;
        if ( x == X ) res = 0;
        for ( ll i = head[x]; ~i; i = edge[i].nxt ) {
                ll to = edge[i].to;
                if ( to == fath ) continue;
                res *= check(to, x);
        }
        return res;
}

int main () {
#ifndef ONLINE_JUDGE
        freopen("in.in", "r", stdin);
        freopen("out.out", "w", stdout);
#endif 
        memset ( head, -1, sizeof head );
        for ( ll i = 0; i < N; i ++ ) son[i] = 1;
        scanf("%lld%lld%lld", &n, &X, &Y);
        res = n * (n - 1);
        for ( ll i = 1; i < n; i ++ ) {
                ll a, b; cin >> a >> b;
                add_Edge ( a, b );
                add_Edge ( b, a );
        }
        get_Sz ( Y, -1 );
        for ( ll i = head[Y]; ~i; i = edge[i].nxt ) {
                sonels += check(edge[i].to, Y) * son[edge[i].to];
        }
        sonels ++;
        res -= son[X] * sonels;
        printf("%lld\n", res);
}
```

<hr>

### CodeForces1569C_JuryMeeting

#### üîó
<a href="https://codeforces.com/contest/1569/problem/C"><img src="https://i.loli.net/2021/09/09/feoEr5vRHgldT9p.png"></a>

#### üí°
ËßÇÂØüÈ¢òÁõÆËΩ¨Êç¢‰∏Ä‰∏ãÈ¢òÁõÆÈóÆÈ¢ò  
Âç≥ÊúÄÂ§ßÂÄºÁöÑÂêéÈù¢Ëá≥Â∞ëÊúâ‰∏Ä‰∏™ÂèØ‰ª•ËÆ©ÊúÄÂ§ßÂÄºÊúÄÂêé‰∏ÄÊ≠•ÂíåÂÄíÊï∞Á¨¨‰∫åÊ≠•‰∏çÂú®‰∏ÄËµ∑ÁöÑÊï∞  
ÈÇ£‰πàÂ¶ÇÊûúÊúÄÂ§ßÂÄºÊúâ‰∏§‰∏™ÔºåÊÄé‰πàÊêûÈÉΩÂèØ‰ª•  
Â¶ÇÊûúÊúÄÂ§ßÂÄºÂíåÊ¨°Â§ßÂÄºÁöÑÂ∑ÆÂÄºÂ§ß‰∫é1ÂàôÊÄé‰πàÊêûÈÉΩ‰∏çË°å  
ÁÑ∂ÂêéÂ∞±ÊòØÊúÄÂ§ßÂÄºÂíåÊ¨°Â§ßÂÄºÂ∑ÆÂÄº‰∏∫1ÁöÑÊÉÖÂÜµ  
  
Ëé∑Âèñ‰∏Ä‰∏ãÊâÄÊúâÁöÑÊéíÂàóÊñπÂºèÂç≥<img src="https://latex.codecogs.com/svg.image?n!" title="n!" />  
ÁÑ∂ÂêéÊúÄÂ§ßÂÄºÂú®ÊúÄÂêéÊòØ‰∏çÂèØ‰ª•ÁöÑÔºåÊâÄ‰ª•Ë¶ÅÂáèÂéª<img src="https://latex.codecogs.com/svg.image?(n-1)!" title="(n-1)!" />  
ÁÑ∂ÂêéËÆ°ÁÆóÊâÄÊúâÊ¨°Â§ßÂÄºÈÉΩÂú®ÊúÄÂ§ßÂÄºÂâçÈù¢ÁöÑÊÉÖÂÜµ  
  
Êàë‰ª¨ËÆæÁΩÆ<img src="https://latex.codecogs.com/svg.image?a_0" title="a_0" />ÊòØÊúÄÂ§ßÂÄºÔºå<img src="https://latex.codecogs.com/svg.image?a_1" title="a_1" />ÊòØÊ¨°Â§ßÂÄºÔºå<img src="https://latex.codecogs.com/svg.image?num_i" title="num_i" />ÊòØ<img src="https://latex.codecogs.com/svg.image?i" title="i" />Âá∫Áé∞ÁöÑ‰∏™Êï∞  
ÊúÄÂ§ßÂÄºÂâçÈù¢Ëá≥Â∞ëË¶ÅÁïô‰∏ã<img src="https://latex.codecogs.com/svg.image?num_{a_1" title="num_{a_1" />ÔºåÊúÄÂ§öÂ∞±ÊòØ<img src="https://latex.codecogs.com/svg.image?n-2" title="n-2" />‰∏™  
ÈÇ£‰πàÊàë‰ª¨‰ª•<img src="https://latex.codecogs.com/svg.image?i" title="i" />ÈÅçÂéÜ  
Â∞Ü<img src="https://latex.codecogs.com/svg.image?num_{a_1" title="num_{a_1" />‰∏™Êï∞‰∏çËÆ∞È°∫Â∫èÂú∞ÊîæÂÖ•<img src="https://latex.codecogs.com/svg.image?i" title="i" />‰∏™Á©∫‰∏≠  
Âç≥<img src="https://latex.codecogs.com/svg.image?C_i^{num_{a_1}}" title="C_i^{num_{a_1}}" />  
ÁÑ∂ÂêéÂØπËøô<img src="https://latex.codecogs.com/svg.image?num_{a_1" title="num_{a_1" />‰∏™Êï∞ËÄÉËôëÈ°∫Â∫èÔºåÂØπÂÖ∂‰ΩôÁöÑ<img src="https://latex.codecogs.com/svg.image?n-num_{a_1}-1" title="n-num_{a_1}-1" />‰∏™Êï∞ËÄÉËôëÈ°∫Â∫è  
Âç≥ÈÉΩÊòØÈò∂‰πò  
ÈÇ£‰πàÂ∞±ÊúâÂÖ¨ÂºèÔºö  
<img src="https://latex.codecogs.com/svg.image?n!-(n-1)!-\sum\limits_{i=num_{a_1}}^{n-2}\{C_i^{num_{a_1}}\times&space;num_{a_1}!\times&space;(n-1-num_{a_1})!\}" title="n!-(n-1)!-\sum\limits_{i=num_{a_1}}^{n-2}\{C_i^{num_{a_1}}\times num_{a_1}!\times (n-1-num_{a_1})!\}" />  

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >

```cpp
#include <iostream>
#include <algorithm>
#include <map>
#include <cmath>
#include <vector>
#include <cstring>
#include <list>
using namespace std;
#define ll long long
const int N = 200005;
const ll mod = 998244353;

ll a[N];
ll f[N];
ll n;
map<ll, ll> num;
inline void get_F () {
        f[0] = 1;
        for ( int i = 1; i < N; i ++ ) {
                f[i] = f[i - 1] * i % mod;
        }
}
inline ll ksm ( ll a, ll b ) {
        ll res = 1;
        while ( b ) {
                if ( b & 1 ) res = res * a % mod;
                a = a * a % mod;
                b >>= 1;
        }
        return res;
}
inline ll C ( ll a, ll b ) { 
        return f[a] * ksm(f[b], mod - 2) % mod * ksm(f[a - b], mod - 2) % mod;
}
inline void solve () {
        num.clear();
        cin >> n;
        for ( int i = 0; i < n; i ++ ) 
                cin >> a[i],
                num[a[i]] ++;
        sort ( a, a + n, [] ( ll a, ll b ) { return a > b; } );
        
        if ( a[0] - a[1] > 1 ) { // ÊúÄÂêé‰∏Ä‰∏™Ë¶ÅËá™Â∑±‰∏Ä‰∏™ËøûÁª≠ÂáèÂ•ΩÂ§öÊ¨°
                cout << 0 << endl;
        } else if ( num[a[0]] > 1 ) { // Ëá™Â∑±ÂíåËá™Â∑±È°∂ÔºåÂèØ‰ª•Èöè‰æøÊêû
                cout << f[n] << endl;
        } else {
                ll res = f[n]; // ÂàùÂßãÂåñ‰∏∫ÊâÄÊúâÁöÑÊÉÖÂÜµ
                ll del = f[n - 1]; // Ë¶ÅÂà†ÂéªÁöÑ‰∏çÁ¨¶ÂêàÁöÑÊÉÖÂÜµ
                for ( int i = num[a[1]]; i <= n - 2; i ++ ) {
                        del = ( del + C(i, num[a[1]]) * f[num[a[1]]] % mod * f[n - 1 - num[a[1]]] % mod ) % mod;
                }
                cout << ( ( res - del ) % mod + mod) % mod << endl;
        }
}

int main () {
#ifndef ONLINE_JUDGE
        freopen("in.in", "r", stdin);
        freopen("out.out", "w", stdout);
#endif
        get_F();
        ll cass; cin >> cass; while ( cass -- ) {
                solve();
        }
}
```

<hr>

### HDU2021Â§öÊ†°(10)4_PtyHatesPrimeNumbers

#### üîó
<a href="https://acm.dingbacode.com/showproblem.php?pid=7080"><img src="https://i.loli.net/2021/10/20/eH9yNx3BRCOqoMV.png"></a>

#### üí°
ÈóÆÈ¢òÂèØ‰ª•ËΩ¨Âåñ‰∏Ä‰∏ãÔºåÁî±‰∫éËá™Â∑±‰πüÊòØËá™Â∑±ÁöÑÂõ†Êï∞ÔºåÊâÄ‰ª•Â∞±ÊòØÈóÆ[1, n]ÂÜÖÊúâÂ§öÂ∞ë‰∏™Êï∞‰∏çÊòØÂâçk‰∏™Á¥†Êï∞ÁöÑÂÄçÊï∞  
ËøôÁ±ªËÆ°Êï∞ÈóÆÈ¢òÂæàÂø´ËÅîÊÉ≥Âà∞ÂÆπÊñ•  
  
16‰∏™Êï∞Ôºå‰ΩÜÊòØÊúâ1e5ÁªÑÊï∞ÊçÆ  
ÈÇ£‰πà2^16 * 1e5Â∞±ÂæàÈöæÂäû‰∫Ü  
‰ΩÜÊòØ2^8ËøòÊòØÂæàÂ•ΩËøáÁöÑÔºåÈÇ£‰πàÂèØ‰ª•ÂØπË¥®Êï∞ÁöÑÁªÑÂêà‰πòÁßØÊÉÖÂÜµÊâìË°®vec  
ÂØπ‰∫éÂâçk‰∏™Ë¥®Êï∞Ôºåk<=8ÔºåÊàë‰ª¨Êâì1~8ÁöÑÂÆπÊñ•Ë°®  
ÂØπ‰∫ék>8ÔºåÊàë‰ª¨Êâì9~16ÁöÑÂÆπÊñ•Ë°®  
(Áî±‰∫éÂÆπÊñ•Ë°®‰∏≠Âê´1ÔºåÂç≥ÈÉΩ‰∏çÈÄâÔºåÈÇ£‰πàÊàë‰ª¨‰∏çÈúÄË¶Å‰ΩøÁî®n-vec[i]Êù•ËÆ°ÁÆó‰∏çÊòØÂâçkÁ¥†Êï∞ÂÄçÊï∞ÁöÑ‰∏™Êï∞Ôºâ   
  
**k<=8**  
Êàë‰ª¨Áõ¥Êé•Â∞±ÂÆπÊñ•Âú∞`res +-= n / vec[i]`Â∞±Ë°å‰∫Ü  
**k>8**  
Êàë‰ª¨ËøòË¶ÅÂÅö‰∏Ä‰∫õÂ§ÑÁêÜ  
ÂâçÂÖ´‰∏™Á¥†Êï∞ÁöÑ‰πòÁßØÊòØ9699690  
Êúâ‰∏™ÊòæÁÑ∂ÁöÑÊÄßË¥®Â∞±ÊòØÔºöÂ¶ÇÊûú‰∏Ä‰∏™Êï∞x‰∏çÊòØÂâçÂÖ´‰∏™Á¥†Êï∞ÁöÑÂÄçÊï∞Ôºåx%9699690‰πü‰∏ç‰ºöÊòØÂâçÂÖ´‰∏™Á¥†Êï∞ÁöÑÂÄçÊï∞ÔºàÂêå‰Ωô  
ËÄå9699690‰πü‰∏çÊòØÈùûÂ∏∏Â§ßÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•ÁªßÁª≠È¢ÑÂ§ÑÁêÜ‰∏Ä‰∏ã9699690‰ª•ÂÜÖ‰∏çÊòØÂâçÂÖ´‰∏™Êï∞ÁöÑÂÄçÊï∞ÁöÑ‰∏™Êï∞ÔºàÂâçÁºÄÂú∞Â§ÑÁêÜ  
ÁÑ∂ÂêéÊàë‰ª¨ÂèØ‰ª•Âà©Áî®Êàë‰ª¨Â§ÑÁêÜÂá∫Êù•ÁöÑ‰ø°ÊÅØÔºåÂÆπÊñ•x=‚ÄúÂú®n‰ª•ÂÜÖ‰∏çÊòØvec[i]ÁöÑÂÄçÊï∞ÁöÑÊï∞‰∏≠Ôºå‰πü‰∏çÊòØÂâç8‰∏™Êï∞ÁöÑÂÄçÊï∞ÁöÑÊÉÖÂÜµ‚Äù  
  
ËøôÈáåÊàë‰ª¨ÂèØ‰ª•ÈááÁî®Êûö‰∏æÂÄçÊï∞ÁöÑÊñπÂºè  
n / vec[i]Ë°®Á§∫ÁöÑÊòØn‰ª•ÂÜÖ‰ªé1ÂºÄÂßãÁöÑvec[i]ÁöÑÂÄçÊï∞  
ÂØπËøô‰∫õÂÄçÊï∞Ôºå[1, ..]Áõ∏ÂΩì‰∫éÊãÜËß£ÂÆåvec[i]Ëøô‰∏™Ë¥®Âõ†Êï∞‰πãÂêéÊÆã‰ΩôÁöÑÊï∞Ôºå‰∏î‰ªé1ÂºÄÂßãËøûÁª≠  
Ëøô‰∫õÊï∞‰∏≠Êàë‰ª¨ÂèØ‰ª•Ê±Ç‰∏Ä‰∏ãNÁöÑÂë®Êúü‰∏™Êï∞ÔºåÊØè‰∏™Âë®ÊúüÊúâsum[N]‰∏™Êª°Ë∂≥Êù°‰ª∂ÁöÑÊï∞    
ÁÑ∂ÂêéÂâ©‰Ωôn / vec[i] % NÔºåËøôÈáåÈù¢Êúâsum[n / vec[i] % N]‰∏™Êª°Ë∂≥Êù°‰ª∂ÁöÑÊï∞  
  
ÂÆπÊñ•Ëøô‰∫õÊï∞Â∞±Ë°å‰∫Ü  

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >

```cpp
const int N = 9699690;
int prime[] = {0, 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53}; // Ââç16‰∏™Ë¥®Êï∞
vector<ll> a[20], b[20]; // 01Êûö‰∏æÂêéÔºåÂ•áÊï∞‰∏™Êï∞ÁöÑ‰πòÁßØÊÉÖÂÜµÂíåÂÅ∂Êï∞Âì•ÁöÑ‰πòÁßØÊÉÖÂÜµ
int sum[N + 10]; // sum[i] = [1, i]‰∏≠‰∏çËÉΩË¢´ÂâçÂÖ´‰∏™Ë¥®Êï∞Êï¥Èô§ÁöÑ‰∏™Êï∞

inline void DFS ( int id, ll res, int cnt, int k ) { // ÊûÑÈÄ†ÂÆπÊñ•Êï∞ÁªÑÔºàÂ°ûÂÖ•1Ôºå‰∏çÁî®ÂèñÂèçÊï∞‰∫Ü
        if ( id > k ) {
                if ( cnt & 1 ) a[k].emplace_back(res);
                else           b[k].emplace_back(res);
                return; 
        }
        DFS ( id + 1, res * prime[id], cnt + 1, k );
        DFS ( id + 1, res,             cnt,     k );
}
inline void Pre () { // È¢ÑÂ§ÑÁêÜsum‰∏éÂÆπÊñ•Êï∞ÁªÑ
        for ( int k = 1; k <= 16; k ++ ) {
                if ( k <= 8 ) DFS ( 1, 1, 0, k );
                else          DFS ( 9, 1, 0, k );
        }
        for ( int i = 1; i <= 8; i ++ ) for ( int j = prime[i]; j <= N; j += prime[i] ) sum[j] = 1; // ÂüÉÊ∞èÁ≠õ
        for ( int i = 1; i <= N; i ++ ) sum[i] = sum[i - 1] + (sum[i] == 0);
}
int main () {
        ios::sync_with_stdio(false); Pre();
        int cass; cin >> cass; while ( cass -- ) {
                ll n, k, res = 0;
                cin >> n >> k;
                if ( k <= 8 ) {
                        for ( auto i : a[k] ) res -= n / i; // ÊôÆÈÄöÁöÑÂÆπÊñ•ÂéüÁêÜ
                        for ( auto i : b[k] ) res += n / i;
                } else {
                        for ( auto i : a[k] ) res -= n / i / N * sum[N] + sum[n / i % N]; // Áõ∏ÂΩì‰∫éÊûö‰∏æÂÄçÊï∞ÔºåÂÄçÊï∞Êúâ n / i ‰∏™ÔºåÂú®[1, n / i]‰∏≠ÊâæNÁöÑÂë®Êúü‰∏éÊ®°N‰πãÂêéÂâ©‰ΩôÁöÑ‰∏™Êï∞
                        for ( auto i : b[k] ) res += n / i / N * sum[N] + sum[n / i % N];
                }
                cout << res << endl;
        }
}
```

<hr>

### HDUOJ5776_sum

#### üîó
http://acm.hdu.edu.cn/showproblem.php?pid=5776

#### üí°


#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >  
  

```cpp
#pragma region
#pragma GCC optimize(3,"Ofast","inline")
#include <algorithm>
#include <iostream>
#include <cstring>
#include <string>
#include <vector>
#include <cstdio>
#include <stack>
#include <queue>
#include <cmath>
#include <map>
#include <set>
#define G 10.0
#define LNF 1e18
#define eps 1e-6
#define PI acos(-1.0)
#define ll long long
#define INF 0x7FFFFFFF
#define Regal exit(0)
#define Chivas int main()
#define pb(x) push_back(x)
#define SP system("pause")
#define Max(a,b) ((a)>(b)?(a):(b))
#define Min(a,b) ((a)<(b)?(a):(b))
#define IOS ios::sync_with_stdio(false)
#define mm(a, b) memset(a, b, sizeof(a))
#define each(cass) for (cin>>cass; cass; cass--)
#define test(a) cout << "---------" << a << "---------" << '\n'
 
using namespace std;
#pragma endregion

//ÂÖ®Â±ÄÂèòÈáè
#pragma region
string fro[100005];
string enn[100005];
int n, m;
vector<int> a;
map<int, int> vis;
int sum;
int cass;
#pragma endregion

inline void solve(){
    a.clear();
    vis.clear();
    sum = 0;
    cin >> n >> m;
    for(int i = 0, x; i < n; i ++){
        cin >> x;
        a.push_back(x);
    }
    for(int i = 0; i < n; i ++){
        sum = (sum + a[i]) % m;
        if(sum == 0){
            cout << "YES" << endl;
            return;
        }
        if(vis[sum]){
            cout << "YES" << endl;
            return;
        }
        vis[sum] = 1;
    }
    cout << "NO" << endl;
}

Chivas{
    each(cass){
        solve();
    }
    Regal;
}
```

<hr>

### HRBUST2414_Ê†ºÂ≠êÊüìËâ≤ËÆ°Êï∞

#### üîó
http://acm.hrbust.edu.cn/index.php?m=ProblemSet&a=showProblem&problem_id=2414

#### üí°
ËÆæÁ¨¨a[i]ÁßçÈ¢úËâ≤‰∏çËÉΩÁî®  
ÈÇ£‰πàÊàë‰ª¨Âú®ÈÄâk‰∏™Êï∞‰∏≠ÔºåË¶ÅÊ±ÇÂæóÁöÑÊòØ  
<img src="https://latex.codecogs.com/svg.image?1-P(a[1]\cup&space;a[2]\cup&space;a[3]\cup&space;...\cup&space;a[k]&space;)" title="1-P(a[1]\cup a[2]\cup a[3]\cup ...\cup a[k] )" />  
ËΩ¨ÂåñÊàêÂÆπÊñ•ÂéüÁêÜÂõæÂæóÂà∞ÁöÑ‰πüÂ∞±ÊòØ  
<img src="https://latex.codecogs.com/svg.image?\begin{align}&space;&space;1&-(P(a[1])&plus;P(a[2])&plus;...&plus;P(a[k]))\\&space;&&plus;&space;(P(a[1]\cap&space;a[2])&plus;P(a[1]\cap&space;a[3])&plus;...&plus;P(a[k-1]\cap&space;a[k]))&space;\\&-(P(a[1]\cap&space;a[2]\cap&space;a[3])&plus;P(a[1]\cap&space;a[2]\cap&space;a[4])&plus;...&plus;P(a[k-2]\cap&space;a[k-1]\cap&space;a[k]))\\&...\end{align}" title="\begin{align} 1&-(P(a[1])+P(a[2])+...+P(a[k]))\\ &+ (P(a[1]\cap a[2])+P(a[1]\cap a[3])+...+P(a[k-1]\cap a[k])) \\&-(P(a[1]\cap a[2]\cap a[3])+P(a[1]\cap a[2]\cap a[4])+...+P(a[k-2]\cap a[k-1]\cap a[k]))\\&...\end{align}" />    
ËΩ¨ÂåñÊàêÂÖ¨ÂºèÂ∞±ÊòØ  
<img src="https://latex.codecogs.com/svg.image?C_m^k(\sum_{i=1}^{k}(-1)^{k-i}C_k^ii(i-1)^{n-1})" title="C_m^k(\sum_{i=1}^{k}(-1)^{k-i}C_k^ii(i-1)^{n-1})" />  
ÈÇ£‰πàÂ∞±ÂºÄÂç¢Âç°ÊñØÂÆöÁêÜÊ±ÇËß£Âç≥ÂèØ  


#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >

```cpp
#include <iostream>
#define ll long long
using namespace std;

const int mod = 1e9 + 7;

ll inv[1000010]; // È¢ÑÂ§ÑÁêÜÂæàÈáçË¶Å

inline ll ksm ( ll a, ll b, ll p ) {
        ll res = 1;
        while ( b ) {
                if ( b & 1 ) res = res * a % p;
                a = a * a % p;
                b >>= 1;
        }
        return res;
}

inline void Init () {
        for ( ll i = 1; i < 1000010; i ++ ) inv[i] = ksm(i, mod - 2, mod);
}

inline ll C ( ll n, ll m, ll p ) {
        if ( m > n ) return 0;
        ll res = 1;
        for ( ll i = 1; i <= m; i ++ ) {
                ll a = (n + i - m) % p;
                ll b = i % p;
                res = res * (a * ksm(b, mod - 2, mod) % p) % p;
        }
        return res;
}

inline ll lucas ( ll n, ll m, ll p ) {
        if ( m == 0 ) return 1;
        return C( n % p, m % p, p ) * lucas ( n / p, m / p, p ) % p;
}

int main () {
        Init();
        int cass;
        for ( scanf("%d", &cass); cass; cass -- ) {
                ll n, m, k; scanf("%lld%lld%lld", &n, &m, &k);
                ll tmp = 1;
                ll res =  0;
                for ( int i = 1; i <= k; i ++ ) {
                        int flag = (k - i) % 2 == 0 ? 1 : -1; // Ëøô‰∏Ä‰ΩçËØ•Âä†ËØ•Âáè
                        tmp = ((tmp * (k - i + 1)) % mod * inv[i]) % mod; // ‰∏çÁî®ÊØèÈÅçÈÉΩlucasÔºåÊé®ÁùÄÁî®ÁùÄÂç≥ÂèØ
                        res = (res + flag * (i * ksm(i - 1, n - 1, mod) % mod) * tmp % mod + mod) % mod;
                }
                printf("%lld\n", res * lucas(m, k, mod) % mod);
        }
        return 0;
}
```

<hr>


## È∏ΩÁ¨ºÂéüÁêÜ

### CodeForces577B_ModuloSum

#### üîó
<a href="https://codeforces.com/contest/577/problem/B">![20220303092428](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220303092428.png)</a>

#### üí°
È¶ñÂÖàÊ†πÊçÆÈ∏ΩÁ¨ºÂéüÁêÜ  
Ëã• $m<=n$  
ÂØπ‰∫éÂâç $m$ ‰∏™Êï∞Êúâ $m$ ‰∏™ÂâçÁºÄÂíå  
- Â≠òÂú® $0$ ÔºåÊòæÁÑ∂ÂèØ‰ª•
- ‰∏çÂ≠òÂú® $0$Ôºå$m$ ‰∏™Êï∞Áî® $sz\{1,2,\dots,m-1\}=m-1$ ‰∏™‰ΩôÊï∞ÔºåÂøÖÁÑ∂Êúâ‰∏§ÈáçÂ§çÔºåÈáçÂ§çÁöÑÂâçÁºÄÂíåÊûÑÊàêÁöÑÂå∫Èó¥Âíå‰∏∫ $0$ Ôºå‰πüÂèØ‰ª•  

Ëã• $m>n$  
ÈÇ£‰πà $n<m\le 1000$ ÔºåÂàôÊö¥ÂäõË∑ë‰∏ÄÈÅç $01$ ËÉåÂåÖÂç≥ÂèØ  

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
int n, m;
bool dp[2][1000];

int main () {
	ios::sync_with_stdio(false);
	cin >> n >> m;
	if ( m <= n ) {
		cout << "YES" << endl;
		return 0;
	}
	for ( int i = 1; i <= n; i ++ ) {
		int x; cin >> x; x %= m;
		memset(dp[i & 1], false, sizeof dp[i & 1]);
		dp[i & 1][x] = true;
		for ( int j = 0; j < m; j ++ ) {
			dp[i & 1][j]           |= dp[i - 1 & 1][j];
			dp[i & 1][(j + x) % m] |= dp[i - 1 & 1][j];
		} 
		if ( dp[i & 1][0] ) { cout << "YES"; return 0; }
	}
	cout << "NO";
}
```
<hr>


### NamomoCamp2022Êò•Â≠£ÊØèÊó•‰∏ÄÈ¢ò_ÈÄâÊï∞

#### üîó
<a href="http://oj.daimayuan.top/problem/456">![20220302115716](https://raw.githubusercontent.com/Tequila-Avage/PicGoBeds/master/20220302115716.png)</a>

#### üí°
$n$ ‰∏™Êï∞ÔºåËåÉÂõ¥ÂæàÊòéÊòæ‰∫ÜÔºåËøôÈáåÊúÄÂ§öÊúâ $n$ ‰∏™‰∏çÂêåÁöÑÊ®°Êï∞  
ËÄÉËôëÂâçÁºÄÂíåÔºå‰∏ÄÂÖ±Êúâ $n$ ‰∏™ÂâçÁºÄÂíåÔºåÂ¶ÇÊûúÂá∫Áé∞ $0$ ÈÇ£‰πàÂ∞±Áõ¥Êé•ËæìÂá∫Ëøô‰∏™ÂâçÁºÄÂç≥ÂèØ  
ÊúâÂèØËÉΩÊ≤°Êúâ $0$ ÔºåÈÇ£‰πà $n$ ‰∏™ÂâçÁºÄÂíåË¶ÅÁî® $n-1$ ‰∏™Êï∞Â∞±ÂøÖÁÑ∂Â≠òÂú®‰∏§‰∏™ÂâçÁºÄÂíåÁõ∏Âêå  
Áõ∏ÂêåÁöÑ‰∏§‰∏™ÂâçÁºÄÂíåÂáèÂá∫Êù•ÁöÑÂå∫Èó¥Âíå‰∏∫ $0$ Ôºå‰πüËÉΩÊª°Ë∂≥  
  
ÊâÄ‰ª•ÊØèÊ¨°ÁÆóÂâçÁºÄÂíåÔºåÂ¶ÇÊûú‰∏∫ $0$ Áõ¥Êé•ËæìÂá∫ÔºåÂê¶ÂàôÊü•ÁúãÊòØÂê¶‰πãÂâçÂ≠òÂú®ËøáËøô‰∏™ÂâçÁºÄÂíåÔºåÂ¶ÇÊûúÂ≠òÂú®ËøáÔºåÂ∞±‰ªé‰∏ä‰∏Ä‰∏™ËØ•ÂâçÁºÄÂíå‰∏ãÊ†á $+1$ ‰∏ÄÁõ¥Âà∞ÂΩìÂâç‰ΩçÁΩÆ  

#### <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
const int N = 1e5 + 10;
int n, a[N];
int id[N], sum;

int main () {
	ios::sync_with_stdio(false);
    
	cin >> n;
	for ( int i = 1; i <= n; i ++ ) {
		cin >> a[i];
		sum = (sum + a[i]) % n;
		if ( sum == 0 ) {
			cout << i << endl;
			for ( int j = 1; j <= i; j ++ ) cout << j << " ";
			cout << endl;
			return 0;
		}
		if ( id[sum] ) {
			cout << i - id[sum] << endl;
			for ( int j = id[sum] + 1; j <= i; j ++ ) cout << j << " ";
			return 0;
		}
		id[sum] = i;
	}
}
```
<hr>
